/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={6199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(5319),o=n(1635),a=n(5844),c=n(6336),u=n(6148),l=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")},e}(),h="@firebase/app",d="0.9.29",f=new a.Logger("@firebase/app"),p="[DEFAULT]",m=((r={})[h]="fire-core",r["@firebase/app-compat"]="fire-core-compat",r["@firebase/analytics"]="fire-analytics",r["@firebase/analytics-compat"]="fire-analytics-compat",r["@firebase/app-check"]="fire-app-check",r["@firebase/app-check-compat"]="fire-app-check-compat",r["@firebase/auth"]="fire-auth",r["@firebase/auth-compat"]="fire-auth-compat",r["@firebase/database"]="fire-rtdb",r["@firebase/database-compat"]="fire-rtdb-compat",r["@firebase/functions"]="fire-fn",r["@firebase/functions-compat"]="fire-fn-compat",r["@firebase/installations"]="fire-iid",r["@firebase/installations-compat"]="fire-iid-compat",r["@firebase/messaging"]="fire-fcm",r["@firebase/messaging-compat"]="fire-fcm-compat",r["@firebase/performance"]="fire-perf",r["@firebase/performance-compat"]="fire-perf-compat",r["@firebase/remote-config"]="fire-rc",r["@firebase/remote-config-compat"]="fire-rc-compat",r["@firebase/storage"]="fire-gcs",r["@firebase/storage-compat"]="fire-gcs-compat",r["@firebase/firestore"]="fire-fst",r["@firebase/firestore-compat"]="fire-fst-compat",r["fire-js"]="fire-js",r.firebase="fire-js-all",r),g=new Map,y=new Map;function v(e,t){try{e.container.addComponent(t)}catch(n){f.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function w(e){var t,n,r=e.name;if(y.has(r))return f.debug("There were multiple attempts to register component ".concat(r,".")),!1;y.set(r,e);try{for(var i=o.__values(g.values()),s=i.next();!s.done;s=i.next())v(s.value,e)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!0}function b(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var _=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call initializeApp() first",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists with different options or config",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["no-options"]="Need to provide options, when not being deployed to hosting via source.",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i["idb-open"]="Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",i["idb-get"]="Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",i["idb-set"]="Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",i["idb-delete"]="Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.",i),I=new c.ErrorFactory("app","Firebase",_),E=function(){function e(e,t,n){var r=this;this._isDeleted=!1,this._options=o.__assign({},e),this._config=o.__assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.Component("app",(function(){return r}),"PUBLIC"))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed(),this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed(),this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.checkDestroyed(),this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){this._isDeleted=e},enumerable:!1,configurable:!0}),e.prototype.checkDestroyed=function(){if(this.isDeleted)throw I.create("app-deleted",{appName:this._name})},e}();function T(e,t){var n,r;void 0===t&&(t={});var i=e;"object"!=typeof t&&(t={name:t});var a=o.__assign({name:p,automaticDataCollectionEnabled:!1},t),u=a.name;if("string"!=typeof u||!u)throw I.create("bad-app-name",{appName:String(u)});if(i||(i=c.getDefaultAppConfig()),!i)throw I.create("no-options");var l=g.get(u);if(l){if(c.deepEqual(i,l.options)&&c.deepEqual(a,l.config))return l;throw I.create("duplicate-app",{appName:u})}var h=new s.ComponentContainer(u);try{for(var d=o.__values(y.values()),f=d.next();!f.done;f=d.next()){var m=f.value;h.addComponent(m)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var v=new E(i,a,h);return g.set(u,v),v}function S(e,t,n){var r,i=null!==(r=m[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var c=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&c.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&c.push("and"),a&&c.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void f.warn(c.join(" "))}w(new s.Component("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}var C="firebase-heartbeat-database",A=1,x="firebase-heartbeat-store",k=null;function D(){return k||(k=u.openDB(C,A,{upgrade:function(e,t){if(0===t)try{e.createObjectStore(x)}catch(e){console.warn(e)}}}).catch((function(e){throw I.create("idb-open",{originalErrorMessage:e.message})}))),k}function N(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,D()];case 1:return t=o.sent(),[4,(n=t.transaction(x)).objectStore(x).get(P(e))];case 2:return r=o.sent(),[4,n.done];case 3:return o.sent(),[2,r];case 4:return(i=o.sent())instanceof c.FirebaseError?f.warn(i.message):(s=I.create("idb-get",{originalErrorMessage:null==i?void 0:i.message}),f.warn(s.message)),[3,5];case 5:return[2]}}))}))}function O(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,D()];case 1:return n=o.sent(),[4,(r=n.transaction(x,"readwrite")).objectStore(x).put(t,P(e))];case 2:return o.sent(),[4,r.done];case 3:return o.sent(),[3,5];case 4:return(i=o.sent())instanceof c.FirebaseError?f.warn(i.message):(s=I.create("idb-set",{originalErrorMessage:null==i?void 0:i.message}),f.warn(s.message)),[3,5];case 5:return[2]}}))}))}function P(e){return"".concat(e.name,"!").concat(e.options.appId)}var R=function(){function e(e){var t=this;this.container=e,this._heartbeatsCache=null;var n=this.container.getProvider("app").getImmediate();this._storage=new M(n),this._heartbeatsCachePromise=this._storage.read().then((function(e){return t._heartbeatsCache=e,e}))}return e.prototype.triggerHeartbeat=function(){var e,t;return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return n=this.container.getProvider("platform-logger").getImmediate(),r=n.getPlatformInfoString(),i=L(),null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)?[3,2]:(s=this,[4,this._heartbeatsCachePromise]);case 1:if(s._heartbeatsCache=o.sent(),null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return[2];o.label=2;case 2:return this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((function(e){return e.date===i}))?[2]:(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),[2,this._storage.overwrite(this._heartbeatsCache)])}}))}))},e.prototype.getHeartbeatsHeader=function(){var e;return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,s;return o.__generator(this,(function(a){switch(a.label){case 0:return null!==this._heartbeatsCache?[3,2]:[4,this._heartbeatsCachePromise];case 1:a.sent(),a.label=2;case 2:return null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length?[2,""]:(t=L(),n=function(e,t){var n,r;void 0===t&&(t=1024);var i=[],s=e.slice(),a=function(e){var n=i.find((function(t){return t.agent===e.agent}));if(n){if(n.dates.push(e.date),F(i)>t)return n.dates.pop(),"break"}else if(i.push({agent:e.agent,dates:[e.date]}),F(i)>t)return i.pop(),"break";s=s.slice(1)};try{for(var c=o.__values(e),u=c.next();!u.done&&"break"!==a(u.value);u=c.next());}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return{heartbeatsToSend:i,unsentEntries:s}}(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,s=c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,[4,this._storage.overwrite(this._heartbeatsCache)]):[3,4]);case 3:return a.sent(),[3,5];case 4:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache),a.label=5;case 5:return[2,s]}}))}))},e}();function L(){return(new Date).toISOString().substring(0,10)}var M=function(){function e(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e.prototype.runIndexedDBEnvironmentCheck=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return c.isIndexedDBAvailable()?[2,c.validateIndexedDBOpenable().then((function(){return!0})).catch((function(){return!1}))]:[2,!1]}))}))},e.prototype.read=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return t.sent()?[3,2]:[2,{heartbeats:[]}];case 2:return[4,N(this.app)];case 3:return(null==(e=t.sent())?void 0:e.heartbeats)?[2,e]:[2,{heartbeats:[]}];case 4:return[2]}}))}))},e.prototype.overwrite=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,O(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})]}}))}))},e.prototype.add=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,O(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:o.__spreadArray(o.__spreadArray([],o.__read(n.heartbeats),!1),o.__read(e.heartbeats),!1)})]}}))}))},e}();function F(e){return c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}w(new s.Component("platform-logger",(function(e){return new l(e)}),"PRIVATE")),w(new s.Component("heartbeat",(function(e){return new R(e)}),"PRIVATE")),S(h,d,"node"),S(h,d,"cjs5"),S("fire-js",""),Object.defineProperty(t,"FirebaseError",{enumerable:!0,get:function(){return c.FirebaseError}}),t.SDK_VERSION="10.9.0",t._DEFAULT_ENTRY_NAME=p,t._addComponent=v,t._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},t._apps=g,t._clearComponents=function(){y.clear()},t._components=y,t._getProvider=b,t._registerComponent=w,t._removeServiceInstance=function(e,t,n){void 0===n&&(n=p),b(e,t).clearInstance(n)},t.deleteApp=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:return t=e.name,g.has(t)?(g.delete(t),[4,Promise.all(e.container.getProviders().map((function(e){return e.delete()})))]):[3,2];case 1:n.sent(),e.isDeleted=!0,n.label=2;case 2:return[2]}}))}))},t.getApp=function(e){void 0===e&&(e=p);var t=g.get(e);if(!t&&e===p&&c.getDefaultAppConfig())return T();if(!t)throw I.create("no-app",{appName:e});return t},t.getApps=function(){return Array.from(g.values())},t.initializeApp=T,t.onLog=function(e,t){if(null!==e&&"function"!=typeof e)throw I.create("invalid-log-argument");a.setUserLogHandler(e,t)},t.registerVersion=S,t.setLogLevel=function(e){a.setLogLevel(e)}},5319:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1635),i=n(6336),s=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),o="[DEFAULT]",a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var a=r.__read(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(e){}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=o),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(r.__spreadArray(r.__spreadArray([],r.__read(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),!1),r.__read(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()}))),!1))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=o),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e=o),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,s=void 0===i?{}:i,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error("".concat(this.name,"(").concat(o,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=r.__values(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=r.__read(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,s=this.onInitCallbacks.get(t);if(s)try{for(var o=r.__values(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===o?void 0:t),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=o),this.component?this.component.multipleInstances?e:o:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}(),c=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=s,t.ComponentContainer=c,t.Provider=a},1241:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6199),i=n(5319),s=n(5844),o=n(6336),a=n(3637);const c="@firebase/firestore";class u{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let l="10.9.0";const h=new s.Logger("@firebase/firestore");function d(){return h.logLevel}function f(e,...t){if(h.logLevel<=s.LogLevel.DEBUG){const n=t.map(g);h.debug(`Firestore (${l}): ${e}`,...n)}}function p(e,...t){if(h.logLevel<=s.LogLevel.ERROR){const n=t.map(g);h.error(`Firestore (${l}): ${e}`,...n)}}function m(e,...t){if(h.logLevel<=s.LogLevel.WARN){const n=t.map(g);h.warn(`Firestore (${l}): ${e}`,...n)}}function g(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function y(e="Unexpected state"){const t=`FIRESTORE (${l}) INTERNAL ASSERTION FAILED: `+e;throw p(t),new Error(t)}function v(e,t){e||y()}function w(e,t){return e}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _ extends o.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class I{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class E{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class T{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(u.UNAUTHENTICATED)))}shutdown(){}}class S{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class C{constructor(e){this.t=e,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new I;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new I,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{f("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(f("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new I)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(f("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(v("string"==typeof t.accessToken),new E(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return v(null===e||"string"==typeof e),new u(e)}}class A{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=u.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class x{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new A(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(u.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class k{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&f("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,f("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{f("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):f("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(v("string"==typeof e.token),this.R=e.token,new k(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function N(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class O{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=N(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function P(e,t){return e<t?-1:e>t?1:0}function R(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function L(e){return e+"\0"}class M{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new _(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return M.fromMillis(Date.now())}static fromDate(e){return M.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new M(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?P(this.nanoseconds,e.nanoseconds):P(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class F{constructor(e){this.timestamp=e}static fromTimestamp(e){return new F(e)}static min(){return new F(new M(0,0))}static max(){return new F(new M(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class U{constructor(e,t,n){void 0===t?t=0:t>e.length&&y(),void 0===n?n=e.length-t:n>e.length-t&&y(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===U.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof U?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class V extends U{construct(e,t,n){return new V(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new _(b.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new V(t)}static emptyPath(){return new V([])}}const j=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class q extends U{construct(e,t,n){return new q(e,t,n)}static isValidIdentifier(e){return j.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),q.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new q(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new _(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new _(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new _(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new _(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new q(t)}static emptyPath(){return new q([])}}class B{constructor(e){this.path=e}static fromPath(e){return new B(V.fromString(e))}static fromName(e){return new B(V.fromString(e).popFirst(5))}static empty(){return new B(V.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===V.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return V.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new B(new V(e.slice()))}}class z{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function G(e){return e.fields.find((e=>2===e.kind))}function H(e){return e.fields.filter((e=>2!==e.kind))}function K(e,t){let n=P(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(n=W(e.fields[r],t.fields[r]),0!==n)return n;return P(e.fields.length,t.fields.length)}z.UNKNOWN_ID=-1;class ${constructor(e,t){this.fieldPath=e,this.kind=t}}function W(e,t){const n=q.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:P(e.kind,t.kind)}class Q{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Q(0,J.min())}}function Y(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=F.fromTimestamp(1e9===r?new M(n+1,0):new M(n,r));return new J(i,B.empty(),t)}function X(e){return new J(e.readTime,e.key,-1)}class J{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new J(F.min(),B.empty(),-1)}static max(){return new J(F.max(),B.empty(),-1)}}function Z(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=B.comparator(e.documentKey,t.documentKey),0!==n?n:P(e.largestBatchId,t.largestBatchId))}const ee="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class te{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ne(e){if(e.code!==b.FAILED_PRECONDITION||e.message!==ee)throw e;f("LocalStore","Unexpectedly lost primary lease")}class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(e){return re.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,n)=>{t(e)}))}static reject(e){return new re(((t,n)=>{n(e)}))}static waitFor(e){return new re(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=re.resolve(!1);for(const n of e)t=t.next((e=>e?re.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new re(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new re(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class ie{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new I,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ae(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=de(t.target.error);this.V.reject(new ae(e,n))}}static open(e,t,n,r){try{return new ie(t,e.transaction(r,n))}catch(e){throw new ae(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(f("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ue(t)}}class se{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===se.S(o.getUA())&&p("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return f("SimpleDb","Removing database:",e),le(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!o.isIndexedDBAvailable())return!1;if(se.C())return!0;const e=o.getUA(),t=se.S(e),n=0<t&&t<10,r=se.v(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(f("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new ae(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new _(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new _(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ae(e,r))},r.onupgradeneeded=e=>{f("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,r.transaction,e.oldVersion,this.version).next((()=>{f("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}B(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.O(e);const t=ie.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),re.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(f("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class oe{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return le(this.k.delete())}}class ae extends _{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ce(e){return"IndexedDbTransactionError"===e.name}class ue{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(f("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(f("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),le(n)}add(e){return f("SimpleDb","ADD",this.store.name,e,e),le(this.store.add(e))}get(e){return le(this.store.get(e)).next((t=>(void 0===t&&(t=null),f("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return f("SimpleDb","DELETE",this.store.name,e),le(this.store.delete(e))}count(){return f("SimpleDb","COUNT",this.store.name),le(this.store.count())}W(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new re(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new re(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}H(e,t){f("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const r=this.cursor(n);return this.G(r,((e,t,n)=>n.delete()))}Y(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Z(e){const t=this.cursor({});return new re(((n,r)=>{t.onerror=e=>{const t=de(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}G(e,t){const n=[];return new re(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new oe(i),o=t(i.primaryKey,i.value,s);if(o instanceof re){const e=o.catch((e=>(s.done(),re.reject(e))));n.push(e)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>re.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function le(e){return new re(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=de(e.target.error);n(t)}}))}let he=!1;function de(e){const t=se.S(o.getUA());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new _("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return he||(he=!0,setTimeout((()=>{throw e}),0)),e}}return e}class fe{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){f("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{f("IndexBackfiller",`Documents written: ${await this.X.te()}`)}catch(e){ce(e)?f("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await ne(e)}await this.ee(6e4)}))}}class pe{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ne(t,e)))}ne(e,t){const n=new Set;let r=t,i=!0;return re.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return f("IndexBackfiller",`Processing collection: ${t}`),this.re(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}re(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.ie(r,n))).next((n=>(f("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}ie(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=X(t);Z(r,n)>0&&(n=r)})),new J(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class me{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function ge(e){return null==e}function ye(e){return 0===e&&1/e==-1/0}function ve(e){return"number"==typeof e&&Number.isInteger(e)&&!ye(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function we(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=_e(t)),t=be(e.get(n),t);return _e(t)}function be(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function _e(e){return e+""}function Ie(e){const t=e.length;if(v(t>=2),2===t)return v(""===e.charAt(0)&&""===e.charAt(1)),V.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&y(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:y()}s=t+2}return new V(r)}me._e=-1;const Ee=["userId","batchId"];function Te(e,t){return[e,we(t)]}function Se(e,t,n){return[e,we(t),n]}const Ce={},Ae=["prefixPath","collectionGroup","readTime","documentId"],xe=["prefixPath","collectionGroup","documentId"],ke=["collectionGroup","readTime","prefixPath","documentId"],De=["canonicalId","targetId"],Ne=["targetId","path"],Oe=["path","targetId"],Pe=["collectionId","parent"],Re=["indexId","uid"],Le=["uid","sequenceNumber"],Me=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fe=["indexId","uid","orderedDocumentKey"],Ue=["userId","collectionPath","documentId"],Ve=["userId","collectionPath","largestBatchId"],je=["userId","collectionGroup","largestBatchId"],qe=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Be=[...qe,"documentOverlays"],ze=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ge=ze,He=[...Ge,"indexConfiguration","indexState","indexEntries"];class Ke extends te{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function $e(e,t){const n=w(e);return se.M(n.ae,t)}function We(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Qe(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ye(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Xe{constructor(e,t){this.comparator=e,this.root=t||Ze.EMPTY}insert(e,t){return new Xe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new Xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Je(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Je(this.root,e,this.comparator,!1)}getReverseIterator(){return new Je(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Je(this.root,e,this.comparator,!0)}}class Je{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ze{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ze.RED,this.left=null!=r?r:Ze.EMPTY,this.right=null!=i?i:Ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Ze(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ze.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw y();if(this.right.isRed())throw y();const e=this.left.check();if(e!==this.right.check())throw y();return e+(this.isRed()?0:1)}}Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1,Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw y()}get value(){throw y()}get color(){throw y()}get left(){throw y()}get right(){throw y()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Ze(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class et{constructor(e){this.comparator=e,this.data=new Xe(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tt(this.data.getIterator())}getIteratorFrom(e){return new tt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof et))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new et(this.comparator);return t.data=e,t}}class tt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nt(e){return e.hasNext()?e.getNext():void 0}class rt{constructor(e){this.fields=e,e.sort(q.comparator)}static empty(){return new rt([])}unionWith(e){let t=new et(q.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new rt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return R(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class it extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class st{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new it("Invalid base64 string: "+e):e}}(e);return new st(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new st(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return P(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const ot=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function at(e){if(v(!!e),"string"==typeof e){let t=0;const n=ot.exec(e);if(v(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ct(e.seconds),nanos:ct(e.nanos)}}function ct(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ut(e){return"string"==typeof e?st.fromBase64String(e):st.fromUint8Array(e)}function lt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ht(e){const t=e.mapValue.fields.__previous_value__;return lt(t)?ht(t):t}function dt(e){const t=at(e.mapValue.fields.__local_write_time__.timestampValue);return new M(t.seconds,t.nanos)}class ft{constructor(e,t,n,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class pt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new pt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof pt&&e.projectId===this.projectId&&e.database===this.database}}const mt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},gt={nullValue:"NULL_VALUE"};function yt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lt(e)?4:Ot(e)?9007199254740991:10:y()}function vt(e,t){if(e===t)return!0;const n=yt(e);if(n!==yt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return dt(e).isEqual(dt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=at(e.timestampValue),r=at(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ut(e.bytesValue).isEqual(ut(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ct(e.geoPointValue.latitude)===ct(t.geoPointValue.latitude)&&ct(e.geoPointValue.longitude)===ct(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ct(e.integerValue)===ct(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ct(e.doubleValue),r=ct(t.doubleValue);return n===r?ye(n)===ye(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return R(e.arrayValue.values||[],t.arrayValue.values||[],vt);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(We(n)!==We(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!vt(n[e],r[e])))return!1;return!0}(e,t);default:return y()}}function wt(e,t){return void 0!==(e.values||[]).find((e=>vt(e,t)))}function bt(e,t){if(e===t)return 0;const n=yt(e),r=yt(t);if(n!==r)return P(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return P(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ct(e.integerValue||e.doubleValue),r=ct(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return _t(e.timestampValue,t.timestampValue);case 4:return _t(dt(e),dt(t));case 5:return P(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ut(e),r=ut(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=P(n[e],r[e]);if(0!==t)return t}return P(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=P(ct(e.latitude),ct(t.latitude));return 0!==n?n:P(ct(e.longitude),ct(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=bt(n[e],r[e]);if(t)return t}return P(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===mt.mapValue&&t===mt.mapValue)return 0;if(e===mt.mapValue)return 1;if(t===mt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=P(r[e],s[e]);if(0!==t)return t;const o=bt(n[r[e]],i[s[e]]);if(0!==o)return o}return P(r.length,s.length)}(e.mapValue,t.mapValue);default:throw y()}}function _t(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return P(e,t);const n=at(e),r=at(t),i=P(n.seconds,r.seconds);return 0!==i?i:P(n.nanos,r.nanos)}function It(e){return Et(e)}function Et(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=at(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ut(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return B.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Et(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Et(e.fields[i])}`;return n+"}"}(e.mapValue):y()}function Tt(e){switch(yt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ht(e);return t?16+Tt(t):16;case 5:return 2*e.stringValue.length;case 6:return ut(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Tt(t)),0)}(e.arrayValue);case 10:return function(e){let t=0;return Qe(e.fields,((e,n)=>{t+=e.length+Tt(n)})),t}(e.mapValue);default:throw y()}}function St(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ct(e){return!!e&&"integerValue"in e}function At(e){return!!e&&"arrayValue"in e}function xt(e){return!!e&&"nullValue"in e}function kt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Dt(e){return!!e&&"mapValue"in e}function Nt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Qe(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Nt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Nt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ot(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Pt(e){return"nullValue"in e?gt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?St(pt.empty(),B.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:y()}function Rt(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?St(pt.empty(),B.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?mt:y()}function Lt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Mt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Ft{constructor(e){this.value=e}static empty(){return new Ft({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Dt(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nt(t)}setAll(e){let t=q.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Nt(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Dt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return vt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Dt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Qe(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ft(Nt(this.value))}}function Ut(e){const t=[];return Qe(e.fields,((e,n)=>{const r=new q([e]);if(Dt(n)){const e=Ut(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new rt(t)}class Vt{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Vt(e,0,F.min(),F.min(),F.min(),Ft.empty(),0)}static newFoundDocument(e,t,n,r){return new Vt(e,1,t,F.min(),n,r,0)}static newNoDocument(e,t){return new Vt(e,2,t,F.min(),F.min(),Ft.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,F.min(),F.min(),Ft.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(F.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=F.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class jt{constructor(e,t){this.position=e,this.inclusive=t}}function qt(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?B.comparator(B.fromName(o.referenceValue),n.key):bt(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Bt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!vt(e.position[n],t.position[n]))return!1;return!0}class zt{constructor(e,t="asc"){this.field=e,this.dir=t}}function Gt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ht{}class Kt extends Ht{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new nn(e,t,n):"array-contains"===t?new an(e,n):"in"===t?new cn(e,n):"not-in"===t?new un(e,n):"array-contains-any"===t?new ln(e,n):new Kt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new rn(e,n):new sn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(bt(t,this.value)):null!==t&&yt(this.value)===yt(t)&&this.matchesComparison(bt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $t extends Ht{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new $t(e,t)}matches(e){return Wt(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Wt(e){return"and"===e.op}function Qt(e){return"or"===e.op}function Yt(e){return Xt(e)&&Wt(e)}function Xt(e){for(const t of e.filters)if(t instanceof $t)return!1;return!0}function Jt(e){if(e instanceof Kt)return e.field.canonicalString()+e.op.toString()+It(e.value);if(Yt(e))return e.filters.map((e=>Jt(e))).join(",");{const t=e.filters.map((e=>Jt(e))).join(",");return`${e.op}(${t})`}}function Zt(e,t){return e instanceof Kt?function(e,t){return t instanceof Kt&&e.op===t.op&&e.field.isEqual(t.field)&&vt(e.value,t.value)}(e,t):e instanceof $t?function(e,t){return t instanceof $t&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Zt(n,t.filters[r])),!0)}(e,t):void y()}function en(e,t){const n=e.filters.concat(t);return $t.create(n,e.op)}function tn(e){return e instanceof Kt?function(e){return`${e.field.canonicalString()} ${e.op} ${It(e.value)}`}(e):e instanceof $t?function(e){return e.op.toString()+" {"+e.getFilters().map(tn).join(" ,")+"}"}(e):"Filter"}class nn extends Kt{constructor(e,t,n){super(e,t,n),this.key=B.fromName(n.referenceValue)}matches(e){const t=B.comparator(e.key,this.key);return this.matchesComparison(t)}}class rn extends Kt{constructor(e,t){super(e,"in",t),this.keys=on(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sn extends Kt{constructor(e,t){super(e,"not-in",t),this.keys=on(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function on(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>B.fromName(e.referenceValue)))}class an extends Kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return At(t)&&wt(t.arrayValue,this.value)}}class cn extends Kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&wt(this.value.arrayValue,t)}}class un extends Kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(wt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!wt(this.value.arrayValue,t)}}class ln extends Kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!At(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>wt(this.value.arrayValue,e)))}}class hn{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function dn(e,t=null,n=[],r=[],i=null,s=null,o=null){return new hn(e,t,n,r,i,s,o)}function fn(e){const t=w(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Jt(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ge(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>It(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>It(e))).join(",")),t.ce=e}return t.ce}function pn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Gt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Zt(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Bt(e.startAt,t.startAt)&&Bt(e.endAt,t.endAt)}function mn(e){return B.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function gn(e,t){return e.filters.filter((e=>e instanceof Kt&&e.field.isEqual(t)))}function yn(e,t,n){let r=gt,i=!0;for(const n of gn(e,t)){let e=gt,t=!0;switch(n.op){case"<":case"<=":e=Pt(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=gt}Lt({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Lt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function vn(e,t,n){let r=mt,i=!0;for(const n of gn(e,t)){let e=mt,t=!0;switch(n.op){case">=":case">":e=Rt(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=mt}Mt({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Mt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class wn{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function bn(e,t,n,r,i,s,o,a){return new wn(e,t,n,r,i,s,o,a)}function _n(e){return new wn(e)}function In(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function En(e){return null!==e.collectionGroup}function Tn(e){const t=w(e);if(null===t.le){t.le=[];const e=new Set;for(const n of t.explicitOrderBy)t.le.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new et(q.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.le.push(new zt(r,n))})),e.has(q.keyField().canonicalString())||t.le.push(new zt(q.keyField(),n))}return t.le}function Sn(e){const t=w(e);return t.he||(t.he=Cn(t,Tn(e))),t.he}function Cn(e,t){if("F"===e.limitType)return dn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new zt(e.field,t)}));const n=e.endAt?new jt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new jt(e.startAt.position,e.startAt.inclusive):null;return dn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function An(e,t){const n=e.filters.concat([t]);return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function xn(e,t,n){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function kn(e,t){return pn(Sn(e),Sn(t))&&e.limitType===t.limitType}function Dn(e){return`${fn(Sn(e))}|lt:${e.limitType}`}function Nn(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>tn(e))).join(", ")}]`),ge(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>It(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>It(e))).join(",")),`Target(${t})`}(Sn(e))}; limitType=${e.limitType})`}function On(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):B.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Tn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=qt(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Tn(e),t)||e.endAt&&!function(e,t,n){const r=qt(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Tn(e),t))}(e,t)}function Pn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Rn(e){return(t,n)=>{let r=!1;for(const i of Tn(e)){const e=Ln(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ln(e,t,n){const r=e.field.isKeyField()?B.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?bt(r,i):y()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}class Mn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Qe(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Ye(this.inner)}size(){return this.innerSize}}const Fn=new Xe(B.comparator);function Un(){return Fn}const Vn=new Xe(B.comparator);function jn(...e){let t=Vn;for(const n of e)t=t.insert(n.key,n);return t}function qn(e){let t=Vn;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Bn(){return Gn()}function zn(){return Gn()}function Gn(){return new Mn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Hn=new Xe(B.comparator),Kn=new et(B.comparator);function $n(...e){let t=Kn;for(const n of e)t=t.add(n);return t}const Wn=new et(P);function Qn(){return Wn}function Yn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ye(t)?"-0":t}}function Xn(e){return{integerValue:""+e}}function Jn(e,t){return ve(t)?Xn(t):Yn(e,t)}class Zn{constructor(){this._=void 0}}function er(e,t,n){return e instanceof rr?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&lt(t)&&(t=ht(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ir?sr(e,t):e instanceof or?ar(e,t):function(e,t){const n=nr(e,t),r=ur(n)+ur(e.Ie);return Ct(n)&&Ct(e.Ie)?Xn(r):Yn(e.serializer,r)}(e,t)}function tr(e,t,n){return e instanceof ir?sr(e,t):e instanceof or?ar(e,t):n}function nr(e,t){return e instanceof cr?function(e){return Ct(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class rr extends Zn{}class ir extends Zn{constructor(e){super(),this.elements=e}}function sr(e,t){const n=lr(t);for(const t of e.elements)n.some((e=>vt(e,t)))||n.push(t);return{arrayValue:{values:n}}}class or extends Zn{constructor(e){super(),this.elements=e}}function ar(e,t){let n=lr(t);for(const t of e.elements)n=n.filter((e=>!vt(e,t)));return{arrayValue:{values:n}}}class cr extends Zn{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function ur(e){return ct(e.integerValue||e.doubleValue)}function lr(e){return At(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class hr{constructor(e,t){this.field=e,this.transform=t}}class dr{constructor(e,t){this.version=e,this.transformResults=t}}class fr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new fr}static exists(e){return new fr(void 0,e)}static updateTime(e){return new fr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class mr{}function gr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Cr(e.key,fr.none()):new _r(e.key,e.data,fr.none());{const n=e.data,r=Ft.empty();let i=new et(q.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Ir(e.key,r,new rt(i.toArray()),fr.none())}}function yr(e,t,n){e instanceof _r?function(e,t,n){const r=e.value.clone(),i=Tr(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ir?function(e,t,n){if(!pr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Tr(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Er(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function vr(e,t,n,r){return e instanceof _r?function(e,t,n,r){if(!pr(e.precondition,t))return n;const i=e.value.clone(),s=Sr(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ir?function(e,t,n,r){if(!pr(e.precondition,t))return n;const i=Sr(e.fieldTransforms,r,t),s=t.data;return s.setAll(Er(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return pr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function wr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=nr(r.transform,e||null);null!=i&&(null===n&&(n=Ft.empty()),n.set(r.field,i))}return n||null}function br(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&R(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ir&&t instanceof ir||e instanceof or&&t instanceof or?R(e.elements,t.elements,vt):e instanceof cr&&t instanceof cr?vt(e.Ie,t.Ie):e instanceof rr&&t instanceof rr}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class _r extends mr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ir extends mr{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Er(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Tr(e,t,n){const r=new Map;v(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,tr(o,a,n[i]))}return r}function Sr(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,er(e,s,t))}return r}class Cr extends mr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ar extends mr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class xr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&yr(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=vr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=vr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=zn();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=gr(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(F.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),$n())}isEqual(e){return this.batchId===e.batchId&&R(this.mutations,e.mutations,((e,t)=>br(e,t)))&&R(this.baseMutations,e.baseMutations,((e,t)=>br(e,t)))}}class kr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){v(e.mutations.length===n.length);let r=Hn;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new kr(e,t,n,r)}}class Dr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Nr{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class Or{constructor(e,t){this.count=e,this.unchangedNames=t}}var Pr,Rr;function Lr(e){switch(e){default:return y();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function Mr(e){if(void 0===e)return p("GRPC error has no .code"),b.UNKNOWN;switch(e){case Pr.OK:return b.OK;case Pr.CANCELLED:return b.CANCELLED;case Pr.UNKNOWN:return b.UNKNOWN;case Pr.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Pr.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Pr.INTERNAL:return b.INTERNAL;case Pr.UNAVAILABLE:return b.UNAVAILABLE;case Pr.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Pr.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Pr.NOT_FOUND:return b.NOT_FOUND;case Pr.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Pr.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Pr.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Pr.ABORTED:return b.ABORTED;case Pr.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Pr.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Pr.DATA_LOSS:return b.DATA_LOSS;default:return y()}}(Rr=Pr||(Pr={}))[Rr.OK=0]="OK",Rr[Rr.CANCELLED=1]="CANCELLED",Rr[Rr.UNKNOWN=2]="UNKNOWN",Rr[Rr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rr[Rr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rr[Rr.NOT_FOUND=5]="NOT_FOUND",Rr[Rr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rr[Rr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rr[Rr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rr[Rr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rr[Rr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rr[Rr.ABORTED=10]="ABORTED",Rr[Rr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rr[Rr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rr[Rr.INTERNAL=13]="INTERNAL",Rr[Rr.UNAVAILABLE=14]="UNAVAILABLE",Rr[Rr.DATA_LOSS=15]="DATA_LOSS";let Fr=null;function Ur(){return new TextEncoder}const Vr=new a.Integer([4294967295,4294967295],0);function jr(e){const t=Ur().encode(e),n=new a.Md5;return n.update(t),new Uint8Array(n.digest())}function qr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new a.Integer([n,r],0),new a.Integer([i,s],0)]}class Br{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new zr(`Invalid padding: ${t}`);if(n<0)throw new zr(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new zr(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new zr(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=a.Integer.fromNumber(this.Te)}de(e,t,n){let r=e.add(t.multiply(a.Integer.fromNumber(n)));return 1===r.compare(Vr)&&(r=new a.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=jr(e),[n,r]=qr(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);if(!this.Ae(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Br(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Te)return;const t=jr(e),[n,r]=qr(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);this.Re(t)}}Re(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class zr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Gr{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Hr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Gr(F.min(),r,new Xe(P),Un(),$n())}}class Hr{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Hr(n,t,$n(),$n(),$n())}}class Kr{constructor(e,t,n,r){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=r}}class $r{constructor(e,t){this.targetId=e,this.fe=t}}class Wr{constructor(e,t,n=st.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Qr{constructor(){this.ge=0,this.pe=Jr(),this.ye=st.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=$n(),t=$n(),n=$n();return this.pe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:y()}})),new Hr(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=Jr()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,v(this.ge>=0)}Le(){this.Se=!0,this.we=!0}}class Yr{constructor(e){this.Be=e,this.ke=new Map,this.qe=Un(),this.Qe=Xr(),this.Ke=new Xe(P)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,(t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:y()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach(((e,n)=>{this.je(n)&&t(n)}))}Je(e){const t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){const i=r.target;if(mn(i))if(0===n){const e=new B(i.path);this.We(t,e,Vt.newNoDocument(e,F.min()))}else v(1===n);else{const r=this.Ze(t);if(r!==n){const n=this.Xe(e),i=n?this.et(n,e,r):1;if(0!==i){this.He(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Fr||Fr.tt(function(e,t,n,r,i){var s,o,a,c,u,l;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(l=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.fe,this.Be.nt(),n,i))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=ut(n).toUint8Array()}catch(e){if(e instanceof it)return m("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Br(s,r,i)}catch(e){return m(e instanceof zr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Te?null:o}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Be.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Be.nt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.We(t,n,null),r++)})),r}it(e){const t=new Map;this.ke.forEach(((n,r)=>{const i=this.Ye(r);if(i){if(n.current&&mn(i.target)){const t=new B(i.target.path);null!==this.qe.get(t)||this.st(r,t)||this.We(r,t,Vt.newNoDocument(t,e))}n.De&&(t.set(r,n.ve()),n.Fe())}}));let n=$n();this.Qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.qe.forEach(((t,n)=>n.setReadTime(e)));const r=new Gr(e,t,this.Ke,this.qe,n);return this.qe=Un(),this.Qe=Xr(),this.Ke=new Xe(P),r}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Qr,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new et(P),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||f("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Be._t(e)}He(e){this.ke.set(e,new Qr),this.Be.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}st(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function Xr(){return new Xe(B.comparator)}function Jr(){return new Xe(B.comparator)}const Zr={asc:"ASCENDING",desc:"DESCENDING"},ei={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ti={and:"AND",or:"OR"};class ni{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ri(e,t){return e.useProto3Json||ge(t)?t:{value:t}}function ii(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function si(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function oi(e,t){return ii(e,t.toTimestamp())}function ai(e){return v(!!e),F.fromTimestamp(function(e){const t=at(e);return new M(t.seconds,t.nanos)}(e))}function ci(e,t){return ui(e,t).canonicalString()}function ui(e,t){const n=function(e){return new V(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function li(e){const t=V.fromString(e);return v(Oi(t)),t}function hi(e,t){return ci(e.databaseId,t.path)}function di(e,t){const n=li(t);if(n.get(1)!==e.databaseId.projectId)throw new _(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new _(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new B(gi(n))}function fi(e,t){return ci(e.databaseId,t)}function pi(e){const t=li(e);return 4===t.length?V.emptyPath():gi(t)}function mi(e){return new V(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function gi(e){return v(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function yi(e,t,n){return{name:hi(e,t),fields:n.value.mapValue.fields}}function vi(e,t,n){const r=di(e,t.name),i=ai(t.updateTime),s=t.createTime?ai(t.createTime):F.min(),o=new Ft({mapValue:{fields:t.fields}}),a=Vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function wi(e,t){let n;if(t instanceof _r)n={update:yi(e,t.key,t.value)};else if(t instanceof Cr)n={delete:hi(e,t.key)};else if(t instanceof Ir)n={update:yi(e,t.key,t.data),updateMask:Ni(t.fieldMask)};else{if(!(t instanceof Ar))return y();n={verify:hi(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof rr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ir)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof or)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof cr)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw y()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:oi(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y()}(e,t.precondition)),n}function bi(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?fr.updateTime(ai(e.updateTime)):void 0!==e.exists?fr.exists(e.exists):fr.none()}(t.currentDocument):fr.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue),n=new rr;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new ir(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new or(e)}else"increment"in t?n=new cr(e,t.increment):y();const r=q.fromServerFormat(t.fieldPath);return new hr(r,n)}(e,t))):[];if(t.update){t.update.name;const i=di(e,t.update.name),s=new Ft({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new rt(t.map((e=>q.fromServerFormat(e))))}(t.updateMask);return new Ir(i,s,e,n,r)}return new _r(i,s,n,r)}if(t.delete){const r=di(e,t.delete);return new Cr(r,n)}if(t.verify){const r=di(e,t.verify);return new Ar(r,n)}return y()}function _i(e,t){return{documents:[fi(e,t.path)]}}function Ii(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=fi(e,i);const s=function(e){if(0!==e.length)return Di($t.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:xi(e.field),direction:Si(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ri(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ut:n,parent:i}}function Ei(e){let t=pi(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){v(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ti(e);return t instanceof $t&&Yt(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new zt(ki(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ge(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new jt(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new jt(n,t)}(n.endAt)),bn(t,i,o,s,a,"F",c,u)}function Ti(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ki(e.unaryFilter.field);return Kt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=ki(e.unaryFilter.field);return Kt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ki(e.unaryFilter.field);return Kt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ki(e.unaryFilter.field);return Kt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return y()}}(e):void 0!==e.fieldFilter?function(e){return Kt.create(ki(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return y()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return $t.create(e.compositeFilter.filters.map((e=>Ti(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return y()}}(e.compositeFilter.op))}(e):y()}function Si(e){return Zr[e]}function Ci(e){return ei[e]}function Ai(e){return ti[e]}function xi(e){return{fieldPath:e.canonicalString()}}function ki(e){return q.fromServerFormat(e.fieldPath)}function Di(e){return e instanceof Kt?function(e){if("=="===e.op){if(kt(e.value))return{unaryFilter:{field:xi(e.field),op:"IS_NAN"}};if(xt(e.value))return{unaryFilter:{field:xi(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(kt(e.value))return{unaryFilter:{field:xi(e.field),op:"IS_NOT_NAN"}};if(xt(e.value))return{unaryFilter:{field:xi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xi(e.field),op:Ci(e.op),value:e.value}}}(e):e instanceof $t?function(e){const t=e.getFilters().map((e=>Di(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ai(e.op),filters:t}}}(e):y()}function Ni(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Oi(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Pi{constructor(e,t,n,r,i=F.min(),s=F.min(),o=st.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Pi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Pi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Pi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Pi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ri{constructor(e){this.ct=e}}function Li(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Mi(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:hi(e,t.key),fields:t.data.value.mapValue.fields,updateTime:ii(e,t.version.toTimestamp()),createTime:ii(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Fi(t.version)};else{if(!t.isUnknownDocument())return y();r.unknownDocument={path:n.path.toArray(),version:Fi(t.version)}}return r}function Mi(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Fi(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Ui(e){const t=new M(e.seconds,e.nanoseconds);return F.fromTimestamp(t)}function Vi(e,t){const n=(t.baseMutations||[]).map((t=>bi(e.ct,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>bi(e.ct,t))),i=M.fromMillis(t.localWriteTimeMs);return new xr(t.batchId,i,n,r)}function ji(e){const t=Ui(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Ui(e.lastLimboFreeSnapshotVersion):F.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return v(1===e.documents.length),Sn(_n(pi(e.documents[0])))}(e.query):function(e){return Sn(Ei(e))}(e.query),new Pi(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,st.fromBase64String(e.resumeToken))}function qi(e,t){const n=Fi(t.snapshotVersion),r=Fi(t.lastLimboFreeSnapshotVersion);let i;i=mn(t.target)?_i(e.ct,t.target):Ii(e.ct,t.target).ut;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:fn(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Bi(e){const t=Ei({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?xn(t,t.limit,"L"):t}function zi(e,t){return new Dr(t.largestBatchId,bi(e.ct,t.overlayMutation))}function Gi(e,t){const n=t.path.lastSegment();return[e,we(t.path.popLast()),n]}function Hi(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Fi(r.readTime),documentKey:we(r.documentKey.path),largestBatchId:r.largestBatchId}}class Ki{getBundleMetadata(e,t){return $i(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Ui(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return $i(e).put(function(e){return{bundleId:e.id,createTime:Fi(ai(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Wi(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:Bi(e.bundledQuery),readTime:Ui(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Wi(e).put(function(e){return{name:e.name,readTime:Fi(ai(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function $i(e){return $e(e,"bundles")}function Wi(e){return $e(e,"namedQueries")}class Qi{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new Qi(e,n)}getOverlay(e,t){return Yi(e).get(Gi(this.userId,t)).next((e=>e?zi(this.serializer,e):null))}getOverlays(e,t){const n=Bn();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new Dr(t,i);r.push(this.ht(e,s))})),re.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(we(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Yi(e).H("collectionPathOverlayIndex",r))})),re.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Bn(),i=we(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Yi(e).W("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=zi(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Bn();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Yi(e).Y({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=zi(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return Yi(e).put(function(e,t,n){const[r,i,s]=Gi(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:wi(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function Yi(e){return $e(e,"documentOverlays")}class Xi{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(ct(e.integerValue));else if("doubleValue"in e){const n=ct(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),ye(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(ut(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Ot(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):y()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),B.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}function Ji(e){if(0===e)return 8;let t=0;return!(e>>4)&&(t+=4,e<<=4),!(e>>6)&&(t+=2,e<<=2),!(e>>7)&&(t+=1),t}function Zi(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Ji(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Xi.bt=new Xi;class es{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ct(e);else if(e<2048)this.Ct(960|e>>>6),this.Ct(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ct(480|e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e);else{const e=t.codePointAt(0);this.Ct(240|e>>>18),this.Ct(128|63&e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e)}}this.vt()}Nt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Mt(e);else if(e<2048)this.Mt(960|e>>>6),this.Mt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e);else{const e=t.codePointAt(0);this.Mt(240|e>>>18),this.Mt(128|63&e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e)}}this.xt()}Lt(e){const t=this.Bt(e),n=Zi(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}qt(e){const t=this.Bt(e),n=Zi(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Ct(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class ts{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}}class ns{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class rs{constructor(){this.Gt=new es,this.zt=new ts(this.Gt),this.jt=new ns(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class is{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new is(this.indexId,this.documentKey,this.arrayValue,n)}}function ss(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=os(e.arrayValue,t.arrayValue),0!==n?n:(n=os(e.directionalValue,t.directionalValue),0!==n?n:B.comparator(e.documentKey,t.documentKey)))}function os(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class as{constructor(e){this.Yt=new et(((e,t)=>q.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Yt=this.Yt.add(e):this.Xt.push(e)}}get en(){return this.Yt.size>1}tn(e){if(v(e.collectionGroup===this.collectionId),this.en)return!1;const t=G(e);if(void 0!==t&&!this.nn(t))return!1;const n=H(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.nn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Yt.size>0){const e=this.Yt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.rn(e,t)||!this.sn(this.Zt[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Zt.length||!this.sn(this.Zt[s++],e))return!1}return!0}on(){if(this.en)return null;let e=new et(q.comparator);const t=[];for(const n of this.Xt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new $(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new $(n.field,0))}for(const n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new $(n.field,"asc"===n.dir?0:1)));return new z(z.UNKNOWN_ID,this.collectionId,t,Q.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function cs(e){var t,n;if(v(e instanceof Kt||e instanceof $t),e instanceof Kt){if(e instanceof cn){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Kt.create(e.field,"==",t))))||[];return $t.create(r,"or")}return e}const r=e.filters.map((e=>cs(e)));return $t.create(r,e.op)}function us(e){if(0===e.getFilters().length)return[];const t=fs(cs(e));return v(ds(t)),ls(t)||hs(t)?[t]:t.getFilters()}function ls(e){return e instanceof Kt}function hs(e){return e instanceof $t&&Yt(e)}function ds(e){return ls(e)||hs(e)||function(e){if(e instanceof $t&&Qt(e)){for(const t of e.getFilters())if(!ls(t)&&!hs(t))return!1;return!0}return!1}(e)}function fs(e){if(v(e instanceof Kt||e instanceof $t),e instanceof Kt)return e;if(1===e.filters.length)return fs(e.filters[0]);const t=e.filters.map((e=>fs(e)));let n=$t.create(t,e.op);return n=gs(n),ds(n)?n:(v(n instanceof $t),v(Wt(n)),v(n.filters.length>1),n.filters.reduce(((e,t)=>ps(e,t))))}function ps(e,t){let n;return v(e instanceof Kt||e instanceof $t),v(t instanceof Kt||t instanceof $t),n=e instanceof Kt?t instanceof Kt?function(e,t){return $t.create([e,t],"and")}(e,t):ms(e,t):t instanceof Kt?ms(t,e):function(e,t){if(v(e.filters.length>0&&t.filters.length>0),Wt(e)&&Wt(t))return en(e,t.getFilters());const n=Qt(e)?e:t,r=Qt(e)?t:e,i=n.filters.map((e=>ps(e,r)));return $t.create(i,"or")}(e,t),gs(n)}function ms(e,t){if(Wt(t))return en(t,e.getFilters());{const n=t.filters.map((t=>ps(e,t)));return $t.create(n,"or")}}function gs(e){if(v(e instanceof Kt||e instanceof $t),e instanceof Kt)return e;const t=e.getFilters();if(1===t.length)return gs(t[0]);if(Xt(e))return e;const n=t.map((e=>gs(e))),r=[];return n.forEach((t=>{t instanceof Kt?r.push(t):t instanceof $t&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:$t.create(r,e.op)}class ys{constructor(){this._n=new vs}addToCollectionParentIndex(e,t){return this._n.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(J.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(J.min())}updateCollectionGroup(e,t,n){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class vs{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new et(V.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new et(V.comparator)).toArray()}}const ws=new Uint8Array(0);class bs{constructor(e,t){this.databaseId=t,this.an=new vs,this.un=new Mn((e=>fn(e)),((e,t)=>pn(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.an.add(t)}));const i={collectionId:n,parent:we(r)};return _s(e).put(i)}return re.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[L(t),""],!1,!0);return _s(e).W(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Ie(r.parent))}return n}))}addFieldIndex(e,t){const n=Es(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Ts(e);return i.next((e=>{n.put(Hi(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=Es(e),r=Ts(e),i=Is(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Es(e),n=Is(e),r=Ts(e);return t.H().next((()=>n.H())).next((()=>r.H()))}createTargetIndexes(e,t){return re.forEach(this.cn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new as(t).on();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Is(e);let r=!0;const i=new Map;return re.forEach(this.cn(t),(t=>this.ln(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=$n();const r=[];return re.forEach(i,((i,s)=>{f("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${fn(t)}`);const o=function(e,t){const n=G(t);if(void 0===n)return null;for(const t of gn(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of H(t))for(const t of gn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of H(t)){const t=0===i.kind?yn(e,i.fieldPath,e.startAt):vn(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new jt(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of H(t)){const t=0===i.kind?vn(e,i.fieldPath,e.endAt):yn(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new jt(n,r)}(s,i),l=this.hn(i,s,c),h=this.hn(i,s,u),d=this.Pn(i,s,a),p=this.In(i.indexId,o,l,c.inclusive,h,u.inclusive,d);return re.forEach(p,(i=>n.j(i,t.limit).next((t=>{t.forEach((t=>{const n=B.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return re.resolve(null)}))}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:us($t.create(e.filters,"and")).map((t=>dn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.un.set(e,t),t)}In(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.Tn(t[l/c]):ws,h=this.En(e,a,n[l%c],r),d=this.dn(e,a,i[l%c],s),f=o.map((t=>this.En(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}En(e,t,n,r){const i=new is(e,B.empty(),t,n);return r?i:i.Jt()}dn(e,t,n,r){const i=new is(e,B.empty(),t,n);return r?i.Jt():i}ln(e,t){const n=new as(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.cn(t);return re.forEach(r,(t=>this.ln(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new et(q.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}An(e,t){const n=new rs;for(const r of H(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Ht(r.kind);Xi.bt.Pt(e,i)}return n.Wt()}Tn(e){const t=new rs;return Xi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const n=new rs;return Xi.bt.Pt(St(this.databaseId,t),n.Ht(function(e){const t=H(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(null===n)return[];let r=[];r.push(new rs);let i=0;for(const s of H(e)){const e=n[i++];for(const n of r)if(this.Vn(t,s.fieldPath)&&At(e))r=this.mn(r,s,e);else{const t=n.Ht(s.kind);Xi.bt.Pt(e,t)}}return this.fn(r)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new rs;r.seed(n.Wt()),Xi.bt.Pt(e,r.Ht(t.kind)),i.push(r)}return i}Vn(e,t){return!!e.filters.find((e=>e instanceof Kt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Es(e),r=Ts(e);return(t?n.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.W()).next((e=>{const t=[];return re.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Q(t.sequenceNumber,new J(Ui(t.readTime),new B(Ie(t.documentKey)),t.largestBatchId)):Q.empty(),r=e.fields.map((([e,t])=>new $(q.fromServerFormat(e),t)));return new z(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:P(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=Es(e),i=Ts(e);return this.gn(e).next((e=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>re.forEach(t,(t=>i.put(Hi(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return re.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?re.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),re.forEach(i,(n=>this.pn(e,t,n).next((t=>{const i=this.yn(r,n);return t.isEqual(i)?re.resolve():this.wn(e,r,n,t,i)})))))))}))}Sn(e,t,n,r){return Is(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,r){return Is(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){const r=Is(e);let i=new et(ss);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},((e,r)=>{i=i.add(new is(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}yn(e,t){let n=new et(ss);const r=this.An(t,e);if(null==r)return n;const i=G(t);if(null!=i){const s=e.data.field(i.fieldPath);if(At(s))for(const i of s.arrayValue.values||[])n=n.add(new is(t.indexId,e.key,this.Tn(i),r))}else n=n.add(new is(t.indexId,e.key,ws,r));return n}wn(e,t,n,r,i){f("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=nt(s),c=nt(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=nt(o)):t?(i(a),a=nt(s)):(a=nt(s),c=nt(o))}}(r,i,ss,(r=>{s.push(this.Sn(e,t,n,r))}),(r=>{s.push(this.bn(e,t,n,r))})),re.waitFor(s)}gn(e){let t=1;return Ts(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>ss(e,t))).filter(((e,t,n)=>!t||0!==ss(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=ss(i,e),s=ss(i,t);if(0===n)r[0]=e.Jt();else if(n>0&&s<0)r.push(i),r.push(i.Jt());else if(s>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2){if(this.Dn(r[e],r[e+1]))return[];const t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,ws,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,ws,[]];i.push(IDBKeyRange.bound(t,n))}return i}Dn(e,t){return ss(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ss)}getMinOffset(e,t){return re.mapArray(this.cn(t),(t=>this.ln(e,t).next((e=>e||y())))).next(Ss)}}function _s(e){return $e(e,"collectionParents")}function Is(e){return $e(e,"indexEntries")}function Es(e){return $e(e,"indexConfiguration")}function Ts(e){return $e(e,"indexState")}function Ss(e){v(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Z(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new J(t.readTime,t.documentKey,n)}const Cs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class As{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new As(e,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function xs(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Y({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{v(1===a)})));const u=[];for(const e of n.mutations){const r=Se(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return re.waitFor(s).next((()=>u))}function ks(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw y();t=e.noDocument}return JSON.stringify(t).length}As.DEFAULT_COLLECTION_PERCENTILE=10,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,As.DEFAULT=new As(41943040,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),As.DISABLED=new As(-1,0,0);class Ds{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Cn={}}static lt(e,t,n,r){v(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Ds(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Os(e).Y({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Ps(e),s=Os(e);return s.add({}).next((o=>{v("number"==typeof o);const a=new xr(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>wi(e.ct,t))),i=n.mutations.map((t=>wi(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let l=new et(((e,t)=>P(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Se(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,Ce))}return l.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Cn[o]=a.keys()})),re.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return Os(e).get(t).next((e=>e?(v(e.userId===this.userId),Vi(this.serializer,e)):null))}vn(e,t){return this.Cn[t]?re.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Cn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Os(e).Y({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(v(t.batchId>=n),i=Vi(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Os(e).Y({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Os(e).W("userMutationsIndex",t).next((e=>e.map((e=>Vi(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Te(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Ps(e).Y({range:r},((n,r,s)=>{const[o,a,c]=n,u=Ie(a);if(o===this.userId&&t.path.isEqual(u))return Os(e).get(c).next((e=>{if(!e)throw y();v(e.userId===this.userId),i.push(Vi(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new et(P);const r=[];return t.forEach((t=>{const i=Te(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Ps(e).Y({range:s},((e,r,i)=>{const[s,o,a]=e,c=Ie(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),re.waitFor(r).next((()=>this.Fn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Te(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new et(P);return Ps(e).Y({range:s},((e,t,i)=>{const[s,a,c]=e,u=Ie(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.Fn(e,o)))}Fn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Os(e).get(t).next((e=>{if(null===e)throw y();v(e.userId===this.userId),n.push(Vi(this.serializer,e))})))})),re.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return xs(e.ae,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Mn(t.batchId)})),re.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Ps(e).Y({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Ie(e[1]);r.push(t)}else n.done()})).next((()=>{v(0===r.length)}))}))}containsKey(e,t){return Ns(e,this.userId,t)}xn(e){return Rs(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function Ns(e,t,n){const r=Te(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ps(e).Y({range:s,J:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Os(e){return $e(e,"mutations")}function Ps(e){return $e(e,"documentMutations")}function Rs(e){return $e(e,"mutationQueues")}class Ls{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Ls(0)}static Ln(){return new Ls(-1)}}class Ms{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next((t=>{const n=new Ls(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Bn(e).next((e=>F.fromTimestamp(new M(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Bn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Bn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r))))}addTargetData(e,t){return this.qn(e,t).next((()=>this.Bn(e).next((n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Fs(e).delete(t.targetId))).next((()=>this.Bn(e))).next((t=>(v(t.targetCount>0),t.targetCount-=1,this.kn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Fs(e).Y(((s,o)=>{const a=ji(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>re.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Fs(e).Y(((e,n)=>{const r=ji(n);t(r)}))}Bn(e){return Us(e).get("targetGlobalKey").next((e=>(v(null!==e),e)))}kn(e,t){return Us(e).put("targetGlobalKey",t)}qn(e,t){return Fs(e).put(qi(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=fn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Fs(e).Y({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=ji(n);pn(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=Vs(e);return t.forEach((t=>{const s=we(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),re.waitFor(r)}removeMatchingKeys(e,t,n){const r=Vs(e);return re.forEach(t,(t=>{const i=we(t.path);return re.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=Vs(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Vs(e);let i=$n();return r.Y({range:n,J:!0},((e,t,n)=>{const r=Ie(e[1]),s=new B(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=we(t.path),r=IDBKeyRange.bound([n],[L(n)],!1,!0);let i=0;return Vs(e).Y({index:"documentTargetsIndex",J:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}_t(e,t){return Fs(e).get(t).next((e=>e?ji(e):null))}}function Fs(e){return $e(e,"targets")}function Us(e){return $e(e,"targetGlobal")}function Vs(e){return $e(e,"targetDocuments")}function js([e,t],[n,r]){const i=P(e,n);return 0===i?P(t,r):i}class qs{constructor(e){this.Kn=e,this.buffer=new et(js),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();js(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Bs{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}zn(e){f("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ce(e)?f("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await ne(e)}await this.zn(3e5)}))}}class zs{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return re.resolve(me._e);const n=new qs(t);return this.jn.forEachTarget(e,(e=>n.Wn(e.sequenceNumber))).next((()=>this.jn.Jn(e,(e=>n.Wn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(Cs)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Cs):this.Yn(e,t)))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,r,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(f("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(u=Date.now(),d()<=s.LogLevel.DEBUG&&f("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${r} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function Gs(e,t){return new zs(e,t)}class Hs{constructor(e,t){this.db=e,this.garbageCollector=Gs(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Zn(e){let t=0;return this.Jn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,((e,n)=>t(n)))}addReference(e,t,n){return Ks(e,n)}removeReference(e,t,n){return Ks(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Ks(e,t)}er(e,t){return function(e,t){let n=!1;return Rs(e).Z((r=>Ns(e,r,t).next((e=>(e&&(n=!0),re.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Xn(e,((s,o)=>{if(o<=t){const t=this.er(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,F.min()),Vs(e).delete(function(e){return[0,we(e.path)]}(s)))))}));r.push(t)}})).next((()=>re.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Ks(e,t)}Xn(e,t){const n=Vs(e);let r,i=me._e;return n.Y({index:"documentTargetsIndex"},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==me._e&&t(new B(Ie(r)),i),i=o,r=s):i=me._e})).next((()=>{i!==me._e&&t(new B(Ie(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ks(e,t){return Vs(e).put(function(e,t){return{targetId:0,path:we(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class $s{constructor(){this.changes=new Mn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?re.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ws{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Js(e).put(n)}removeEntry(e,t,n){return Js(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Mi(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.tr(e,n))))}getEntry(e,t){let n=Vt.newInvalidDocument(t);return Js(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Zs(t))},((e,r)=>{n=this.nr(t,r)})).next((()=>n))}rr(e,t){let n={size:0,document:Vt.newInvalidDocument(t)};return Js(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Zs(t))},((e,r)=>{n={document:this.nr(t,r),size:ks(r)}})).next((()=>n))}getEntries(e,t){let n=Un();return this.ir(e,t,((e,t)=>{const r=this.nr(e,t);n=n.insert(e,r)})).next((()=>n))}sr(e,t){let n=Un(),r=new Xe(B.comparator);return this.ir(e,t,((e,t)=>{const i=this.nr(e,t);n=n.insert(e,i),r=r.insert(e,ks(t))})).next((()=>({documents:n,_r:r})))}ir(e,t,n){if(t.isEmpty())return re.resolve();let r=new et(to);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Zs(r.first()),Zs(r.last())),s=r.getIterator();let o=s.getNext();return Js(e).Y({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=B.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&to(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.U(Zs(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),Mi(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Js(e).W(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=Un();for(const i of e){const e=this.nr(B.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(On(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=Un();const s=eo(t,n),o=eo(t,J.max());return Js(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.nr(B.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Ys(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Xs(e).get("remoteDocumentGlobalKey").next((e=>(v(!!e),e)))}tr(e,t){return Xs(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=vi(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=B.fromSegments(t.noDocument.path),r=Ui(t.noDocument.readTime);n=Vt.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return y();{const e=B.fromSegments(t.unknownDocument.path),r=Ui(t.unknownDocument.version);n=Vt.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new M(e[0],e[1]);return F.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(F.min()))return e}return Vt.newInvalidDocument(e)}}function Qs(e){return new Ws(e)}class Ys extends $s{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Mn((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new et(((e,t)=>P(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.ur.get(i);if(t.push(this.ar.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=Li(this.ar.serializer,s);r=r.add(i.path.popLast());const c=ks(a);n+=c-o.size,t.push(this.ar.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=Li(this.ar.serializer,s.convertToNoDocument(F.min()));t.push(this.ar.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.ar.updateMetadata(e,n)),re.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next((e=>(this.ur.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.ar.sr(e,t).next((({documents:e,_r:t})=>(t.forEach(((t,n)=>{this.ur.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function Xs(e){return $e(e,"remoteDocumentGlobal")}function Js(e){return $e(e,"remoteDocumentsV14")}function Zs(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function eo(e,t){const n=t.documentKey.path.toArray();return[e,Mi(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function to(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=P(n[e],r[e]),i)return i;return i=P(n.length,r.length),i||(i=P(n[n.length-2],r[r.length-2]),i||P(n[n.length-1],r[r.length-1]))}class no{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ro{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&vr(n.mutation,e,rt.empty(),M.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,$n()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=$n()){const r=Bn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=jn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Bn();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,$n())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Un();const s=Gn(),o=Gn();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Ir)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),vr(o.mutation,t,o.mutation.getFieldMask(),M.now())):s.set(t.key,rt.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new no(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Gn();let r=new Xe(((e,t)=>e-t)),i=$n();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||rt.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||$n()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=zn();c.forEach((e=>{if(!i.has(e)){const r=gr(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return re.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return B.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):En(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):re.resolve(Bn());let o=-1,a=i;return s.next((t=>re.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?re.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,$n()))).next((e=>({batchId:o,changes:qn(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next((e=>{let t=jn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=jn();return this.indexManager.getCollectionParents(e,i).next((o=>re.forEach(o,(o=>{const a=function(e,t){return new wn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Vt.newInvalidDocument(r)))}));let n=jn();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&vr(s.mutation,r,rt.empty(),M.now()),On(t,r)&&(n=n.insert(e,r))})),n}))}}class io{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return re.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ai(e.createTime)}}(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Bi(e.bundledQuery),readTime:ai(e.readTime)}}(t)),re.resolve()}}class so{constructor(){this.overlays=new Xe(B.comparator),this.hr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Bn();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),re.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),re.resolve()}getOverlaysForCollection(e,t,n){const r=Bn(),i=t.length+1,s=new B(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Xe(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Bn(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Bn(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return re.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Dr(t,n));let i=this.hr.get(t);void 0===i&&(i=$n(),this.hr.set(t,i)),this.hr.set(t,i.add(n.key))}}class oo{constructor(){this.Pr=new et(ao.Ir),this.Tr=new et(ao.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new ao(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new ao(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new B(new V([])),n=new ao(t,e),r=new ao(t,e+1),i=[];return this.Tr.forEachInRange([n,r],(e=>{this.Ar(e),i.push(e.key)})),i}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new B(new V([])),n=new ao(t,e),r=new ao(t,e+1);let i=$n();return this.Tr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new ao(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ao{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return B.comparator(e.key,t.key)||P(e.pr,t.pr)}static Er(e,t){return P(e.pr,t.pr)||B.comparator(e.key,t.key)}}class co{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new et(ao.Ir)}checkEmpty(e){return re.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new xr(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.wr=this.wr.add(new ao(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),i=r<0?0:r;return re.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ao(t,0),r=new ao(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(e=>{const t=this.Sr(e.pr);i.push(t)})),re.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new et(P);return t.forEach((e=>{const t=new ao(e,0),r=new ao(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],(e=>{n=n.add(e.pr)}))})),re.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;B.isDocumentKey(i)||(i=i.child(""));const s=new ao(new B(i),0);let o=new et(P);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.pr)),!0)}),s),re.resolve(this.Dr(o))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){v(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return re.forEach(t.mutations,(r=>{const i=new ao(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new ao(t,0),r=this.wr.firstAfterOrEqual(n);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class uo{constructor(e){this.vr=e,this.docs=new Xe(B.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return re.resolve(n?n.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let n=Un();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Vt.newInvalidDocument(e))})),re.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Un();const s=t.path,o=new B(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Z(X(o),n)<=0||(r.has(o.key)||On(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return re.resolve(i)}getAllFromCollectionGroup(e,t,n,r){y()}Fr(e,t){return re.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new lo(this)}getSize(e){return re.resolve(this.size)}}class lo extends $s{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)})),re.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class ho{constructor(e){this.persistence=e,this.Mr=new Mn((e=>fn(e)),pn),this.lastRemoteSnapshotVersion=F.min(),this.highestTargetId=0,this.Or=0,this.Nr=new oo,this.targetCount=0,this.Lr=Ls.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),re.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Ls(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.qn(t),re.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),re.waitFor(i).next((()=>r))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return re.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),re.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),re.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return re.resolve(n)}containsKey(e,t){return re.resolve(this.Nr.containsKey(t))}}class fo{constructor(e,t){this.Br={},this.overlays={},this.kr=new me(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new ho(this),this.indexManager=new ys,this.remoteDocumentCache=function(e){return new uo(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Ri(t),this.$r=new io(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new so,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new co(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){f("MemoryPersistence","Starting transaction:",e);const r=new po(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((e=>this.referenceDelegate.Wr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gr(e,t){return re.or(Object.values(this.Br).map((n=>()=>n.containsKey(e,t))))}}class po extends te{constructor(e){super(),this.currentSequenceNumber=e}}class mo{constructor(e){this.persistence=e,this.zr=new oo,this.jr=null}static Hr(e){return new mo(e)}get Jr(){if(this.jr)return this.jr;throw y()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),re.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),re.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Jr,(n=>{const r=B.fromPath(n);return this.Yr(e,r).next((e=>{e||t.removeEntry(r,F.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return re.or([()=>re.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class go{constructor(e,t){this.persistence=e,this.Zr=new Mn((e=>we(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Gs(this,t)}static Hr(e,t){return new go(e,t)}Ur(){}Wr(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Hn(e){const t=this.Zn(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Zn(e){let t=0;return this.Jn(e,(e=>{t++})).next((()=>t))}Jn(e,t){return re.forEach(this.Zr,((n,r)=>this.er(e,n,r).next((e=>e?re.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.Fr(e,(r=>this.er(e,r,t).next((e=>{e||(n++,i.removeEntry(r,F.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.Zr.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),re.resolve()}removeReference(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.Zr.set(t,e.currentSequenceNumber),re.resolve()}Kr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Tt(e.data.value)),t}er(e,t,n){return re.or([()=>this.persistence.Gr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Zr.get(t);return re.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class yo{constructor(e){this.serializer=e}N(e,t,n,r){const i=new ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ee,{unique:!0}),e.createObjectStore("documentMutations")}(e),vo(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=re.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),vo(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:F.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").W().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ee,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return re.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Xr(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ei(i))))),n<7&&r>=7&&(s=s.next((()=>this.ti(i)))),n<8&&r>=8&&(s=s.next((()=>this.ni(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.ri(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Ue});t.createIndex("collectionPathOverlayIndex",Ve,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",je,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:Ae});t.createIndex("documentKeyIndex",xe),t.createIndex("collectionGroupIndex",ke)}(e))).next((()=>this.ii(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.si(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Re}).createIndex("sequenceNumberIndex",Le,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Me}).createIndex("documentKeyIndex",Fe,{unique:!1})}(e)))),s}ei(e){let t=0;return e.store("remoteDocuments").Y(((e,n)=>{t+=ks(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Xr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.W().next((t=>re.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.W("userMutationsIndex",r).next((n=>re.forEach(n,(n=>{v(n.userId===t.userId);const r=Vi(this.serializer,n);return xs(e,t.userId,r).next((()=>{}))}))))}))))}ti(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.Y(((n,i)=>{const s=new V(n),o=function(e){return[0,we(e)]}(s);r.push(t.get(o).next((n=>n?re.resolve():(n=>t.put({targetId:0,path:we(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>re.waitFor(r)))}))}ni(e,t){e.createObjectStore("collectionParents",{keyPath:Pe});const n=t.store("collectionParents"),r=new vs,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:we(r)})}};return t.store("remoteDocuments").Y({J:!0},((e,t)=>{const n=new V(e);return i(n.popLast())})).next((()=>t.store("documentMutations").Y({J:!0},(([e,t,n],r)=>{const s=Ie(t);return i(s.popLast())}))))}ri(e){const t=e.store("targets");return t.Y(((e,n)=>{const r=ji(n),i=qi(this.serializer,r);return t.put(i)}))}ii(e,t){const n=t.store("remoteDocuments"),r=[];return n.Y(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new B(V.fromString(e.document.name).popFirst(5)):e.noDocument?B.fromSegments(e.noDocument.path):e.unknownDocument?B.fromSegments(e.unknownDocument.path):y()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>re.waitFor(r)))}si(e,t){const n=t.store("mutations"),r=Qs(this.serializer),i=new fo(mo.Hr,this.serializer.ct);return n.W().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:$n();Vi(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),re.forEach(n,((e,n)=>{const s=new u(n),o=Qi.lt(this.serializer,s),a=i.getIndexManager(s),c=Ds.lt(s,this.serializer,a,i.referenceDelegate);return new ro(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Ke(t,me._e),e).next()}))}))}}function vo(e){e.createObjectStore("targetDocuments",{keyPath:Ne}).createIndex("documentTargetsIndex",Oe,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",De,{unique:!0}),e.createObjectStore("targetGlobal")}const wo="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class bo{constructor(e,t,n,r,i,s,o,a,c,u,l=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=i,this.window=s,this.document=o,this._i=c,this.ai=u,this.ui=l,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=e=>Promise.resolve(),!bo.D())throw new _(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Hs(this,r),this.Ti=t+"main",this.serializer=new Ri(a),this.Ei=new se(this.Ti,this.ui,new yo(this.serializer)),this.Qr=new Ms(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Qs(this.serializer),this.$r=new Ki,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===u&&p("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _(b.FAILED_PRECONDITION,wo);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Qr.getHighestSequenceNumber(e)))})).then((e=>{this.kr=new me(e,this._i)})).then((()=>{this.qr=!0})).catch((e=>(this.Ei&&this.Ei.close(),Promise.reject(e))))}fi(e){return this.Ii=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget((async()=>{this.started&&await this.Ai()})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Io(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.gi(e).next((e=>{e||(this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))))}))})).next((()=>this.pi(e))).next((t=>this.isPrimary&&!t?this.yi(e).next((()=>!1)):!!t&&this.wi(e).next((()=>!0)))))).catch((e=>{if(ce(e))return f("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return f("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.oi.enqueueRetryable((()=>this.Ii(e))),this.isPrimary=e}))}gi(e){return _o(e).get("owner").next((e=>re.resolve(this.Si(e))))}bi(e){return Io(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=$e(e,"clientMetadata");return t.W().next((e=>{const n=this.vi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return re.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ai().then((()=>this.Di())).then((()=>this.mi()))))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?re.resolve(!0):_o(e).get("owner").next((t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new _(b.FAILED_PRECONDITION,wo);return!1}}return!(!this.networkEnabled||!this.inForeground)||Io(e).W().next((e=>void 0===this.vi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&f("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Ke(e,me._e);return this.yi(t).next((()=>this.bi(t)))})),this.Ei.close(),this.Li()}vi(e,t){return e.filter((e=>this.Ci(e.updateTimeMs,t)&&!this.Mi(e.clientId)))}Bi(){return this.runTransaction("getActiveClients","readonly",(e=>Io(e).W().next((e=>this.vi(e,18e5).map((e=>e.clientId))))))}get started(){return this.qr}getMutationQueue(e,t){return Ds.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bs(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Qi.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){f("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 15===e?He:14===e?Ge:13===e?ze:12===e?Be:11===e?qe:void y()}(this.ui);let s;return this.Ei.runTransaction(e,r,i,(r=>(s=new Ke(r,this.kr?this.kr.next():me._e),"readwrite-primary"===t?this.gi(s).next((e=>!!e||this.pi(s))).next((t=>{if(!t)throw p(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))),new _(b.FAILED_PRECONDITION,ee);return n(s)})).next((e=>this.wi(s).next((()=>e)))):this.ki(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}ki(e){return _o(e).get("owner").next((e=>{if(null!==e&&this.Ci(e.leaseTimestampMs,5e3)&&!this.Mi(e.ownerId)&&!this.Si(e)&&!(this.ai||this.allowTabSynchronization&&e.allowTabSynchronization))throw new _(b.FAILED_PRECONDITION,wo)}))}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _o(e).put("owner",t)}static D(){return se.D()}yi(e){const t=_o(e);return t.get("owner").next((e=>this.Si(e)?(f("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):re.resolve()))}Ci(e,t){const n=Date.now();return!(e<n-t||e>n&&(p(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=()=>{this.oi.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Ai())))},this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;o.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return f("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return p("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){p("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch(e){}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function _o(e){return $e(e,"owner")}function Io(e){return $e(e,"clientMetadata")}function Eo(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class To{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=$n(),r=$n();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new To(e,t.fromCache,n,r)}}class So{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Co{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=o.isSafari()?8:se.v(o.getUA())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ji(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Hi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new So;return this.Ji(e,t,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(e,t,n,r.size)}))})).next((()=>i.result))}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(d()<=s.LogLevel.DEBUG&&f("QueryEngine","SDK will not create cache indexes for query:",Nn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),re.resolve()):(d()<=s.LogLevel.DEBUG&&f("QueryEngine","Query:",Nn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(d()<=s.LogLevel.DEBUG&&f("QueryEngine","The SDK decides to create cache indexes for query:",Nn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sn(t))):re.resolve())}ji(e,t){if(In(t))return re.resolve(null);let n=Sn(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=xn(t,null,"F"),n=Sn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=$n(...r);return this.zi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Zi(t,r);return this.Xi(t,s,i,n.readTime)?this.ji(e,xn(t,null,"F")):this.es(e,s,t,n)}))))})))))}Hi(e,t,n,r){return In(t)||r.isEqual(F.min())?re.resolve(null):this.zi.getDocuments(e,n).next((i=>{const o=this.Zi(t,i);return this.Xi(t,o,n,r)?re.resolve(null):(d()<=s.LogLevel.DEBUG&&f("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Nn(t)),this.es(e,o,t,Y(r,-1)).next((e=>e)))}))}Zi(e,t){let n=new et(Rn(e));return t.forEach(((t,r)=>{On(e,r)&&(n=n.add(r))})),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(e,t,n){return d()<=s.LogLevel.DEBUG&&f("QueryEngine","Using full collection scan to execute query:",Nn(t)),this.zi.getDocumentsMatchingQuery(e,t,J.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Ao{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new Xe(P),this.rs=new Mn((e=>fn(e)),pn),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ro(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}function xo(e,t,n,r){return new Ao(e,t,n,r)}async function ko(e,t){const n=w(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=$n();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({us:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function Do(e){const t=w(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function No(e,t,n){let r=$n(),i=$n();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Un();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(F.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):f("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:r,ls:i}}))}function Oo(e,t){const n=w(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Po(e,t){const n=w(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Qr.getTargetData(e,t).next((i=>i?(r=i,re.resolve(r)):n.Qr.allocateTargetId(e).next((i=>(r=new Pi(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e}))}async function Ro(e,t,n){const r=w(e),i=r.ns.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ce(e))throw e;f("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ns=r.ns.remove(t),r.rs.delete(i.target)}function Lo(e,t,n){const r=w(e);let i=F.min(),s=$n();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=w(e),i=r.rs.get(n);return void 0!==i?re.resolve(r.ns.get(i)):r.Qr.getTargetData(t,n)}(r,e,Sn(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ts.getDocumentsMatchingQuery(e,t,n?i:F.min(),n?s:$n()))).next((e=>(Uo(r,Pn(t),e),{documents:e,hs:s})))))}function Mo(e,t){const n=w(e),r=w(n.Qr),i=n.ns.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r._t(e,t).next((e=>e?e.target:null))))}function Fo(e,t){const n=w(e),r=n.ss.get(t)||F.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.os.getAllFromCollectionGroup(e,t,Y(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(Uo(n,t,e),e)))}function Uo(e,t,n){let r=e.ss.get(t)||F.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ss.set(t,r)}async function Vo(e,t,n=$n()){const r=await Po(e,Sn(Bi(t.bundledQuery))),i=w(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=ai(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.$r.saveNamedQuery(e,t);const o=r.withResumeToken(st.EMPTY_BYTE_STRING,s);return i.ns=i.ns.insert(o.targetId,o),i.Qr.updateTargetData(e,o).next((()=>i.Qr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Qr.addMatchingKeys(e,n,r.targetId))).next((()=>i.$r.saveNamedQuery(e,t)))}))}function jo(e,t){return`firestore_clients_${e}_${t}`}function qo(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function Bo(e,t){return`firestore_targets_${e}_${t}`}class zo{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Es(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new _(r.error.code,r.error.message))),s?new zo(e,t,r.state,i):(p("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Go{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new _(n.error.code,n.error.message))),i?new Go(e,n.state,r):(p("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ho{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Qn();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=ve(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Ho(e,i):(p("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ko{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Ko(t.clientId,t.onlineState):(p("SharedClientState",`Failed to parse online state: ${e}`),null)}}class $o{constructor(){this.activeTargetIds=Qn()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Wo{constructor(e,t,n,r,i){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Xe(P),this.started=!1,this.ys=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ws=jo(this.persistenceKey,this.Vs),this.Ss=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new $o),this.bs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.vs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Fs=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const t of e){if(t===this.Vs)continue;const e=this.getItem(jo(this.persistenceKey,t));if(e){const n=Ho.Es(t,e);n&&(this.ps=this.ps.insert(n.clientId,n))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const e=this.xs(t);e&&this.Os(e)}for(const e of this.ys)this.gs(e);this.ys=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(Bo(this.persistenceKey,e));if(n){const r=Go.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bo(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Bs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return f("SharedClientState","READ",e,t),t}setItem(e,t){f("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){f("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(f("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.bs.test(t.key)){if(null==t.newValue){const e=this.$s(t.key);return this.Us(e,null)}{const e=this.Ws(t.key,t.newValue);if(e)return this.Us(e.clientId,e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.Gs(t.key,t.newValue);if(e)return this.zs(e)}}else if(this.Cs.test(t.key)){if(null!==t.newValue){const e=this.js(t.key,t.newValue);if(e)return this.Hs(e)}}else if(t.key===this.vs){if(null!==t.newValue){const e=this.xs(t.newValue);if(e)return this.Os(e)}}else if(t.key===this.Ss){const e=function(e){let t=me._e;if(null!=e)try{const n=JSON.parse(e);v("number"==typeof n),t=n}catch(e){p("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==me._e&&this.sequenceNumberHandler(e)}else if(t.key===this.Fs){const e=this.Js(t.newValue);await Promise.all(e.map((e=>this.syncEngine.Ys(e))))}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){const r=new zo(this.currentUser,e,t,n),i=qo(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ds())}Bs(e){const t=qo(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){const r=Bo(this.persistenceKey,e),i=new Go(e,t,n);this.setItem(r,i.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const n=this.$s(e);return Ho.Es(n,t)}Gs(e,t){const n=this.Ds.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return zo.Es(new u(i),r,t)}js(e,t){const n=this.Cs.exec(e),r=Number(n[1]);return Go.Es(r,t)}xs(e){return Ko.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);f("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const n=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),i=this.Ns(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.eo(s,o).then((()=>{this.ps=n}))}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Qn();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Qo{constructor(){this.no=new $o,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new $o,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Yo{io(e){}shutdown(){}}class Xo{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){f("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){f("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Jo=null;function Zo(){return null===Jo?Jo=268435456+Math.round(2147483648*Math.random()):Jo++,"0x"+Jo.toString(16)}const ea={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ta{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const na="WebChannelConnection";class ra extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(e,t,n,r,i){const s=Zo(),o=this.bo(e,t.toUriEncodedString());f("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(e,o,a,n).then((t=>(f("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw m("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,r,i,s){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+l,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=ea[e];return`${this.fo}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,r){const i=Zo();return new Promise(((s,o)=>{const c=new a.XhrIo;c.setWithCredentials(!0),c.listenOnce(a.EventType.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case a.ErrorCode.NO_ERROR:const t=c.getResponseJson();f(na,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case a.ErrorCode.TIMEOUT:f(na,`RPC '${e}' ${i} timed out`),o(new _(b.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:const n=c.getStatus();if(f(na,`RPC '${e}' ${i} failed with status:`,n,"response text:",c.getResponseText()),n>0){let e=c.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(t)>=0?t:b.UNKNOWN}(t.status);o(new _(e,t.message))}else o(new _(b.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new _(b.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{f(na,`RPC '${e}' ${i} completed.`)}}));const u=JSON.stringify(r);f(na,`RPC '${e}' ${i} sending request:`,r),c.send(t,"POST",u,n,15)}))}Fo(e,t,n){const r=Zo(),i=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=a.createWebChannelTransport(),o=a.getStatEventTarget(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const l=i.join("");f(na,`Creating RPC '${e}' stream ${r}: ${l}`,c);const h=s.createWebChannel(l,c);let d=!1,p=!1;const g=new ta({lo:t=>{p?f(na,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(f(na,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),f(na,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},ho:()=>h.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(h,a.WebChannel.EventType.OPEN,(()=>{p||f(na,`RPC '${e}' stream ${r} transport opened.`)})),y(h,a.WebChannel.EventType.CLOSE,(()=>{p||(p=!0,f(na,`RPC '${e}' stream ${r} transport closed`),g.Vo())})),y(h,a.WebChannel.EventType.ERROR,(t=>{p||(p=!0,m(na,`RPC '${e}' stream ${r} transport errored:`,t),g.Vo(new _(b.UNAVAILABLE,"The operation could not be completed")))})),y(h,a.WebChannel.EventType.MESSAGE,(t=>{var n;if(!p){const i=t.data[0];v(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){f(na,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=Pr[e];if(void 0!==t)return Mr(t)}(t),i=o.message;void 0===n&&(n=b.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),p=!0,g.Vo(new _(n,i)),h.close()}else f(na,`RPC '${e}' stream ${r} received:`,i),g.mo(i)}})),y(o,a.Event.STAT_EVENT,(t=>{t.stat===a.Stat.PROXY?f(na,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===a.Stat.NOPROXY&&f(na,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{g.Ro()}),0),g}}function ia(){return"undefined"!=typeof window?window:null}function sa(){return"undefined"!=typeof document?document:null}function oa(e){return new ni(e,!0)}class aa{constructor(e,t,n=1e3,r=1.5,i=6e4){this.oi=e,this.timerId=t,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-n);r>0&&f("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class ca{constructor(e,t,n,r,i,s,o,a){this.oi=e,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new aa(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(p(t.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===b.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Wo===t&&this.o_(e,n)}),(t=>{e((()=>{const e=new _(b.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{n((()=>this.__(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return f("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(f("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ua extends ca{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:y()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(v(void 0===t||"string"==typeof t),st.fromBase64String(t||"")):(v(void 0===t||t instanceof Uint8Array),st.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?b.UNKNOWN:Mr(e.code);return new _(t,e.message||"")}(o);n=new Wr(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=di(e,r.document.name),s=ai(r.document.updateTime),o=r.document.createTime?ai(r.document.createTime):F.min(),a=new Ft({mapValue:{fields:r.document.fields}}),c=Vt.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Kr(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=di(e,r.document),s=r.readTime?ai(r.readTime):F.min(),o=Vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Kr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=di(e,r.document),s=r.removedTargetIds||[];n=new Kr([],s,i,null)}else{if(!("filter"in t))return y();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Or(r,i),o=e.targetId;n=new $r(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return F.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?F.min():t.readTime?ai(t.readTime):F.min()}(e);return this.listener.u_(t,n)}c_(e){const t={};t.database=mi(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=mn(r)?{documents:_i(e,r)}:{query:Ii(e,r).ut},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=si(e,t.resumeToken);const r=ri(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(F.min())>0){n.readTime=ii(e,t.snapshotVersion.toTimestamp());const r=ri(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return y()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.t_(t)}l_(e){const t={};t.database=mi(this.serializer),t.removeTarget=e,this.t_(t)}}class la extends ca{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(v(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=function(e,t){return e&&e.length>0?(v(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?ai(e.updateTime):ai(t);return n.isEqual(F.min())&&(n=ai(t)),new dr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ai(e.commitTime);return this.listener.T_(n,t)}return v(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=mi(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>wi(this.serializer,e)))};this.t_(t)}}class ha extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new _(b.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.So(e,ui(t,n),r,i,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(b.UNKNOWN,e.toString())}))}vo(e,t,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(e,ui(t,n),r,s,o,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(b.UNKNOWN,e.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class da{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(p(t),this.g_=!1):f("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class fa{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((e=>{n.enqueueAndForget((async()=>{Ia(this)&&(f("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=w(e);t.v_.add(4),await ma(t),t.x_.set("Unknown"),t.v_.delete(4),await pa(t)}(this))}))})),this.x_=new da(n,r)}}async function pa(e){if(Ia(e))for(const t of e.F_)await t(!0)}async function ma(e){for(const t of e.F_)await t(!1)}function ga(e,t){const n=w(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),_a(n)?ba(n):ja(n).Jo()&&va(n,t))}function ya(e,t){const n=w(e),r=ja(n);n.C_.delete(t),r.Jo()&&wa(n,t),0===n.C_.size&&(r.Jo()?r.Xo():Ia(n)&&n.x_.set("Unknown"))}function va(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(F.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ja(e).c_(t)}function wa(e,t){e.O_.Oe(t),ja(e).l_(t)}function ba(e){e.O_=new Yr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),ja(e).start(),e.x_.p_()}function _a(e){return Ia(e)&&!ja(e).Ho()&&e.C_.size>0}function Ia(e){return 0===w(e).v_.size}function Ea(e){e.O_=void 0}async function Ta(e){e.C_.forEach(((t,n)=>{va(e,t)}))}async function Sa(e,t){Ea(e),_a(e)?(e.x_.S_(t),ba(e)):e.x_.set("Unknown")}async function Ca(e,t,n){if(e.x_.set("Online"),t instanceof Wr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.C_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.C_.delete(r),e.O_.removeTarget(r))}(e,t)}catch(n){f("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Aa(e,n)}else if(t instanceof Kr?e.O_.$e(t):t instanceof $r?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(F.min()))try{const t=await Do(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.O_.it(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.C_.get(r);i&&e.C_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.C_.get(t);if(!r)return;e.C_.set(t,r.withResumeToken(st.EMPTY_BYTE_STRING,r.snapshotVersion)),wa(e,t);const i=new Pi(r.target,t,n,r.sequenceNumber);va(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){f("RemoteStore","Failed to raise snapshot:",t),await Aa(e,t)}}async function Aa(e,t,n){if(!ce(t))throw t;e.v_.add(1),await ma(e),e.x_.set("Offline"),n||(n=()=>Do(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{f("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await pa(e)}))}function xa(e,t){return t().catch((n=>Aa(e,n,t)))}async function ka(e){const t=w(e),n=qa(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;Da(t);)try{const e=await Oo(t.localStore,r);if(null===e){0===t.D_.length&&n.Xo();break}r=e.batchId,Na(t,e)}catch(e){await Aa(t,e)}Oa(t)&&Pa(t)}function Da(e){return Ia(e)&&e.D_.length<10}function Na(e,t){e.D_.push(t);const n=qa(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Oa(e){return Ia(e)&&!qa(e).Ho()&&e.D_.length>0}function Pa(e){qa(e).start()}async function Ra(e){qa(e).d_()}async function La(e){const t=qa(e);for(const n of e.D_)t.I_(n.mutations)}async function Ma(e,t,n){const r=e.D_.shift(),i=kr.from(r,t,n);await xa(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await ka(e)}async function Fa(e,t){t&&qa(e).P_&&await async function(e,t){if(function(e){return Lr(e)&&e!==b.ABORTED}(t.code)){const n=e.D_.shift();qa(e).Zo(),await xa(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ka(e)}}(e,t),Oa(e)&&Pa(e)}async function Ua(e,t){const n=w(e);n.asyncQueue.verifyOperationInProgress(),f("RemoteStore","RemoteStore received new credentials");const r=Ia(n);n.v_.add(3),await ma(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await pa(n)}async function Va(e,t){const n=w(e);t?(n.v_.delete(2),await pa(n)):t||(n.v_.add(2),await ma(n),n.x_.set("Unknown"))}function ja(e){return e.N_||(e.N_=function(e,t,n){const r=w(e);return r.R_(),new ua(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Ta.bind(null,e),To:Sa.bind(null,e),u_:Ca.bind(null,e)}),e.F_.push((async t=>{t?(e.N_.Zo(),_a(e)?ba(e):e.x_.set("Unknown")):(await e.N_.stop(),Ea(e))}))),e.N_}function qa(e){return e.L_||(e.L_=function(e,t,n){const r=w(e);return r.R_(),new la(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Ra.bind(null,e),To:Fa.bind(null,e),E_:La.bind(null,e),T_:Ma.bind(null,e)}),e.F_.push((async t=>{t?(e.L_.Zo(),await ka(e)):(await e.L_.stop(),e.D_.length>0&&(f("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))}))),e.L_}class Ba{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new I,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ba(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function za(e,t){if(p("AsyncQueue",`${t}: ${e}`),ce(e))return new _(b.UNAVAILABLE,`${t}: ${e}`);throw e}class Ga{constructor(e){this.comparator=e?(t,n)=>e(t,n)||B.comparator(t.key,n.key):(e,t)=>B.comparator(e.key,t.key),this.keyedMap=jn(),this.sortedSet=new Xe(this.comparator)}static emptySet(e){return new Ga(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ga))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Ga;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ha{constructor(){this.B_=new Xe(B.comparator)}track(e){const t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):y():this.B_=this.B_.insert(t,e)}k_(){const e=[];return this.B_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Ka{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Ka(e,t,Ga.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class $a{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some((e=>e.U_()))}}class Wa{constructor(){this.queries=new Mn((e=>Dn(e)),kn),this.onlineState="Unknown",this.W_=new Set}}async function Qa(e,t){const n=w(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.K_()&&t.U_()&&(r=2):(s=new $a,r=t.U_()?0:1);try{switch(r){case 0:s.q_=await n.onListen(i,!0);break;case 1:s.q_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=za(e,`Initialization of query '${Nn(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.Q_.push(t),t.G_(n.onlineState),s.q_&&t.z_(s.q_)&&Za(n)}async function Ya(e,t){const n=w(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Q_.indexOf(t);e>=0&&(s.Q_.splice(e,1),0===s.Q_.length?i=t.U_()?0:1:!s.K_()&&t.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Xa(e,t){const n=w(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.Q_)t.z_(e)&&(r=!0);i.q_=e}}r&&Za(n)}function Ja(e,t,n){const r=w(e),i=r.queries.get(t);if(i)for(const e of i.Q_)e.onError(n);r.queries.delete(t)}function Za(e){e.W_.forEach((e=>{e.next()}))}var ec,tc;(tc=ec||(ec={})).j_="default",tc.Cache="cache";class nc{constructor(e,t,n){this.query=e,this.H_=t,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=n||{}}z_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ka(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),t=!0):this.X_(e,this.onlineState)&&(this.ea(e),t=!0),this.Y_=e,t}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let t=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),t=!0),t}X_(e,t){if(!e.fromCache)return!0;if(!this.U_())return!0;const n="Offline"!==t;return(!this.options.ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Z_(e){if(e.docChanges.length>0)return!0;const t=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ea(e){e=Ka.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==ec.Cache}}class rc{constructor(e,t){this.na=e,this.byteLength=t}ra(){return"metadata"in this.na}}class ic{constructor(e){this.serializer=e}Ps(e){return di(this.serializer,e)}Is(e){return e.metadata.exists?vi(this.serializer,e.document,!1):Vt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ai(e)}}class sc{constructor(e,t,n){this.ia=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=oc(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++t;const n=V.fromString(e.na.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}oa(e){const t=new Map,n=new ic(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Ps(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||$n()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=w(e);let s=$n(),o=Un();for(const e of n){const n=t.Ps(e.metadata.name);e.document&&(s=s.add(n));const r=t.Is(e);r.setReadTime(t.Ts(e.metadata.readTime)),o=o.insert(n,r)}const a=i.os.newChangeBuffer({trackRemovals:!0}),c=await Po(i,function(e){return Sn(_n(V.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>No(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.Qr.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.Qr.addMatchingKeys(e,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.cs,t.ls))).next((()=>t.cs))))))}(this.localStore,new ic(this.serializer),this.documents,this.ia.id),t=this.oa(this.documents);for(const e of this.queries)await Vo(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}}}function oc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ac{constructor(e){this.key=e}}class cc{constructor(e){this.key=e}}class uc{constructor(e,t){this.query=e,this.ua=t,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=$n(),this.mutatedKeys=$n(),this.ha=Rn(e),this.Pa=new Ga(this.ha)}get Ia(){return this.ua}Ta(e,t){const n=t?t.Ea:new Ha,r=t?t.Pa:this.Pa;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=On(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.da(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.ha(l,a)>0||c&&this.ha(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Pa:s,Ea:n,Xi:o,mutatedKeys:i}}da(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;const s=e.Ea.k_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(e)-n(t)}(e.type,t.type)||this.ha(e.doc,t.doc))),this.Aa(n),r=null!=r&&r;const o=t&&!r?this.Ra():[],a=0===this.la.size&&this.current&&!r?1:0,c=a!==this.ca;return this.ca=a,0!==s.length||c?{snapshot:new Ka(this.query,e.Pa,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Va:o}:{Va:o}}G_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new Ha,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach((e=>this.ua=this.ua.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ua=this.ua.delete(e))),this.current=e.current)}Ra(){if(!this.current)return[];const e=this.la;this.la=$n(),this.Pa.forEach((e=>{this.ma(e.key)&&(this.la=this.la.add(e.key))}));const t=[];return e.forEach((e=>{this.la.has(e)||t.push(new cc(e))})),this.la.forEach((n=>{e.has(n)||t.push(new ac(n))})),t}fa(e){this.ua=e.hs,this.la=$n();const t=this.Ta(e.documents);return this.applyChanges(t,!0)}ga(){return Ka.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,0===this.ca,this.hasCachedResults)}}class lc{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class hc{constructor(e){this.key=e,this.pa=!1}}class dc{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.ya={},this.wa=new Mn((e=>Dn(e)),kn),this.Sa=new Map,this.ba=new Set,this.Da=new Xe(B.comparator),this.Ca=new Map,this.va=new oo,this.Fa={},this.Ma=new Map,this.xa=Ls.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}async function fc(e,t,n=!0){const r=Bc(e);let i;const s=r.wa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=await mc(r,t,n,!0),i}async function pc(e,t){const n=Bc(e);await mc(n,t,!0,!1)}async function mc(e,t,n,r){const i=await Po(e.localStore,Sn(t)),s=i.targetId,o=n?e.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return r&&(a=await gc(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&ga(e.remoteStore,i),a}async function gc(e,t,n,r,i){e.Na=(t,n,r)=>async function(e,t,n,r){let i=t.view.Ta(n);i.Xi&&(i=await Lo(e.localStore,t.query,!1).then((({documents:e})=>t.view.Ta(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return xc(e,t.targetId,a.Va),a.snapshot}(e,t,n,r);const s=await Lo(e.localStore,t,!0),o=new uc(t,s.hs),a=o.Ta(s.documents),c=Hr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);xc(e,n,u.Va);const l=new lc(t,n,o);return e.wa.set(t,l),e.Sa.has(n)?e.Sa.get(n).push(t):e.Sa.set(n,[t]),u.snapshot}async function yc(e,t,n){const r=w(e),i=r.wa.get(t),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter((e=>!kn(e,t)))),void r.wa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ro(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ya(r.remoteStore,i.targetId),Cc(r,i.targetId)})).catch(ne)):(Cc(r,i.targetId),await Ro(r.localStore,i.targetId,!0))}async function vc(e,t){const n=w(e),r=n.wa.get(t),i=n.Sa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ya(n.remoteStore,r.targetId))}async function wc(e,t){const n=w(e);try{const e=await function(e,t){const n=w(e),r=t.snapshotVersion;let i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(st.EMPTY_BYTE_STRING,F.min()).withLastLimboFreeSnapshotVersion(F.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Qr.updateTargetData(e,u))}));let a=Un(),c=$n();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(No(e,s,t.documentUpdates).next((e=>{a=e.cs,c=e.ls}))),!r.isEqual(F.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next((t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return re.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.ns=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ca.get(t);r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.pa=!0:e.modifiedDocuments.size>0?v(r.pa):e.removedDocuments.size>0&&(v(r.pa),r.pa=!1))})),await Nc(n,e,t)}catch(e){await ne(e)}}function bc(e,t,n){const r=w(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wa.forEach(((n,r)=>{const i=r.view.G_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=w(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.Q_)e.G_(t)&&(r=!0)})),r&&Za(n)}(r.eventManager,t),e.length&&r.ya.u_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function _c(e,t,n){const r=w(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Ca.get(t),s=i&&i.key;if(s){let e=new Xe(B.comparator);e=e.insert(s,Vt.newNoDocument(s,F.min()));const n=$n().add(s),i=new Gr(F.min(),new Map,new Xe(P),e,n);await wc(r,i),r.Da=r.Da.remove(s),r.Ca.delete(t),Dc(r)}else await Ro(r.localStore,t,!1).then((()=>Cc(r,t,n))).catch(ne)}async function Ic(e,t){const n=w(e),r=t.batch.batchId;try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=re.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);v(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=$n();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Sc(n,r,null),Tc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Nc(n,e)}catch(e){await ne(e)}}async function Ec(e,t,n){const r=w(e);try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(v(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Sc(r,t,n),Tc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Nc(r,e)}catch(n){await ne(n)}}function Tc(e,t){(e.Ma.get(t)||[]).forEach((e=>{e.resolve()})),e.Ma.delete(t)}function Sc(e,t,n){const r=w(e);let i=r.Fa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Fa[r.currentUser.toKey()]=i}}function Cc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Sa.get(t))e.wa.delete(r),n&&e.ya.La(r,n);e.Sa.delete(t),e.isPrimaryClient&&e.va.Vr(t).forEach((t=>{e.va.containsKey(t)||Ac(e,t)}))}function Ac(e,t){e.ba.delete(t.path.canonicalString());const n=e.Da.get(t);null!==n&&(ya(e.remoteStore,n),e.Da=e.Da.remove(t),e.Ca.delete(n),Dc(e))}function xc(e,t,n){for(const r of n)r instanceof ac?(e.va.addReference(r.key,t),kc(e,r)):r instanceof cc?(f("SyncEngine","Document no longer in limbo: "+r.key),e.va.removeReference(r.key,t),e.va.containsKey(r.key)||Ac(e,r.key)):y()}function kc(e,t){const n=t.key,r=n.path.canonicalString();e.Da.get(n)||e.ba.has(r)||(f("SyncEngine","New document in limbo: "+n),e.ba.add(r),Dc(e))}function Dc(e){for(;e.ba.size>0&&e.Da.size<e.maxConcurrentLimboResolutions;){const t=e.ba.values().next().value;e.ba.delete(t);const n=new B(V.fromString(t)),r=e.xa.next();e.Ca.set(r,new hc(n)),e.Da=e.Da.insert(n,r),ga(e.remoteStore,new Pi(Sn(_n(n.path)),r,"TargetPurposeLimboResolution",me._e))}}async function Nc(e,t,n){const r=w(e),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach(((e,a)=>{o.push(r.Na(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=To.Ki(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.ya.u_(i),await async function(e,t){const n=w(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>re.forEach(t,(t=>re.forEach(t.qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>re.forEach(t.Qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!ce(e))throw e;f("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ns.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(t,i)}}}(r.localStore,s))}async function Oc(e,t){const n=w(e);if(!n.currentUser.isEqual(t)){f("SyncEngine","User change. New user:",t.toKey());const e=await ko(n.localStore,t);n.currentUser=t,function(e,t){e.Ma.forEach((e=>{e.forEach((e=>{e.reject(new _(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ma.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Nc(n,e.us)}}function Pc(e,t){const n=w(e),r=n.Ca.get(t);if(r&&r.pa)return $n().add(r.key);{let e=$n();const r=n.Sa.get(t);if(!r)return e;for(const t of r){const r=n.wa.get(t);e=e.unionWith(r.view.Ia)}return e}}async function Rc(e,t){const n=w(e),r=await Lo(n.localStore,t.query,!0),i=t.view.fa(r);return n.isPrimaryClient&&xc(n,t.targetId,i.Va),i}async function Lc(e,t){const n=w(e);return Fo(n.localStore,t).then((e=>Nc(n,e)))}async function Mc(e,t,n,r){const i=w(e),s=await function(e,t){const n=w(e),r=w(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.vn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):re.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await ka(i.remoteStore):"acknowledged"===n||"rejected"===n?(Sc(i,t,r||null),Tc(i,t),function(e,t){w(w(e).mutationQueue).Mn(t)}(i.localStore,t)):y(),await Nc(i,s)):f("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Fc(e,t,n){const r=w(e),i=[],s=[];for(const e of t){let t;const n=r.Sa.get(e);if(n&&0!==n.length){t=await Po(r.localStore,Sn(n[0]));for(const e of n){const t=r.wa.get(e),n=await Rc(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await Mo(r.localStore,e);t=await Po(r.localStore,n),await gc(r,Uc(n),e,!1,t.resumeToken)}i.push(t)}return r.ya.u_(s),i}function Uc(e){return bn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Vc(e){return function(e){return w(w(e).persistence).Bi()}(w(e).localStore)}async function jc(e,t,n,r){const i=w(e);if(i.Oa)return void f("SyncEngine","Ignoring unexpected query state notification.");const s=i.Sa.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await Fo(i.localStore,Pn(s[0])),r=Gr.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,st.EMPTY_BYTE_STRING);await Nc(i,e,r);break}case"rejected":await Ro(i.localStore,t,!0),Cc(i,t,r);break;default:y()}}async function qc(e,t,n){const r=Bc(e);if(r.Oa){for(const e of t){if(r.Sa.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){f("SyncEngine","Adding an already active target "+e);continue}const t=await Mo(r.localStore,e),n=await Po(r.localStore,t);await gc(r,Uc(t),n.targetId,!1,n.resumeToken),ga(r.remoteStore,n)}for(const e of n)r.Sa.has(e)&&await Ro(r.localStore,e,!1).then((()=>{ya(r.remoteStore,e),Cc(r,e)})).catch(ne)}}function Bc(e){const t=w(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=wc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Pc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=_c.bind(null,t),t.ya.u_=Xa.bind(null,t.eventManager),t.ya.La=Ja.bind(null,t.eventManager),t}function zc(e){const t=w(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ic.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ec.bind(null,t),t}class Gc{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=oa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return xo(this.persistence,new Co,e.initialUser,this.serializer)}createPersistence(e){return new fo(mo.Hr,this.serializer)}createSharedClientState(e){return new Qo}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Hc extends Gc{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){v(this.persistence.referenceDelegate instanceof go);const n=this.persistence.referenceDelegate.garbageCollector;return new Bs(n,e.asyncQueue,t)}createPersistence(e){const t=void 0!==this.cacheSizeBytes?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new fo((e=>go.Hr(e,t)),this.serializer)}}class Kc extends Gc{constructor(e,t,n){super(),this.ka=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ka.initialize(this,e),await zc(this.ka.syncEngine),await ka(this.ka.remoteStore),await this.persistence.fi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return xo(this.persistence,new Co,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Bs(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new pe(t,this.persistence);return new fe(e.asyncQueue,n)}createPersistence(e){const t=Eo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new bo(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,ia(),sa(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Qo}}class $c extends Kc{constructor(e,t){super(e,t,!1),this.ka=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.ka.syncEngine;this.sharedClientState instanceof Wo&&(this.sharedClientState.syncEngine={Zs:Mc.bind(null,t),Xs:jc.bind(null,t),eo:qc.bind(null,t),Bi:Vc.bind(null,t),Ys:Lc.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi((async e=>{await async function(e,t){const n=w(e);if(Bc(n),zc(n),!0===t&&!0!==n.Oa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Fc(n,e.toArray());n.Oa=!0,await Va(n.remoteStore,!0);for(const e of t)ga(n.remoteStore,e)}else if(!1===t&&!1!==n.Oa){const e=[];let t=Promise.resolve();n.Sa.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(Cc(n,i),Ro(n.localStore,i,!0)))),ya(n.remoteStore,i)})),await t,await Fc(n,e),function(e){const t=w(e);t.Ca.forEach(((e,n)=>{ya(t.remoteStore,n)})),t.va.mr(),t.Ca=new Map,t.Da=new Xe(B.comparator)}(n),n.Oa=!1,await Va(n.remoteStore,!1)}}(this.ka.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=ia();if(!Wo.D(t))throw new _(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Eo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Wo(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Wc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>bc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Oc.bind(null,this.syncEngine),await Va(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Wa}createDatastore(e){const t=oa(e.databaseInfo.databaseId),n=function(e){return new ra(e)}(e.databaseInfo);return function(e,t,n,r){return new ha(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new fa(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>bc(this.syncEngine,e,0)),Xo.D()?new Xo:new Yo)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new dc(e,t,n,r,i,s);return o&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=w(e);f("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await ma(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}function Qc(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Yc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):p("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Xc{constructor(e,t){this.Ka=e,this.serializer=t,this.metadata=new I,this.buffer=new Uint8Array,this.$a=new TextDecoder("utf-8"),this.Ua().then((e=>{e&&e.ra()?this.metadata.resolve(e.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.na)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Ka.cancel()}async getMetadata(){return this.metadata.promise}async Ba(){return await this.getMetadata(),this.Ua()}async Ua(){const e=await this.Wa();if(null===e)return null;const t=this.$a.decode(e),n=Number(t);isNaN(n)&&this.Ga(`length string (${t}) is not valid number`);const r=await this.za(n);return new rc(JSON.parse(r),e.length+n)}ja(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Wa(){for(;this.ja()<0&&!await this.Ha(););if(0===this.buffer.length)return null;const e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async za(e){for(;this.buffer.length<e;)await this.Ha()&&this.Ga("Reached the end of bundle when more is expected.");const t=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ha(){const e=await this.Ka.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Jc{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new _(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=w(e),r={documents:t.map((e=>hi(n.serializer,e)))},i=await n.vo("BatchGetDocuments",n.serializer.databaseId,V.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){v(!!t.found),t.found.name,t.found.updateTime;const n=di(e,t.found.name),r=ai(t.found.updateTime),i=t.found.createTime?ai(t.found.createTime):F.min(),s=new Ft({mapValue:{fields:t.found.fields}});return Vt.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){v(!!t.missing),v(!!t.readTime);const n=di(e,t.missing),r=ai(t.readTime);return Vt.newNoDocument(n,r)}(e,t):y()}(n.serializer,e);s.set(t.key.toString(),t)}));const o=[];return t.forEach((e=>{const t=s.get(e.toString());v(!!t),o.push(t)})),o}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Cr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=B.fromPath(t);this.mutations.push(new Ar(n,this.precondition(n)))})),await async function(e,t){const n=w(e),r={writes:t.map((e=>wi(n.serializer,e)))};await n.So("Commit",n.serializer.databaseId,V.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw y();t=F.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new _(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(F.min())?fr.exists(!1):fr.updateTime(t):fr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(F.min()))throw new _(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fr.updateTime(t)}return fr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Zc{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Ja=n.maxAttempts,this.jo=new aa(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo((async()=>{const e=new Jc(this.datastore),t=this.Xa(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.eu(e)}))))})).catch((e=>{this.eu(e)}))}))}Xa(e){try{const t=this.updateFunction(e);return!ge(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget((()=>(this.Za(),Promise.resolve())))):this.deferred.reject(e)}tu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Lr(t)}return!1}}class eu{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=u.UNAUTHENTICATED,this.clientId=O.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{f("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(f("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new I;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=za(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function tu(e,t){e.asyncQueue.verifyOperationInProgress(),f("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await ko(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function nu(e,t){e.asyncQueue.verifyOperationInProgress();const n=await iu(e);f("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Ua(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ua(t.remoteStore,n))),e._onlineComponents=t}function ru(e){return"FirebaseError"===e.name?e.code===b.FAILED_PRECONDITION||e.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function iu(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){f("FirestoreClient","Using user provided OfflineComponentProvider");try{await tu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!ru(n))throw n;m("Error using user provided cache. Falling back to memory cache: "+n),await tu(e,new Gc)}}else f("FirestoreClient","Using default OfflineComponentProvider"),await tu(e,new Gc);return e._offlineComponents}async function su(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(f("FirestoreClient","Using user provided OnlineComponentProvider"),await nu(e,e._uninitializedComponentsProvider._online)):(f("FirestoreClient","Using default OnlineComponentProvider"),await nu(e,new Wc))),e._onlineComponents}function ou(e){return iu(e).then((e=>e.persistence))}function au(e){return iu(e).then((e=>e.localStore))}function cu(e){return su(e).then((e=>e.remoteStore))}function uu(e){return su(e).then((e=>e.syncEngine))}function lu(e){return su(e).then((e=>e.datastore))}async function hu(e){const t=await su(e),n=t.eventManager;return n.onListen=fc.bind(null,t.syncEngine),n.onUnlisten=yc.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=pc.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=vc.bind(null,t.syncEngine),n}function du(e,t,n={}){const r=new I;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Yc({next:s=>{t.enqueueAndForget((()=>Ya(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new _(b.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new _(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new nc(_n(n.path),s,{includeMetadataChanges:!0,ta:!0});return Qa(e,o)}(await hu(e),e.asyncQueue,t,n,r))),r.promise}function fu(e,t,n={}){const r=new I;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Yc({next:n=>{t.enqueueAndForget((()=>Ya(e,o))),n.fromCache&&"server"===r.source?i.reject(new _(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new nc(n,s,{includeMetadataChanges:!0,ta:!0});return Qa(e,o)}(await hu(e),e.asyncQueue,t,n,r))),r.promise}function pu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const mu=new Map;function gu(e,t,n){if(!n)throw new _(b.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function yu(e,t,n,r){if(!0===t&&!0===r)throw new _(b.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function vu(e){if(!B.isDocumentKey(e))throw new _(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function wu(e){if(B.isDocumentKey(e))throw new _(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function bu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":y()}function _u(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bu(e);throw new _(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Iu(e,t){if(t<=0)throw new _(b.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Eu{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new _(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new _(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yu("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pu(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Eu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new _(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new _(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Eu(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new T;switch(e.type){case"firstParty":return new x(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new _(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=mu.get(e);t&&(f("ComponentProvider","Removing Datastore"),mu.delete(e),t.terminate())}(this),Promise.resolve()}}function Su(e,t,n,r={}){var i;const s=(e=_u(e,Tu))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&m("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=u.MOCK_USER;else{t=o.createMockUserToken(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new _(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new u(s)}e._authCredentials=new S(new E(t,n))}}class Cu{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cu(this.firestore,e,this._query)}}class Au{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Au(this.firestore,e,this._key)}}class xu extends Cu{constructor(e,t,n){super(e,t,_n(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Au(this.firestore,null,new B(e))}withConverter(e){return new xu(this.firestore,e,this._path)}}function ku(e,t,...n){if(e=o.getModularInstance(e),1===arguments.length&&(t=O.newId()),gu("doc","path",t),e instanceof Tu){const r=V.fromString(t,...n);return vu(r),new Au(e,null,new B(r))}{if(!(e instanceof Au||e instanceof xu))throw new _(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(V.fromString(t,...n));return vu(r),new Au(e.firestore,e instanceof xu?e.converter:null,new B(r))}}function Du(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),e instanceof Cu&&t instanceof Cu&&e.firestore===t.firestore&&kn(e._query,t._query)&&e.converter===t.converter}class Nu{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new aa(this,"async_queue_retry"),this.cu=()=>{const e=sa();e&&f("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const e=sa();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;const t=sa();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise((()=>{}));const t=new I;return this.hu((()=>this.iu&&this.au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.ru.push(e),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!ce(e))throw e;f("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(e){const t=this.nu.then((()=>(this._u=!0,e().catch((e=>{this.ou=e,this._u=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw p("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this._u=!1,e))))));return this.nu=t,t}enqueueAfterDelay(e,t,n){this.lu(),this.uu.indexOf(e)>-1&&(t=0);const r=Ba.createAndSchedule(this,e,t,n,(e=>this.Iu(e)));return this.su.push(r),r}lu(){this.ou&&y()}verifyOperationInProgress(){}async Tu(){let e;do{e=this.nu,await e}while(e!==this.nu)}Eu(e){for(const t of this.su)if(t.timerId===e)return!0;return!1}du(e){return this.Tu().then((()=>{this.su.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.su)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tu()}))}Au(e){this.uu.push(e)}Iu(e){const t=this.su.indexOf(e);this.su.splice(t,1)}}function Ou(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Pu{constructor(){this._progressObserver={},this._taskCompletionResolver=new I,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Ru extends Tu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Nu,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Mu(this),this._firestoreClient.terminate()}}function Lu(e){return e._firestoreClient||Mu(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Mu(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new ft(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,pu(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new eu(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Fu(e,t,n){const r=new I;return e.asyncQueue.enqueue((async()=>{try{await tu(e,n),await nu(e,t),r.resolve()}catch(e){const t=e;if(!ru(t))throw t;m("Error enabling indexeddb cache. Falling back to memory cache: "+t),r.reject(t)}})).then((()=>r.promise))}function Uu(e){if(e._initialized||e._terminated)throw new _(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Vu{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class ju{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class qu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qu(st.fromBase64String(e))}catch(e){throw new _(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new qu(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Bu{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new _(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new q(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zu{constructor(e){this._methodName=e}}class Gu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return P(this._lat,e._lat)||P(this._long,e._long)}}const Hu=/^__.*__$/;class Ku{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ir(e,this.data,this.fieldMask,t,this.fieldTransforms):new _r(e,this.data,t,this.fieldTransforms)}}class $u{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ir(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Wu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}class Qu{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ru(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new Qu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.pu(e),r}yu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.Ru(),r}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return ml(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(0===e.length)throw this.Su("Document fields must not be empty");if(Wu(this.Vu)&&Hu.test(e))throw this.Su('Document fields cannot begin and end with "__"')}}class Yu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||oa(e)}Cu(e,t,n,r=!1){return new Qu({Vu:e,methodName:t,Du:n,path:q.emptyPath(),gu:!1,bu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(e){const t=e._freezeSettings(),n=oa(e._databaseId);return new Yu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ju(e,t,n,r,i,s={}){const o=e.Cu(s.merge||s.mergeFields?2:0,t,n,i);hl("Data must be an object, but it was:",o,r);const a=ul(r,o);let c,u;if(s.merge)c=new rt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=dl(t,r,n);if(!o.contains(i))throw new _(b.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);gl(e,i)||e.push(i)}c=new rt(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Ku(new Ft(a),c,u)}class Zu extends zu{_toFieldTransform(e){if(2!==e.Vu)throw 1===e.Vu?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zu}}function el(e,t,n){return new Qu({Vu:3,Du:t.settings.Du,methodName:e._methodName,gu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class tl extends zu{_toFieldTransform(e){return new hr(e.path,new rr)}isEqual(e){return e instanceof tl}}class nl extends zu{constructor(e,t){super(e),this.vu=t}_toFieldTransform(e){const t=el(this,e,!0),n=this.vu.map((e=>cl(e,t))),r=new ir(n);return new hr(e.path,r)}isEqual(e){return e instanceof nl&&o.deepEqual(this.vu,e.vu)}}class rl extends zu{constructor(e,t){super(e),this.vu=t}_toFieldTransform(e){const t=el(this,e,!0),n=this.vu.map((e=>cl(e,t))),r=new or(n);return new hr(e.path,r)}isEqual(e){return e instanceof rl&&o.deepEqual(this.vu,e.vu)}}class il extends zu{constructor(e,t){super(e),this.Fu=t}_toFieldTransform(e){const t=new cr(e.serializer,Jn(e.serializer,this.Fu));return new hr(e.path,t)}isEqual(e){return e instanceof il&&this.Fu===e.Fu}}function sl(e,t,n,r){const i=e.Cu(1,t,n);hl("Data must be an object, but it was:",i,r);const s=[],a=Ft.empty();Qe(r,((e,r)=>{const c=pl(t,e,n);r=o.getModularInstance(r);const u=i.yu(c);if(r instanceof Zu)s.push(c);else{const e=cl(r,u);null!=e&&(s.push(c),a.set(c,e))}}));const c=new rt(s);return new $u(a,c,i.fieldTransforms)}function ol(e,t,n,r,i,s){const a=e.Cu(1,t,n),c=[dl(t,r,n)],u=[i];if(s.length%2!=0)throw new _(b.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)c.push(dl(t,s[e])),u.push(s[e+1]);const l=[],h=Ft.empty();for(let e=c.length-1;e>=0;--e)if(!gl(l,c[e])){const t=c[e];let n=u[e];n=o.getModularInstance(n);const r=a.yu(t);if(n instanceof Zu)l.push(t);else{const e=cl(n,r);null!=e&&(l.push(t),h.set(t,e))}}const d=new rt(l);return new $u(h,d,a.fieldTransforms)}function al(e,t,n,r=!1){return cl(n,e.Cu(r?4:3,t))}function cl(e,t){if(ll(e=o.getModularInstance(e)))return hl("Unsupported field value:",t,e),ul(e,t);if(e instanceof zu)return function(e,t){if(!Wu(t.Vu))throw t.Su(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Su(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.gu&&4!==t.Vu)throw t.Su("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=cl(i,t.wu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=o.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Jn(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=M.fromDate(e);return{timestampValue:ii(t.serializer,n)}}if(e instanceof M){const n=new M(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ii(t.serializer,n)}}if(e instanceof Gu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof qu)return{bytesValue:si(t.serializer,e._byteString)};if(e instanceof Au){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Su(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ci(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Su(`Unsupported field value: ${bu(e)}`)}(e,t)}function ul(e,t){const n={};return Ye(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qe(e,((e,r)=>{const i=cl(r,t.fu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function ll(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof M||e instanceof Gu||e instanceof qu||e instanceof Au||e instanceof zu)}function hl(e,t,n){if(!ll(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=bu(n);throw"an object"===r?t.Su(e+" a custom object"):t.Su(e+" "+r)}}function dl(e,t,n){if((t=o.getModularInstance(t))instanceof Bu)return t._internalPath;if("string"==typeof t)return pl(e,t);throw ml("Field path arguments must be of type string or ",e,!1,void 0,n)}const fl=new RegExp("[~\\*/\\[\\]]");function pl(e,t,n){if(t.search(fl)>=0)throw ml(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Bu(...t.split("."))._internalPath}catch(r){throw ml(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ml(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new _(b.INVALID_ARGUMENT,a+e+c)}function gl(e,t){return e.some((e=>e.isEqual(t)))}class yl{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Au(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new vl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(wl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class vl extends yl{data(){return super.data()}}function wl(e,t){return"string"==typeof t?pl(e,t):t instanceof Bu?t._internalPath:t._delegate._internalPath}function bl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new _(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _l{}class Il extends _l{}class El extends Il{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new El(e,t,n)}_apply(e){const t=this._parse(e);return Ol(e._query,t),new Cu(e.firestore,e.converter,An(e._query,t))}_parse(e){const t=Xu(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new _(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Nl(o,s);const t=[];for(const n of o)t.push(Dl(r,e,n));a={arrayValue:{values:t}}}else a=Dl(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Nl(o,s),a=al(n,"where",o,"in"===s||"not-in"===s);return Kt.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Tl extends _l{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Tl(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:$t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Ol(n,e),n=An(n,e)}(e._query,t),new Cu(e.firestore,e.converter,An(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Sl extends Il{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Sl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new _(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new _(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zt(t,n)}(e._query,this._field,this._direction);return new Cu(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new wn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Cl extends Il{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Cl(e,t,n)}_apply(e){return new Cu(e.firestore,e.converter,xn(e._query,this._limit,this._limitType))}}class Al extends Il{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Al(e,t,n)}_apply(e){const t=kl(e,this.type,this._docOrFields,this._inclusive);return new Cu(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class xl extends Il{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new xl(e,t,n)}_apply(e){const t=kl(e,this.type,this._docOrFields,this._inclusive);return new Cu(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function kl(e,t,n,r){if(n[0]=o.getModularInstance(n[0]),n[0]instanceof yl)return function(e,t,n,r,i){if(!r)throw new _(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of Tn(e))if(n.field.isKeyField())s.push(St(t,r.key));else{const e=r.data.field(n.field);if(lt(e))throw new _(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new _(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new jt(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Xu(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new _(b.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new _(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!En(e)&&-1!==c.indexOf("/"))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(V.fromString(c));if(!B.isDocumentKey(n))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new B(n);a.push(St(t,i))}else{const e=al(n,r,c);a.push(e)}}return new jt(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Dl(e,t,n){if("string"==typeof(n=o.getModularInstance(n))){if(""===n)throw new _(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!En(t)&&-1!==n.indexOf("/"))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(V.fromString(n));if(!B.isDocumentKey(r))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return St(e,new B(r))}if(n instanceof Au)return St(e,n._key);throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bu(n)}.`)}function Nl(e,t){if(!Array.isArray(e)||0===e.length)throw new _(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Ol(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new _(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new _(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Pl(e,t){if(!(t instanceof El||t instanceof Tl))throw new _(b.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Rl{convertValue(e,t="none"){switch(yt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ut(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Qe(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Gu(ct(e.latitude),ct(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ht(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(dt(e));default:return null}}convertTimestamp(e){const t=at(e);return new M(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=V.fromString(e);v(Oi(n));const r=new pt(n.get(1),n.get(3)),i=new B(n.popFirst(5));return r.isEqual(t)||p(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Ll(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Ml extends Rl{constructor(e){super(),this.firestore=e}convertBytes(e){return new qu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Au(this.firestore,null,t)}}function Fl(){return new Vu("count")}class Ul{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vl extends yl{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new jl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(wl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class jl extends Vl{data(e={}){return super.data(e)}}class ql{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ul(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new jl(this._firestore,this._userDataWriter,n.key,n,new Ul(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new jl(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ul(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new jl(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ul(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Bl(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Bl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}class zl extends Rl{constructor(e){super(),this.firestore=e}convertBytes(e){return new qu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Au(this.firestore,null,t)}}function Gl(e,t){return function(e,t){const n=new I;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=zc(e);try{const e=await function(e,t){const n=w(e),r=M.now(),i=t.reduce(((e,t)=>e.add(t.key)),$n());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Un(),c=$n();return n.os.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=wr(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Ir(e.key,t,Ut(t.value.mapValue),fr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:qn(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Fa[e.currentUser.toKey()];r||(r=new Xe(P)),r=r.insert(t,n),e.Fa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Nc(r,e.changes),await ka(r.remoteStore)}catch(e){const t=za(e,"Failed to persist write");n.reject(t)}}(await uu(e),t,n))),n.promise}(Lu(e),t)}function Hl(e,t,n){const r=n.docs.get(t._key),i=new zl(e);return new Vl(e,i,t._key,r,new Ul(n.hasPendingWrites,n.fromCache),t.converter)}function Kl(e,t){const n=_u(e.firestore,Ru),r=Lu(n),i=function(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r));return n}(t,((e,t)=>new Nr(t,e.aggregateType,e._internalFieldPath)));return function(e,t,n){const r=new I;return e.asyncQueue.enqueueAndForget((async()=>{try{const i=await lu(e);r.resolve(async function(e,t,n){var r;const i=w(e),{request:s,V_:o,parent:a}=function(e,t,n){const{ut:r,parent:i}=Ii(e,t),s={},o=[];let a=0;return n.forEach((e=>{const t="aggregate_"+a++;s[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:xi(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:xi(e.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:r.structuredQuery},parent:r.parent},V_:s,parent:i}}(i.serializer,function(e){const t=w(e);return t.Pe||(t.Pe=Cn(t,e.explicitOrderBy)),t.Pe}(t),n);i.connection.wo||delete s.parent;const c=(await i.vo("RunAggregationQuery",i.serializer.databaseId,a,s,1)).filter((e=>!!e.result));v(1===c.length);const u=null===(r=c[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(u).reduce(((e,t)=>(e[o[t]]=u[t],e)),{})}(i,t,n))}catch(e){r.reject(e)}})),r.promise}(r,e._query,i).then((t=>function(e,t,n){const r=new zl(e);return new ju(t,r,n)}(n,e,t)))}class $l{constructor(e){this.kind="memory",this._onlineComponentProvider=new Wc,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new Gc}toJSON(){return{kind:this.kind}}}class Wl{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=Zl(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Ql{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new Gc}toJSON(){return{kind:this.kind}}}class Yl{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new Hc(e)}toJSON(){return{kind:this.kind}}}class Xl{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Wc,this._offlineComponentProvider=new Kc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}class Jl{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Wc,this._offlineComponentProvider=new $c(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}function Zl(e){return new Xl(null==e?void 0:e.forceOwnership)}const eh={maxAttempts:5};class th{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,t,n){this._verifyNotCommitted();const r=nh(e,this._firestore),i=Ll(r.converter,t,n),s=Ju(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,fr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=nh(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Bu?ol(this._dataReader,"WriteBatch.update",i._key,t,n,r):sl(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,fr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=nh(e,this._firestore);return this._mutations=this._mutations.concat(new Cr(t._key,fr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nh(e,t){if((e=o.getModularInstance(e)).firestore!==t)throw new _(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class rh extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Xu(e)}get(e){const t=nh(e,this._firestore),n=new Ml(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return y();const r=e[0];if(r.isFoundDocument())return new yl(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new yl(this._firestore,n,t._key,null,t.converter);throw y()}))}set(e,t,n){const r=nh(e,this._firestore),i=Ll(r.converter,t,n),s=Ju(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=nh(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Bu?ol(this._dataReader,"Transaction.update",i._key,t,n,r):sl(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=nh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=nh(e,this._firestore),n=new zl(this._firestore);return super.get(e).then((e=>new Vl(this._firestore,n,t._key,e._document,new Ul(!1,!1),t.converter)))}}function ih(e,t){if("string"!=typeof e[t])throw new _(b.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class sh{constructor(e){this._client=e,this.type="PersistentCacheIndexManager"}}function oh(e,t){e._client.verifyNotTerminated(),function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){w(e).ts.Ui=t}(await au(e),t)))}(e._client,t).then((e=>f(`setting persistent cache index auto creation isEnabled=${t} succeeded`))).catch((e=>m(`setting persistent cache index auto creation isEnabled=${t} failed`,e)))}const ah=new WeakMap;class ch{constructor(){this.Mu=new Map}static get instance(){return uh||(uh=new ch,function(e){if(Fr)throw new Error("a TestingHooksSpi instance is already set");Fr=e}(uh)),uh}tt(e){this.Mu.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Mu;return n.set(t,e),()=>n.delete(t)}}let uh=null;!function(e,t=!0){!function(e){l=e}(r.SDK_VERSION),r._registerComponent(new i.Component("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new Ru(new C(e.getProvider("auth-internal")),new D(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new _(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pt(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),r.registerVersion(c,"4.5.0",e),r.registerVersion(c,"4.5.0","cjs2017")}(),t.AbstractUserDataWriter=Rl,t.AggregateField=Vu,t.AggregateQuerySnapshot=ju,t.Bytes=qu,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=xu,t.DocumentReference=Au,t.DocumentSnapshot=Vl,t.FieldPath=Bu,t.FieldValue=zu,t.Firestore=Ru,t.FirestoreError=_,t.GeoPoint=Gu,t.LoadBundleTask=Pu,t.PersistentCacheIndexManager=sh,t.Query=Cu,t.QueryCompositeFilterConstraint=Tl,t.QueryConstraint=Il,t.QueryDocumentSnapshot=jl,t.QueryEndAtConstraint=xl,t.QueryFieldFilterConstraint=El,t.QueryLimitConstraint=Cl,t.QueryOrderByConstraint=Sl,t.QuerySnapshot=ql,t.QueryStartAtConstraint=Al,t.SnapshotMetadata=Ul,t.Timestamp=M,t.Transaction=rh,t.WriteBatch=th,t._AutoId=O,t._ByteString=st,t._DatabaseId=pt,t._DocumentKey=B,t._EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new k(""))}invalidateToken(){}start(e,t){}shutdown(){}},t._EmptyAuthCredentialsProvider=T,t._FieldPath=q,t._TestingHooks=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return ch.instance.onExistenceFilterMismatch(e)}},t._cast=_u,t._debugAssert=function(e,t){e||y()},t._isBase64Available=function(){return"undefined"!=typeof atob},t._logWarn=m,t._validateIsNotUsedTogether=yu,t.addDoc=function(e,t){const n=_u(e.firestore,Ru),r=ku(e),i=Ll(e.converter,t);return Gl(n,[Ju(Xu(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,fr.exists(!1))]).then((()=>r))},t.aggregateFieldEqual=function(e,t){var n,r;return e instanceof Vu&&t instanceof Vu&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())},t.aggregateQuerySnapshotEqual=function(e,t){return Du(e.query,t.query)&&o.deepEqual(e.data(),t.data())},t.and=function(...e){return e.forEach((e=>Pl("and",e))),Tl._create("and",e)},t.arrayRemove=function(...e){return new rl("arrayRemove",e)},t.arrayUnion=function(...e){return new nl("arrayUnion",e)},t.average=function(e){return new Vu("avg",dl("average",e))},t.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new _(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new I;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!se.D())return Promise.resolve();const t=e+"main";await se.delete(t)}(Eo(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise},t.collection=function(e,t,...n){if(e=o.getModularInstance(e),gu("collection","path",t),e instanceof Tu){const r=V.fromString(t,...n);return wu(r),new xu(e,null,r)}{if(!(e instanceof Au||e instanceof xu))throw new _(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(V.fromString(t,...n));return wu(r),new xu(e.firestore,null,r)}},t.collectionGroup=function(e,t){if(e=_u(e,Tu),gu("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new _(b.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Cu(e,null,function(e){return new wn(V.emptyPath(),e)}(t))},t.connectFirestoreEmulator=Su,t.count=Fl,t.deleteAllPersistentCacheIndexes=function(e){e._client.verifyNotTerminated(),function(e){return e.asyncQueue.enqueue((async()=>function(e){const t=w(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",(e=>n.deleteAllFieldIndexes(e)))}(await au(e))))}(e._client).then((e=>f("deleting all persistent cache indexes succeeded"))).catch((e=>m("deleting all persistent cache indexes failed",e)))},t.deleteDoc=function(e){return Gl(_u(e.firestore,Ru),[new Cr(e._key,fr.none())])},t.deleteField=function(){return new Zu("deleteField")},t.disableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await ou(e),n=await cu(e);return t.setNetworkEnabled(!1),async function(e){const t=w(e);t.v_.add(0),await ma(t),t.x_.set("Offline")}(n)}))}(Lu(e=_u(e,Ru)))},t.disablePersistentCacheIndexAutoCreation=function(e){oh(e,!1)},t.doc=ku,t.documentId=function(){return new Bu("__name__")},t.enableIndexedDbPersistence=function(e,t){Uu(e=_u(e,Ru));const n=Lu(e);if(n._uninitializedComponentsProvider)throw new _(b.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new Wc;return Fu(n,i,new Kc(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))},t.enableMultiTabIndexedDbPersistence=function(e){Uu(e=_u(e,Ru));const t=Lu(e);if(t._uninitializedComponentsProvider)throw new _(b.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new Wc;return Fu(t,r,new $c(r,n.cacheSizeBytes))},t.enableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await ou(e),n=await cu(e);return t.setNetworkEnabled(!0),function(e){const t=w(e);return t.v_.delete(0),pa(t)}(n)}))}(Lu(e=_u(e,Ru)))},t.enablePersistentCacheIndexAutoCreation=function(e){oh(e,!0)},t.endAt=function(...e){return xl._create("endAt",e,!0)},t.endBefore=function(...e){return xl._create("endBefore",e,!1)},t.ensureFirestoreConfigured=Lu,t.executeWrite=Gl,t.getAggregateFromServer=Kl,t.getCountFromServer=function(e){return Kl(e,{count:Fl()})},t.getDoc=function(e){e=_u(e,Au);const t=_u(e.firestore,Ru);return du(Lu(t),e._key).then((n=>Hl(t,e,n)))},t.getDocFromCache=function(e){e=_u(e,Au);const t=_u(e.firestore,Ru),n=Lu(t),r=new zl(t);return function(e,t){const n=new I;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=w(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new _(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=za(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await au(e),t,n))),n.promise}(n,e._key).then((n=>new Vl(t,r,e._key,n,new Ul(null!==n&&n.hasLocalMutations,!0),e.converter)))},t.getDocFromServer=function(e){e=_u(e,Au);const t=_u(e.firestore,Ru);return du(Lu(t),e._key,{source:"server"}).then((n=>Hl(t,e,n)))},t.getDocs=function(e){e=_u(e,Cu);const t=_u(e.firestore,Ru),n=Lu(t),r=new zl(t);return bl(e._query),fu(n,e._query).then((n=>new ql(t,r,e,n)))},t.getDocsFromCache=function(e){e=_u(e,Cu);const t=_u(e.firestore,Ru),n=Lu(t),r=new zl(t);return function(e,t){const n=new I;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Lo(e,t,!0),i=new uc(t,r.hs),s=i.Ta(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=za(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await au(e),t,n))),n.promise}(n,e._query).then((n=>new ql(t,r,e,n)))},t.getDocsFromServer=function(e){e=_u(e,Cu);const t=_u(e.firestore,Ru),n=Lu(t),r=new zl(t);return fu(n,e._query,{source:"server"}).then((n=>new ql(t,r,e,n)))},t.getFirestore=function(e,t){const n="object"==typeof e?e:r.getApp(),i="string"==typeof e?e:t||"(default)",s=r._getProvider(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const e=o.getDefaultEmulatorHostnameAndPort("firestore");e&&Su(s,...e)}return s},t.getPersistentCacheIndexManager=function(e){var t;e=_u(e,Ru);const n=ah.get(e);if(n)return n;const r=Lu(e);if("persistent"!==(null===(t=r._uninitializedComponentsProvider)||void 0===t?void 0:t._offlineKind))return null;const i=new sh(r);return ah.set(e,i),i},t.increment=function(e){return new il("increment",e)},t.initializeFirestore=function(e,t,n){n||(n="(default)");const i=r._getProvider(e,"firestore");if(i.isInitialized(n)){const e=i.getImmediate({identifier:n}),r=i.getOptions(n);if(o.deepEqual(r,t))return e;throw new _(b.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new _(b.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new _(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:t,instanceIdentifier:n})},t.limit=function(e){return Iu("limit",e),Cl._create("limit",e,"F")},t.limitToLast=function(e){return Iu("limitToLast",e),Cl._create("limitToLast",e,"L")},t.loadBundle=function(e,t){const n=Lu(e=_u(e,Ru)),r=new Pu;return function(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Ur().encode(e):e,function(e,t){return new Xc(e,t)}(function(e,t){if(e instanceof Uint8Array)return Qc(e,t);if(e instanceof ArrayBuffer)return Qc(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,oa(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=w(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=w(e),r=ai(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.$r.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(oc(r));const i=new sc(r,e.localStore,t.serializer);let s=await t.Ba();for(;s;){const e=await i.sa(s);e&&n._updateProgress(e),s=await t.Ba()}const o=await i.complete();return await Nc(e,o.aa,void 0),await function(e,t){const n=w(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.$r.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o._a)}catch(e){return m("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await uu(e),i,r)}))}(n,e._databaseId,t,r),r},t.memoryEagerGarbageCollector=function(){return new Ql},t.memoryLocalCache=function(e){return new $l(e)},t.memoryLruGarbageCollector=function(e){return new Yl(null==e?void 0:e.cacheSizeBytes)},t.namedQuery=function(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=w(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.$r.getNamedQuery(e,t)))}(await au(e),t)))}(Lu(e=_u(e,Ru)),t).then((t=>t?new Cu(e,null,t.query):null))},t.onSnapshot=function(e,...t){var n,r,i;e=o.getModularInstance(e);let s={includeMetadataChanges:!1,source:"default"},a=0;"object"!=typeof t[a]||Ou(t[a])||(s=t[a],a++);const c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Ou(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,l,h;if(e instanceof Au)l=_u(e.firestore,Ru),h=_n(e._key.path),u={next:n=>{t[a]&&t[a](Hl(l,e,n))},error:t[a+1],complete:t[a+2]};else{const n=_u(e,Cu);l=_u(n.firestore,Ru),h=n._query;const r=new zl(l);u={next:e=>{t[a]&&t[a](new ql(l,r,n,e))},error:t[a+1],complete:t[a+2]},bl(e._query)}return function(e,t,n,r){const i=new Yc(r),s=new nc(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Qa(await hu(e),s))),()=>{i.Qa(),e.asyncQueue.enqueueAndForget((async()=>Ya(await hu(e),s)))}}(Lu(l),h,c,u)},t.onSnapshotsInSync=function(e,t){return function(e,t){const n=new Yc(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).W_.add(t),t.next()}(await hu(e),n))),()=>{n.Qa(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).W_.delete(t)}(await hu(e),n)))}}(Lu(e=_u(e,Ru)),Ou(t)?t:{next:t})},t.or=function(...e){return e.forEach((e=>Pl("or",e))),Tl._create("or",e)},t.orderBy=function(e,t="asc"){const n=t,r=wl("orderBy",e);return Sl._create(r,n)},t.persistentLocalCache=function(e){return new Wl(e)},t.persistentMultipleTabManager=function(){return new Jl},t.persistentSingleTabManager=Zl,t.query=function(e,t,...n){let r=[];t instanceof _l&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof Tl)).length,n=e.filter((e=>e instanceof El)).length;if(t>1||t>0&&n>0)throw new _(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e},t.queryEqual=Du,t.refEqual=function(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),(e instanceof Au||e instanceof xu)&&(t instanceof Au||t instanceof xu)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},t.runTransaction=function(e,t,n){e=_u(e,Ru);const r=Object.assign(Object.assign({},eh),n);return function(e){if(e.maxAttempts<1)throw new _(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new I;return e.asyncQueue.enqueueAndForget((async()=>{const i=await lu(e);new Zc(e.asyncQueue,i,n,t,r).Ya()})),r.promise}(Lu(e),(n=>t(new rh(e,n))),r)},t.serverTimestamp=function(){return new tl("serverTimestamp")},t.setDoc=function(e,t,n){e=_u(e,Au);const r=_u(e.firestore,Ru),i=Ll(e.converter,t,n);return Gl(r,[Ju(Xu(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,fr.none())])},t.setIndexConfiguration=function(e,t){var n;const r=Lu(e=_u(e,Ru));if(!r._uninitializedComponentsProvider||"memory"===(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind))return m("Cannot enable indexes when persistence is disabled"),Promise.resolve();const i=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new _(b.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const e of t.indexes){const t=ih(e,"collectionGroup"),r=[];if(Array.isArray(e.fields))for(const t of e.fields){const e=pl("setIndexConfiguration",ih(t,"fieldPath"));"CONTAINS"===t.arrayConfig?r.push(new $(e,2)):"ASCENDING"===t.order?r.push(new $(e,0)):"DESCENDING"===t.order&&r.push(new $(e,1))}n.push(new z(z.UNKNOWN_ID,t,r,Q.empty()))}return n}(t);return function(e,t){return e.asyncQueue.enqueue((async()=>async function(e,t){const n=w(e),r=n.indexManager,i=[];return n.persistence.runTransaction("Configure indexes","readwrite",(e=>r.getFieldIndexes(e).next((n=>function(e,t,n,r,i){e=[...e],t=[...t],e.sort(n),t.sort(n);const s=e.length,o=t.length;let a=0,c=0;for(;a<o&&c<s;){const s=n(e[c],t[a]);s<0?i(e[c++]):s>0?r(t[a++]):(a++,c++)}for(;a<o;)r(t[a++]);for(;c<s;)i(e[c++])}(n,t,K,(t=>{i.push(r.addFieldIndex(e,t))}),(t=>{i.push(r.deleteFieldIndex(e,t))})))).next((()=>re.waitFor(i)))))}(await au(e),t)))}(r,i)},t.setLogLevel=function(e){h.setLogLevel(e)},t.snapshotEqual=function(e,t){return e instanceof Vl&&t instanceof Vl?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof ql&&t instanceof ql&&e._firestore===t._firestore&&Du(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},t.startAfter=function(...e){return Al._create("startAfter",e,!1)},t.startAt=function(...e){return Al._create("startAt",e,!0)},t.sum=function(e){return new Vu("sum",dl("sum",e))},t.terminate=function(e){return r._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},t.updateDoc=function(e,t,n,...r){e=_u(e,Au);const i=_u(e.firestore,Ru),s=Xu(i);let a;return a="string"==typeof(t=o.getModularInstance(t))||t instanceof Bu?ol(s,"updateDoc",e._key,t,n,r):sl(s,"updateDoc",e._key,t),Gl(i,[a.toMutation(e._key,fr.exists(!0))])},t.waitForPendingWrites=function(e){return function(e){const t=new I;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=w(e);Ia(n.remoteStore)||f("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=w(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Ma.get(e)||[];r.push(t),n.Ma.set(e,r)}catch(e){const n=za(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await uu(e),t))),t.promise}(Lu(e=_u(e,Ru)))},t.where=function(e,t,n){const r=t,i=wl("where",e);return El._create(i,r,n)},t.writeBatch=function(e){return Lu(e=_u(e,Ru)),new th(e,(t=>Gl(e,t)))}},5844:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(1635),o=[];t.LogLevel=void 0,(i=t.LogLevel||(t.LogLevel={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var a={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},c=t.LogLevel.INFO,u=((r={})[t.LogLevel.DEBUG]="log",r[t.LogLevel.VERBOSE]="log",r[t.LogLevel.INFO]="info",r[t.LogLevel.WARN]="warn",r[t.LogLevel.ERROR]="error",r),l=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=u[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));console[o].apply(console,s.__spreadArray(["[".concat(i,"]  ").concat(e.name,":")],n,!1))}},h=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1))},e}();t.Logger=h,t.setLogLevel=function(e){o.forEach((function(t){t.setLogLevel(e)}))},t.setUserLogHandler=function(e,n){for(var r=function(r){var i=null;n&&n.level&&(i=a[n.level]),r.userLogHandler=null===e?null:function(n,r){for(var s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];var a=s.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");r>=(null!=i?i:n.logLevel)&&e({level:t.LogLevel[r].toLowerCase(),message:a,args:s,type:n.name})}},i=0,s=o;i<s.length;i++)r(s[i])}},6336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new c;const u=i<<2|s>>4;if(r.push(u),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=o(e);return a.encodeByteArray(t,!0)},l=function(e){return u(e).replace(/\./g,"")},h=function(e){try{return a.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=d(e[n],t[n]));return e}function f(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const p=()=>{try{return f().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},m=e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){var e;const t=null===(e=p())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}class w extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(_,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new w(r,o,n)}}const _=/\{\$([^}]+)}/g;function I(e){return JSON.parse(e)}const E=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=I(h(s[0])||""),n=I(h(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function T(e){return null!==e&&"object"==typeof e}class S{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=C),void 0===r.error&&(r.error=C),void 0===r.complete&&(r.complete=C);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function C(){}function A(e,t){return`${e} failed: ${t} argument `}const x=144e5;t.CONSTANTS=r,t.DecodeBase64StringError=c,t.Deferred=g,t.ErrorFactory=b,t.FirebaseError=w,t.MAX_VALUE_MILLIS=x,t.RANDOM_FACTOR=.5,t.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+u+i+n[e]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}},t.areCookiesEnabled=function(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)},t.assert=i,t.assertionError=s,t.async=function(e,t){return(...n)=>{Promise.resolve(!0).then((()=>{e(...n)})).catch((e=>{t&&t(e)}))}},t.base64=a,t.base64Decode=h,t.base64Encode=u,t.base64urlEncodeWithoutPadding=l,t.calculateBackoffMillis=function(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(x,r+i)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createMockUserToken=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")},t.createSubscribe=function(e,t){const n=new S(e,t);return n.subscribe.bind(n)},t.decode=E,t.deepCopy=function(e){return d(void 0,e)},t.deepEqual=function e(t,n){if(t===n)return!0;const r=Object.keys(t),i=Object.keys(n);for(const s of r){if(!i.includes(s))return!1;const r=t[s],o=n[s];if(T(r)&&T(o)){if(!e(r,o))return!1}else if(r!==o)return!1}for(const e of i)if(!r.includes(e))return!1;return!0},t.deepExtend=d,t.errorPrefix=A,t.extractQuerystring=function(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)},t.getDefaultAppConfig=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config},t.getDefaultEmulatorHost=m,t.getDefaultEmulatorHostnameAndPort=e=>{const t=m(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},t.getDefaults=p,t.getExperimentalSetting=e=>{var t;return null===(t=p())||void 0===t?void 0:t[`_${e}`]},t.getGlobal=f,t.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},t.getUA=y,t.isAdmin=function(e){const t=E(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isBrowserExtension=function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},t.isElectron=function(){return y().indexOf("Electron/")>=0},t.isEmpty=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){const e=y();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){try{return"object"==typeof indexedDB}catch(e){return!1}},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())},t.isNode=v,t.isNodeSdk=function(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!v()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return y().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){const t=E(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){const t=E(e).claims,n=Math.floor((new Date).getTime()/1e3);let r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){const t=E(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=I,t.map=function(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.ordinal=function(e){return Number.isFinite(e)?e+function(e){const t=(e=Math.abs(e))%100;if(t>=10&&t<=20)return"th";const n=e%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(e):`${e}`},t.promiseWithTimeout=function(e,t=2e3){const n=new g;return setTimeout((()=>n.reject("timeout!")),t),e.then(n.resolve,n.reject),n.promise},t.querystring=function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);if(s>=55296&&s<=56319){const t=s-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),s=65536+(t<<10)+(e.charCodeAt(r)-56320)}s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):s<65536?(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.validateArgCount=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(A(e,t)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(A(e,t)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))},t.validateNamespace=function(e,t,n){if((!n||t)&&"string"!=typeof t)throw new Error(A(e,"namespace")+"must be a valid firebase namespace.")}},3637:(e,t,n)=>{(function(){var t;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:r(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}var s,o="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function u(e,t){if(t)e:{var n=c;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)s=Object.setPrototypeOf;else{var l;e:{var h={};try{h.__proto__={a:!0},l=h.a;break e}catch(q){}l=!1}s=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=s;function f(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function p(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}u("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}})),u("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return f(r(this))}})}return e})),u("Promise",(function(e){function t(e){this.g=0,this.i=void 0,this.h=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=c.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.B),reject:e(this.l)}},t.prototype.B=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.D(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.g)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.g);this.g=e,this.i=t,2===this.g&&this.C(),this.u()},t.prototype.C=function(){var e=this;s((function(){if(e.v()){var t=c.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.v=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.u=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)o.h(this.h[e]);this.h=null}};var o=new n;return t.prototype.D=function(e){var t=this.j();e.la(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){s(e)}}:t}var i,s,o=new t((function(e,t){i=e,s=t}));return this.la(r(e,i),r(n,s)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.la=function(e,t){function n(){switch(r.g){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.g)}}var r=this;null==this.h?o.h(n):this.h.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var s=i(e),o=s.next();!o.done;o=s.next())r(o.value).la(t,n)}))},t.all=function(e){var n=i(e),s=n.next();return s.done?r([]):new t((function(e,t){function i(t){return function(n){o[t]=n,0==--a&&e(o)}}var o=[],a=0;do{o.push(void 0),a++,r(s.value).la(i(o.length-1),t),s=n.next()}while(!s.done)}))},t})),u("Array.prototype.values",(function(e){return e||function(){return p(this,(function(e,t){return t}))}})),u("Array.prototype.keys",(function(e){return e||function(){return p(this,(function(e){return e}))}})),u("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=i(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function s(e){if(!m(e,c)){var t=new n;a(e,c,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&s(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var c="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(s(e),!m(e,c))throw Error("WeakMap key fail: "+e);return e[c][this.g]=t,this},t.prototype.get=function(e){return r(e)&&m(e,c)?e[c][this.g]:void 0},t.prototype.has=function(e){return r(e)&&m(e,c)&&m(e[c],this.g)},t.prototype.delete=function(e){return!!(r(e)&&m(e,c)&&m(e[c],this.g))&&delete e[c][this.g]},t})),u("Map",(function(e){function t(){var e={};return e.V=e.next=e.head=e}function n(e,t){var n=e.g;return f((function(){if(n){for(;n.head!=e.g;)n=n.V;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++a,o.set(t,n)):n="p_"+t;var r=e.h[n];if(r&&m(e.h,n))for(e=0;e<r.length;e++){var i=r[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:r,index:e,K:i}}return{id:n,list:r,index:-1,K:void 0}}function s(e){if(this.h={},this.g=t(),this.size=0,e){e=i(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&"s"==s.value[1]&&!((s=r.next()).done||4!=s.value[0].x||"t"!=s.value[1]||!r.next().done)}catch(e){return!1}}())return e;var o=new WeakMap;s.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.K?n.K.value=t:(n.K={next:this.g,V:this.g.V,head:this.g,key:e,value:t},n.list.push(n.K),this.g.V.next=n.K,this.g.V=n.K,this.size++),this},s.prototype.delete=function(e){return!(!(e=r(this,e)).K||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.K.V.next=e.K.next,e.K.next.V=e.K.V,e.K.head=null,this.size--,0))},s.prototype.clear=function(){this.h={},this.g=this.g.V=t(),this.size=0},s.prototype.has=function(e){return!!r(this,e).K},s.prototype.get=function(e){return(e=r(this,e).K)&&e.value},s.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},s.prototype.keys=function(){return n(this,(function(e){return e.key}))},s.prototype.values=function(){return n(this,(function(e){return e.value}))},s.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},s.prototype[Symbol.iterator]=s.prototype.entries;var a=0;return s})),u("Array.prototype.find",(function(e){return e||function(e,t){e:{var n=this;n instanceof String&&(n=String(n));for(var r=n.length,i=0;i<r;i++){var s=n[i];if(e.call(t,s,i,n)){e=s;break e}}e=void 0}return e}})),u("Array.prototype.entries",(function(e){return e||function(){return p(this,(function(e,t){return[e,t]}))}})),u("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var s=0;!(i=e.next()).done;)r.push(t.call(n,i.value,s++))}else for(i=e.length,s=0;s<i;s++)r.push(t.call(n,e[s],s));return r}})),u("Set",(function(e){function t(e){if(this.g=new Map,e){e=i(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&s.value[1]==t&&!(s=r.next()).done&&s.value[0]!=t&&4==s.value[0].x&&s.value[1]==s.value[0]&&r.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(r){return e.call(t,r,r,n)}))},t)}));var g=g||{},y=this||self;function v(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function w(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function b(e){return Object.prototype.hasOwnProperty.call(e,_)&&e[_]||(e[_]=++I)}var _="closure_uid_"+(1e9*Math.random()>>>0),I=0;function E(e,t,n){return e.call.apply(e.bind,arguments)}function T(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function S(e,t,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:T).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function A(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.dc=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function x(){0!=k&&(D[b(this)]=this),this.s=this.s,this.o=this.o}var k=0,D={};x.prototype.s=!1,x.prototype.va=function(){if(!this.s&&(this.s=!0,this.O(),0!=k)){var e=b(this);if(0!=k&&this.o&&0<this.o.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete D[e]}},x.prototype.O=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var N=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function O(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function P(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(v(r)){var i=e.length||0,s=r.length||0;e.length=i+s;for(var o=0;o<s;o++)e[i+o]=r[o]}else e.push(r)}}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!y.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{var n=function(){};y.addEventListener("test",n,t),y.removeEventListener("test",n,t)}catch(e){}return e}();function M(e){return/^[\s\xa0]*$/.test(e)}function F(){var e=y.navigator;return e&&(e=e.userAgent)?e:""}function U(e){return-1!=F().indexOf(e)}function V(e){return V[" "](e),e}V[" "]=function(){};var j,q,B,z=U("Opera"),G=U("Trident")||U("MSIE"),H=U("Edge"),K=H||G,$=U("Gecko")&&!(-1!=F().toLowerCase().indexOf("webkit")&&!U("Edge"))&&!(U("Trident")||U("MSIE"))&&!U("Edge"),W=-1!=F().toLowerCase().indexOf("webkit")&&!U("Edge");function Q(){var e=y.document;return e?e.documentMode:void 0}e:{var Y="",X=(q=F(),$?/rv:([^\);]+)(\)|;)/.exec(q):H?/Edge\/([\d\.]+)/.exec(q):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(q):W?/WebKit\/(\S+)/.exec(q):z?/(?:Version)[ \/]?(\S+)/.exec(q):void 0);if(X&&(Y=X?X[1]:""),G){var J=Q();if(null!=J&&J>parseFloat(Y)){j=String(J);break e}}j=Y}y.document&&G?B=Q()||parseInt(j,10)||void 0:B=void 0;var Z=B;function ee(e,t){if(R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if($){e:{try{V(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:te[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ee.Z.h.call(this)}}A(ee,R);var te={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),re=0;function ie(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.oa=i,this.key=++re,this.ha=this.ka=!1}function se(e){e.ha=!0,e.listener=null,e.proxy=null,e.src=null,e.oa=null}function oe(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ae(e){var t,n={};for(t in e)n[t]=e[t];return n}var ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<ce.length;s++)n=ce[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function le(e){this.src=e,this.g={},this.h=0}function he(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=N(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(se(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ha&&s.listener==t&&s.capture==!!n&&s.oa==r)return i}return-1}le.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=de(e,t,r,i);return-1<o?(t=e[o],n||(t.ka=!1)):((t=new ie(t,this.src,s,!!r,i)).ka=n,e.push(t)),t};var fe="closure_lm_"+(1e6*Math.random()|0),pe={};function me(e,t,n,r,i){if(r&&r.once)return ye(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)me(e,t[s],n,r,i);return null}return n=Te(n),e&&e[ne]?e.P(t,n,w(r)?!!r.capture:!!r,i):ge(e,t,n,!1,r,i)}function ge(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=w(i)?!!i.capture:!!i,a=Ie(e);if(a||(e[fe]=a=new le(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=_e;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)L||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(be(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ye(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ye(e,t[s],n,r,i);return null}return n=Te(n),e&&e[ne]?e.R(t,n,w(r)?!!r.capture:!!r,i):ge(e,t,n,!0,r,i)}function ve(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)ve(e,t[s],n,r,i);else r=w(r)?!!r.capture:!!r,n=Te(n),e&&e[ne]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=de(s=e.g[t],n,r,i))&&(se(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Ie(e))&&(t=e.g[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&we(n))}function we(e){if("number"!=typeof e&&e&&!e.ha){var t=e.src;if(t&&t[ne])he(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(be(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ie(t))?(he(n,e),0==n.h&&(n.src=null,t[fe]=null)):se(e)}}}function be(e){return e in pe?pe[e]:pe[e]="on"+e}function _e(e,t){if(e.ha)e=!0;else{t=new ee(t,this);var n=e.listener,r=e.oa||e.src;e.ka&&we(e),e=n.call(r,t)}return e}function Ie(e){return(e=e[fe])instanceof le?e:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function Te(e){return"function"==typeof e?e:(e[Ee]||(e[Ee]=function(t){return e.handleEvent(t)}),e[Ee])}function Se(){x.call(this),this.i=new le(this),this.T=this,this.J=null}function Ce(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.T,r=t.type||t,"string"==typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var i=t;ue(t=new R(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ae(o,r,!0,t)&&i}if(i=Ae(o=t.g=e,r,!0,t)&&i,i=Ae(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ae(o=t.g=n[s],r,!1,t)&&i}function Ae(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ha&&o.capture==n){var a=o.listener,c=o.oa||o.src;o.ka&&he(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}A(Se,x),Se.prototype[ne]=!0,Se.prototype.removeEventListener=function(e,t,n,r){ve(this,e,t,n,r)},Se.prototype.O=function(){if(Se.Z.O.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)se(n[r]);delete t.g[e],t.h--}}this.J=null},Se.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Se.prototype.R=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var xe=y.JSON.stringify;function ke(e,t){this.i=e,this.j=t,this.h=0,this.g=null}function De(){this.h=this.g=null}function Ne(){var e=Ue,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}ke.prototype.get=function(){if(0<this.h){this.h--;var e=this.g;this.g=e.next,e.next=null}else e=this.i();return e},De.prototype.add=function(e,t){var n=Oe.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n};var Oe=new ke((function(){return new Pe}),(function(e){return e.reset()}));function Pe(){this.next=this.g=this.h=null}function Re(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Le(e){y.setTimeout((function(){throw e}),0)}Pe.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},Pe.prototype.reset=function(){this.next=this.g=this.h=null};var Me,Fe=!1,Ue=new De;function Ve(e,t){Me||function(){var e=y.Promise.resolve(void 0);Me=function(){e.then(je)}}(),Fe||(Me(),Fe=!0),Ue.add(e,t)}function je(){for(var e;e=Ne();){try{e.h.call(e.g)}catch(e){Le(e)}var t=Oe;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Fe=!1}function qe(e,t){Se.call(this),this.h=e||1,this.g=t||y,this.j=S(this.tb,this),this.l=Date.now()}function Be(e){e.ia=!1,e.U&&(e.g.clearTimeout(e.U),e.U=null)}function ze(e,t,n){if("function"==typeof e)n&&(e=S(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=S(e.handleEvent,e)}return 2147483647<Number(t)?-1:y.setTimeout(e,t||0)}function Ge(e,t,n){x.call(this),this.m=null!=n?e.bind(n):e,this.j=t,this.h=null,this.i=!1,this.g=null}if(A(qe,Se),(t=qe.prototype).ia=!1,t.U=null,t.tb=function(){if(this.ia){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.U=this.g.setTimeout(this.j,this.h-e):(this.U&&(this.g.clearTimeout(this.U),this.U=null),Ce(this,"tick"),this.ia&&(Be(this),this.start()))}},t.start=function(){this.ia=!0,this.U||(this.U=this.g.setTimeout(this.j,this.h),this.l=Date.now())},t.O=function(){qe.Z.O.call(this),Be(this),delete this.g},Ge.prototype=o(x.prototype),Ge.prototype.constructor=Ge,d)d(Ge,x);else for(var He in x)if("prototype"!=He)if(Object.defineProperties){var Ke=Object.getOwnPropertyDescriptor(x,He);Ke&&Object.defineProperty(Ge,He,Ke)}else Ge[He]=x[He];function $e(e){e.g=ze((function(){e.g=null,e.i&&(e.i=!1,$e(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}function We(e){x.call(this),this.h=e,this.g={}}Ge.Z=x.prototype,Ge.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:$e(this)},Ge.prototype.O=function(){x.prototype.O.call(this),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},A(We,x);var Qe=[];function Ye(e,t,n,r){Array.isArray(n)||(n&&(Qe[0]=n.toString()),n=Qe);for(var i=0;i<n.length;i++){var s=me(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Xe(e){oe(e.g,(function(e,t){this.g.hasOwnProperty(t)&&we(e)}),e),e.g={}}function Je(){this.g=!0}function Ze(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return xe(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}We.prototype.O=function(){We.Z.O.call(this),Xe(this)},We.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Je.prototype.Ha=function(){this.g=!1},Je.prototype.info=function(){};var et={},tt=null;function nt(){return tt=tt||new Se}function rt(e){R.call(this,et.Wa,e)}function it(e){var t=nt();Ce(t,new rt(t,e))}function st(e,t){R.call(this,et.STAT_EVENT,e),this.stat=t}function ot(e){var t=nt();Ce(t,new st(t,e))}function at(e,t){R.call(this,et.Xa,e),this.size=t}function ct(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return y.setTimeout((function(){e()}),t)}et.Wa="serverreachability",A(rt,R),et.STAT_EVENT="statevent",A(st,R),et.Xa="timingevent",A(at,R);var ut={NO_ERROR:0,ub:1,Hb:2,Gb:3,Bb:4,Fb:5,Ib:6,Ta:7,TIMEOUT:8,Lb:9},lt={zb:"complete",Vb:"success",Ua:"error",Ta:"abort",Nb:"ready",Ob:"readystatechange",TIMEOUT:"timeout",Jb:"incrementaldata",Mb:"progress",Cb:"downloadprogress",cc:"uploadprogress"};function ht(){}function dt(e){return e.h||(e.h=e.i())}function ft(){}ht.prototype.h=null;var pt,mt={OPEN:"a",yb:"b",Ua:"c",Kb:"d"};function gt(){R.call(this,"d")}function yt(){R.call(this,"c")}function vt(){}function wt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.Y=r||1,this.W=new We(this),this.R=_t,e=K?125:void 0,this.X=new qe(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.M=this.G=this.aa=this.C=null,this.D=[],this.g=null,this.o=0,this.s=this.v=null,this.ea=-1,this.J=!1,this.P=0,this.N=null,this.da=this.L=this.ca=this.T=!1,this.h=new bt}function bt(){this.i=null,this.g="",this.h=!1}A(gt,R),A(yt,R),A(vt,ht),vt.prototype.g=function(){return new XMLHttpRequest},vt.prototype.i=function(){return{}},pt=new vt;var _t=45e3,It={},Et={};function Tt(e,t,n){e.M=1,e.A=zt(Ut(t)),e.u=n,e.T=!0,St(e,null)}function St(e,t){e.G=Date.now(),kt(e),e.B=Ut(e.A);var n=e.B,r=e.Y;Array.isArray(r)||(r=[String(r)]),nn(n.i,"t",r),e.o=0,n=e.l.J,e.h=new bt,e.g=ir(e.l,n?t:null,!e.u),0<e.P&&(e.N=new Ge(S(e.Sa,e,e.g),e.P)),Ye(e.W,e.g,"readystatechange",e.qb),t=e.I?ae(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ja(e.B,e.v,e.u,t)):(e.v="GET",e.g.ja(e.B,e.v,null,t)),it(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.Y,e.u)}function Ct(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.l.Ka}function At(e,t,n){for(var r,i=!0;!e.J&&e.o<n.length;){if((r=xt(e,n))==Et){4==t&&(e.s=4,ot(14),i=!1),Ze(e.j,e.m,null,"[Incomplete Response]");break}if(r==It){e.s=4,ot(15),Ze(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ze(e.j,e.m,r,null),Rt(e,r)}Ct(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,ot(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.da&&(e.da=!0,(t=e.l).g==e&&t.ea&&!t.N&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yn(t),t.N=!0,ot(11))):(Ze(e.j,e.m,n,"[Invalid Chunked Response]"),Pt(e),Ot(e))}function xt(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?Et:(n=Number(t.substring(n,r)),isNaN(n)?It:(r+=1)+n>t.length?Et:(t=t.slice(r,r+n),e.o=r+n,t))}function kt(e){e.aa=Date.now()+e.R,Dt(e,e.R)}function Dt(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=ct(S(e.ob,e),t)}function Nt(e){e.C&&(y.clearTimeout(e.C),e.C=null)}function Ot(e){0==e.l.H||e.J||Zn(e.l,e)}function Pt(e){Nt(e);var t=e.N;t&&"function"==typeof t.va&&t.va(),e.N=null,Be(e.X),Xe(e.W),e.g&&(t=e.g,e.g=null,t.abort(),t.va())}function Rt(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||hn(n.i,e)))if(!e.L&&hn(n.i,e)&&3==n.H){try{var r=n.Ma.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Jn(n),Bn(n)}Qn(n),ot(18)}}else n.Ia=i[1],0<n.Ia-n.X&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=ct(S(n.lb,n),6e3));if(1>=ln(n.i)&&n.ra){try{n.ra()}catch(e){}n.ra=void 0}}else tr(n,11)}else if((e.L||n.g==e)&&Jn(n),!M(t))for(i=n.Ma.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.X=s[0],s=s[1],2==n.H)if("c"==s[0]){n.L=s[1],n.sa=s[2];var o=s[3];null!=o&&(n.ua=o,n.l.info("VER="+n.ua));var a=s[4];null!=a&&(n.Ja=a,n.l.info("SVER="+n.Ja));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.M=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(dn(h,h.h),h.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.Ga=d,Bt(r.I,r.D,d))}}n.H=3,n.h&&n.h.Ea(),n.ea&&(n.T=Date.now()-e.G,n.l.info("Handshake RTT: "+n.T+"ms"));var f=e;if((r=n).za=rr(r,r.J?r.sa:null,r.aa),f.L){fn(r.i,f);var p=f,m=r.M;m&&p.setTimeout(m),p.C&&(Nt(p),kt(p)),r.g=f}else Wn(r);0<n.j.length&&Gn(n)}else"stop"!=s[0]&&"close"!=s[0]||tr(n,7);else 3==n.H&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?tr(n,7):qn(n):"noop"!=s[0]&&n.h&&n.h.Da(s),n.A=0)}it(4)}catch(e){}}function Lt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(v(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.wa&&"function"==typeof e.wa)return e.wa();if(!e.ba||"function"!=typeof e.ba){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(v(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.ba&&"function"==typeof e.ba)return e.ba();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(v(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(t=wt.prototype).setTimeout=function(e){this.R=e},t.qb=function(e){e=e.target;var t=this.N;t&&3==Ln(e)?t.l():this.Sa(e)},t.Sa=function(e){try{if(e==this.g)e:{var t=Ln(this.g),n=this.g.La(),r=this.g.fa();if(!(3>t)&&(3!=t||K||this.g&&(this.h.h||this.g.ma()||Mn(this.g)))){this.J||4!=t||7==n||it(8==n||0>=r?3:2),Nt(this);var i=this.g.fa();this.ea=i;t:if(Ct(this)){var s=Mn(this.g);e="";var o=s.length,a=4==Ln(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Pt(this),Ot(this);var c="";break t}this.h.i=new y.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.length=0,this.h.g+=e,this.o=0,c=this.h.g}else c=this.g.ma();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.Y,t,i),this.i){if(this.ca&&!this.L){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(u)){var h=u;break t}}h=null}if(!(i=h)){this.i=!1,this.s=3,ot(12),Pt(this),Ot(this);break e}Ze(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Rt(this,i)}this.T?(At(this,t,c),K&&this.i&&3==t&&(Ye(this.W,this.X,"tick",this.pb),this.X.start())):(Ze(this.j,this.m,c,null),Rt(this,c)),4==t&&Pt(this),this.i&&!this.J&&(4==t?Zn(this.l,this):(this.i=!1,kt(this)))}else(function(e){var t={};e=(e.g&&2<=Ln(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!M(e[n])){var r=Re(e[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var s=t[i]||[];t[i]=s,s.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==i&&0<c.indexOf("Unknown SID")?(this.s=3,ot(12)):(this.s=0,ot(13)),Pt(this),Ot(this)}}}catch(e){}},t.pb=function(){if(this.g){var e=Ln(this.g),t=this.g.ma();this.o<t.length&&(Nt(this),At(this,e,t),this.i&&4!=e&&kt(this))}},t.cancel=function(){this.J=!0,Pt(this)},t.ob=function(){this.C=null;var e=Date.now();0<=e-this.aa?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.M&&(it(3),ot(17)),Pt(this),this.s=2,Ot(this)):Dt(this,this.aa-e)};var Mt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(e){var t;this.g=this.s=this.j="",this.o=null,this.m=this.h="",this.l=!1,e instanceof Ft?(this.l=e.l,Vt(this,e.j),this.s=e.s,this.g=e.g,jt(this,e.o),this.h=e.h,qt(this,rn(e.i)),this.m=e.m):e&&(t=String(e).match(Mt))?(this.l=!1,Vt(this,t[1]||"",!0),this.s=Gt(t[2]||""),this.g=Gt(t[3]||"",!0),jt(this,t[4]),this.h=Gt(t[5]||"",!0),qt(this,t[6]||"",!0),this.m=Gt(t[7]||"")):(this.l=!1,this.i=new Jt(null,this.l))}function Ut(e){return new Ft(e)}function Vt(e,t,n){e.j=n?Gt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function jt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.o=t}else e.o=null}function qt(e,t,n){t instanceof Jt?(e.i=t,function(e,t){t&&!e.j&&(Zt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(en(this,t),nn(this,n,e))}),e)),e.j=t}(e.i,e.l)):(n||(t=Ht(t,Yt)),e.i=new Jt(t,e.l))}function Bt(e,t,n){e.i.set(t,n)}function zt(e){return Bt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Gt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ht(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Kt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Kt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ht(t,$t,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ht(t,$t,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.o)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ht(n,"/"==n.charAt(0)?Qt:Wt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Ht(n,Xt)),e.join("")},Ft.prototype.resolve=function(e){var t=Ut(this),n=!!e.j;n?Vt(t,e.j):n=!!e.s,n?t.s=e.s:n=!!e.g,n?t.g=e.g:n=null!=e.o;var r=e.h;if(n)jt(t,e.o);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],o=0;o<i.length;){var a=i[o++];"."==a?r&&o==i.length&&s.push(""):".."==a?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&o==i.length&&s.push("")):(s.push(a),r=!0)}r=s.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?qt(t,rn(e.i)):n=!!e.m,n&&(t.m=e.m),t};var $t=/[#\/\?@]/g,Wt=/[#\?:]/g,Qt=/[#\?]/g,Yt=/[#\?@]/g,Xt=/#/g;function Jt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Zt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function en(e,t){Zt(e),t=sn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tn(e,t){return Zt(e),t=sn(e,t),e.g.has(t)}function nn(e,t,n){en(e,t),0<n.length&&(e.i=null,e.g.set(sn(e,t),O(n)),e.h+=n.length)}function rn(e){var t=new Jt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function sn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function on(e,t){this.g=e,this.map=t}function an(e){this.l=e||cn,e=y.PerformanceNavigationTiming?0<(e=y.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(y.g&&y.g.Na&&y.g.Na()&&y.g.Na().hc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(t=Jt.prototype).add=function(e,t){Zt(this),this.i=null,e=sn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},t.forEach=function(e,t){Zt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},t.wa=function(){Zt(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},t.ba=function(e){Zt(this);var t=[];if("string"==typeof e)tn(this,e)&&(t=t.concat(this.g.get(sn(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},t.set=function(e,t){return Zt(this),this.i=null,tn(this,e=sn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&0<(e=this.ba(e)).length?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.ba(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var cn=10;function un(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ln(e){return e.h?1:e.g?e.g.size:0}function hn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function dn(e,t){e.g?e.g.add(t):e.h=t}function fn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function pn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){for(var t=e.i,n=(e=i(e.g.values())).next();!n.done;n=e.next())t=t.concat(n.value.D);return t}return O(e.i)}function mn(){}function gn(){this.g=new mn}function yn(e,t,n){var r=n||"";try{Lt(e,(function(e,n){var i=e;w(e)&&(i=xe(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function vn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function wn(e){this.l=e.ic||null,this.j=e.rb||!1}function bn(e,t){Se.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=_n,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}an.prototype.cancel=function(){if(this.i=pn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(var e=i(this.g.values()),t=e.next();!t.done;t=e.next())t.value.cancel();this.g.clear()}},mn.prototype.stringify=function(e){return y.JSON.stringify(e,void 0)},mn.prototype.parse=function(e){return y.JSON.parse(e,void 0)},A(wn,ht),wn.prototype.g=function(){return new bn(this.l,this.j)},wn.prototype.i=function(e){return function(){return e}}({}),A(bn,Se);var _n=0;function In(e){e.j.read().then(e.$a.bind(e)).catch(e.na.bind(e))}function En(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Tn(e)}function Tn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(t=bn.prototype).open=function(e,t){if(this.readyState!=_n)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Tn(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||y).fetch(new Request(this.B,t)).then(this.cb.bind(this),this.na.bind(this))},t.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,En(this)),this.readyState=_n},t.cb=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Tn(this)),this.g&&(this.readyState=3,Tn(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.ab.bind(this),this.na.bind(this));else if(void 0!==y.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;In(this)}else e.text().then(this.bb.bind(this),this.na.bind(this))},t.$a=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?En(this):Tn(this),3==this.readyState&&In(this)}},t.bb=function(e){this.g&&(this.response=this.responseText=e,En(this))},t.ab=function(e){this.g&&(this.response=e,En(this))},t.na=function(){this.g&&En(this)},t.setRequestHeader=function(e,t){this.v.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(bn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Sn=y.JSON.parse;function Cn(e){Se.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.D=!1,this.B=0,this.A=null,this.L=An,this.M=this.N=!1}A(Cn,Se);var An="",xn=/^https?$/i,kn=["POST","PUT"];function Dn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Nn(e),Pn(e)}function Nn(e){e.D||(e.D=!0,Ce(e,"complete"),Ce(e,"error"))}function On(e){if(e.h&&void 0!==g&&(!e.C[1]||4!=Ln(e)||2!=e.fa()))if(e.v&&4==Ln(e))ze(e.Oa,0,e);else if(Ce(e,"readystatechange"),4==Ln(e)){e.h=!1;try{var t,n=e.fa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.I).match(Mt)[1]||null;!s&&y.self&&y.self.location&&(s=y.self.location.protocol.slice(0,-1)),i=!xn.test(s?s.toLowerCase():"")}t=i}if(t)Ce(e,"complete"),Ce(e,"success");else{e.m=6;try{var o=2<Ln(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.fa()+"]",Nn(e)}}finally{Pn(e)}}}function Pn(e,t){if(e.g){Rn(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||Ce(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Rn(e){e.g&&e.M&&(e.g.ontimeout=null),e.A&&(y.clearTimeout(e.A),e.A=null)}function Ln(e){return e.g?e.g.readyState:0}function Mn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.L){case An:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Fn(e){var t="";return oe(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Un(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Fn(n),"string"==typeof e?(encodeURIComponent(String(t)),null!=n&&encodeURIComponent(String(n))):Bt(e,t,n))}function Vn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function jn(e){this.Ja=0,this.j=[],this.l=new Je,this.sa=this.za=this.I=this.aa=this.g=this.Ga=this.D=this.qa=this.o=this.W=this.s=null,this.ib=this.Y=0,this.gb=Vn("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.ca=!0,this.Ia=this.X=-1,this.da=this.A=this.C=0,this.eb=Vn("baseRetryDelayMs",5e3,e),this.kb=Vn("retryDelaySeedMs",1e4,e),this.hb=Vn("forwardChannelMaxRetries",2,e),this.Aa=Vn("forwardChannelRequestTimeoutMs",2e4,e),this.ya=e&&e.xmlHttpFactory||void 0,this.Ka=e&&e.useFetchStreams||!1,this.M=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.L="",this.i=new an(e&&e.concurrentRequestLimit),this.Ma=new gn,this.R=e&&e.fastHandshake||!1,this.P=e&&e.encodeInitMessageHeaders||!1,this.R&&this.P&&(this.P=!1),this.fb=e&&e.ec||!1,e&&e.Ha&&this.l.Ha(),e&&e.forceLongPolling&&(this.ca=!1),this.ea=!this.R&&this.ca&&e&&e.detectBufferingProxy||!1,this.ta=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ta=e.longPollingTimeout),this.ra=void 0,this.T=0,this.N=!1,this.pa=this.B=null}function qn(e){if(zn(e),3==e.H){var t=e.Y++,n=Ut(e.I);if(Bt(n,"SID",e.L),Bt(n,"RID",t),Bt(n,"TYPE","terminate"),Kn(e,n),(t=new wt(e,e.l,t)).M=2,t.A=zt(Ut(n)),n=!1,y.navigator&&y.navigator.sendBeacon)try{n=y.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&y.Image&&((new Image).src=t.A,n=!0),n||(t.g=ir(t.l,null),t.g.ja(t.A)),t.G=Date.now(),kt(t)}nr(e)}function Bn(e){e.g&&(Yn(e),e.g.cancel(),e.g=null)}function zn(e){Bn(e),e.u&&(y.clearTimeout(e.u),e.u=null),Jn(e),e.i.cancel(),e.m&&("number"==typeof e.m&&y.clearTimeout(e.m),e.m=null)}function Gn(e){un(e.i)||e.m||(e.m=!0,Ve(e.Qa,e),e.C=0)}function Hn(e,t){var n;n=t?t.m:e.Y++;var r=Ut(e.I);Bt(r,"SID",e.L),Bt(r,"RID",n),Bt(r,"AID",e.X),Kn(e,r),e.o&&e.s&&Un(r,e.o,e.s),n=new wt(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.D.concat(e.j)),t=$n(e,n,1e3),n.setTimeout(Math.round(.5*e.Aa)+Math.round(.5*e.Aa*Math.random())),dn(e.i,n),Tt(n,r,t)}function Kn(e,t){e.qa&&oe(e.qa,(function(e,n){Bt(t,n,e)})),e.h&&Lt({},(function(e,n){Bt(t,n,e)}))}function $n(e,t,n){n=Math.min(e.j.length,n);var r=e.h?S(e.h.Ya,e.h,e):null;e:for(var i=e.j,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].g,l=i[c].map;if(0>(u-=s))s=Math.max(0,i[c].g-100),a=!1;else try{yn(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.j.splice(0,n),t.D=e,r}function Wn(e){e.g||e.u||(e.da=1,Ve(e.Pa,e),e.A=0)}function Qn(e){return!(e.g||e.u||3<=e.A||(e.da++,e.u=ct(S(e.Pa,e),er(e,e.A)),e.A++,0))}function Yn(e){null!=e.B&&(y.clearTimeout(e.B),e.B=null)}function Xn(e){e.g=new wt(e,e.l,"rpc",e.da),null===e.o&&(e.g.I=e.s),e.g.P=0;var t=Ut(e.za);Bt(t,"RID","rpc"),Bt(t,"SID",e.L),Bt(t,"AID",e.X),Bt(t,"CI",e.G?"0":"1"),!e.G&&e.ta&&Bt(t,"TO",e.ta),Bt(t,"TYPE","xmlhttp"),Kn(e,t),e.o&&e.s&&Un(t,e.o,e.s),e.M&&e.g.setTimeout(e.M);var n=e.g;e=e.sa,n.M=1,n.A=zt(Ut(t)),n.u=null,n.T=!0,St(n,e)}function Jn(e){null!=e.v&&(y.clearTimeout(e.v),e.v=null)}function Zn(e,t){var n=null;if(e.g==t){Jn(e),Yn(e),e.g=null;var r=2}else{if(!hn(e.i,t))return;n=t.D,fn(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;Ce(r=nt(),new at(r,n,t,i)),Gn(e)}else Wn(e);else if(3==(i=t.s)||0==i&&0<t.ea||!(1==r&&function(e,t){return!(ln(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.D.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.gb?0:e.hb)||(e.m=ct(S(e.Qa,e,t),er(e,e.C)),e.C++,0)))}(e,t)||2==r&&Qn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:tr(e,5);break;case 4:tr(e,10);break;case 3:tr(e,6);break;default:tr(e,2)}}function er(e,t){var n=e.eb+Math.floor(Math.random()*e.kb);return e.isActive()||(n*=2),n*t}function tr(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=S(e.sb,e);n||(n=new Ft("//www.google.com/images/cleardot.gif"),y.location&&"http"==y.location.protocol||Vt(n,"https"),zt(n)),function(e,t){var n=new Je;if(y.Image){var r=new Image;r.onload=C(vn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=C(vn,n,r,"TestLoadImage: error",!1,t),r.onabort=C(vn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=C(vn,n,r,"TestLoadImage: timeout",!1,t),y.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ot(2);e.H=0,e.h&&e.h.Ca(t),nr(e),zn(e)}function nr(e){if(e.H=0,e.pa=[],e.h){var t=pn(e.i);0==t.length&&0==e.j.length||(P(e.pa,t),P(e.pa,e.j),e.i.i.length=0,O(e.j),e.j.length=0),e.h.Ba()}}function rr(e,t,n){var r=n instanceof Ft?Ut(n):new Ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),jt(r,r.o);else{var i=y.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Ft(null);r&&Vt(s,r),t&&(s.g=t),i&&jt(s,i),n&&(s.h=n),r=s}return n=e.D,t=e.Ga,n&&t&&Bt(r,n,t),Bt(r,"VER",e.ua),Kn(e,r),r}function ir(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ka&&!e.ya?new Cn(new wn({rb:n})):new Cn(e.ya)).Ra(e.J),t}function sr(){}function or(){if(G&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function ar(e,t){Se.call(this),this.g=new jn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Fa&&(e?e["X-WebChannel-Client-Profile"]=t.Fa:e={"X-WebChannel-Client-Profile":t.Fa}),this.g.W=e,(e=t&&t.fc)&&!M(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!M(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new lr(this)}function cr(e){gt.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ur(){yt.call(this),this.status=1}function lr(e){this.g=e}function hr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function dr(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function fr(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(t=Cn.prototype).Ra=function(e){this.N=e},t.ja=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():pt.g(),this.C=this.u?dt(this.u):dt(pt),this.g.onreadystatechange=S(this.Oa,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void Dn(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(var o=(s=i(r.keys())).next();!o.done;o=s.next())o=o.value,n.set(o,r.get(o))}for(r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),s=y.FormData&&e instanceof y.FormData,!(0<=N(kn,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r=(t=i(n)).next();!r.done;r=t.next())r=(n=i(r.value)).next().value,n=n.next().value,this.g.setRequestHeader(r,n);this.L&&(this.g.responseType=this.L),"withCredentials"in this.g&&this.g.withCredentials!==this.N&&(this.g.withCredentials=this.N);try{Rn(this),0<this.B&&((this.M=function(e){return G&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=S(this.xa,this)):this.A=ze(this.xa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Dn(this,e)}},t.xa=function(){void 0!==g&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ce(this,"timeout"),this.abort(8))},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ce(this,"complete"),Ce(this,"abort"),Pn(this))},t.O=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pn(this,!0)),Cn.Z.O.call(this)},t.Oa=function(){this.s||(this.G||this.v||this.l?On(this):this.nb())},t.nb=function(){On(this)},t.isActive=function(){return!!this.g},t.fa=function(){try{return 2<Ln(this)?this.g.status:-1}catch(e){return-1}},t.ma=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.Za=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Sn(t)}},t.La=function(){return this.m},t.Va=function(){return"string"==typeof this.j?this.j:String(this.j)},(t=jn.prototype).ua=8,t.H=1,t.Qa=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.Y=Math.floor(1e5*Math.random()),e=this.Y++;var t,n=new wt(this,this.l,e),r=this.s;if(this.W&&(r?ue(r=ae(r),this.W):r=this.W),null!==this.o||this.P||(n.I=r,r=null),this.R)e:{for(var i=t=0;i<this.j.length;i++){var s=this.j[i];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=i;break e}if(4096===t||i===this.j.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=$n(this,n,t),Bt(i=Ut(this.I),"RID",e),Bt(i,"CVER",22),this.D&&Bt(i,"X-HTTP-Session-Id",this.D),Kn(this,i),r&&(this.P?t="headers="+encodeURIComponent(String(Fn(r)))+"&"+t:this.o&&Un(i,this.o,r)),dn(this.i,n),this.fb&&Bt(i,"TYPE","init"),this.R?(Bt(i,"$req",t),Bt(i,"SID","null"),n.ca=!0,Tt(n,i,null)):Tt(n,i,t),this.H=2}}else 3==this.H&&(e?Hn(this,e):0==this.j.length||un(this.i)||Hn(this))},t.Pa=function(){if(this.u=null,Xn(this),this.ea&&!(this.N||null==this.g||0>=this.T)){var e=2*this.T;this.l.info("BP detection timer enabled: "+e),this.B=ct(S(this.mb,this),e)}},t.mb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.N=!0,ot(10),Bn(this),Xn(this))},t.lb=function(){null!=this.v&&(this.v=null,Bn(this),Qn(this),ot(19))},t.sb=function(e){e?(this.l.info("Successfully pinged google.com"),ot(2)):(this.l.info("Failed to ping google.com"),ot(1))},t.isActive=function(){return!!this.h&&this.h.isActive(this)},(t=sr.prototype).Ea=function(){},t.Da=function(){},t.Ca=function(){},t.Ba=function(){},t.isActive=function(){return!0},t.Ya=function(){},or.prototype.g=function(e,t){return new ar(e,t)},A(ar,Se),ar.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ot(0),e.aa=t,e.qa=n||{},e.G=e.ca,e.I=rr(e,null,e.aa),Gn(e)},ar.prototype.close=function(){qn(this.g)},ar.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=xe(e),e=n);t.j.push(new on(t.ib++,e)),3==t.H&&Gn(t)},ar.prototype.O=function(){this.g.h=null,delete this.j,qn(this.g),delete this.g,ar.Z.O.call(this)},A(cr,gt),A(ur,yt),A(lr,sr),lr.prototype.Ea=function(){Ce(this.g,"a")},lr.prototype.Da=function(e){Ce(this.g,new cr(e))},lr.prototype.Ca=function(e){Ce(this.g,new ur(e))},lr.prototype.Ba=function(){Ce(this.g,"b")},A(hr,(function(){this.blockSize=-1})),hr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},hr.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)dr(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){dr(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){dr(this,r),i=0;break}}this.h=i,this.i+=t},hr.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var pr={};function mr(e){return-128<=e&&128>e?function(e,t){var n=pr;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new fr([0|e],0>e?-1:0)}(e)}(e):new fr([0|e],0>e?-1:0)}function gr(e){if(isNaN(e)||!isFinite(e))return vr;if(0>e)return Er(gr(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=yr;return new fr(t,0)}var yr=4294967296,vr=mr(0),wr=mr(1),br=mr(16777216);function _r(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Ir(e){return-1==e.h}function Er(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new fr(n,~e.h).add(wr)}function Tr(e,t){return e.add(Er(t))}function Sr(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Cr(e,t){this.g=e,this.h=t}function Ar(e,t){if(_r(t))throw Error("division by zero");if(_r(e))return new Cr(vr,vr);if(Ir(e))return t=Ar(Er(e),t),new Cr(Er(t.g),Er(t.h));if(Ir(t))return t=Ar(e,Er(t)),new Cr(Er(t.g),t.h);if(30<e.g.length){if(Ir(e)||Ir(t))throw Error("slowDivide_ only works with positive integers.");for(var n=wr,r=t;0>=r.$(e);)n=xr(n),r=xr(r);var i=kr(n,1),s=kr(r,1);for(r=kr(r,2),n=kr(n,2);!_r(r);){var o=s.add(r);0>=o.$(e)&&(i=i.add(n),s=o),r=kr(r,1),n=kr(n,1)}return t=Tr(e,i.S(t)),new Cr(i,t)}for(i=vr;0<=e.$(t);){for(n=Math.max(1,Math.floor(e.ga()/t.ga())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=gr(n)).S(t);Ir(o)||0<o.$(e);)o=(s=gr(n-=r)).S(t);_r(s)&&(s=wr),i=i.add(s),e=Tr(e,o)}return new Cr(i,e)}function xr(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.F(r)<<1|e.F(r-1)>>>31;return new fr(n,e.h)}function kr(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.F(s+n)>>>t|e.F(s+n+1)<<32-t:e.F(s+n);return new fr(i,e.h)}(t=fr.prototype).ga=function(){if(Ir(this))return-Er(this).ga();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.F(n);e+=(0<=r?r:yr+r)*t,t*=yr}return e},t.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(_r(this))return"0";if(Ir(this))return"-"+Er(this).toString(e);for(var t=gr(Math.pow(e,6)),n=this,r="";;){var i=Ar(n,t).g,s=((0<(n=Tr(n,i.S(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(_r(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},t.F=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},t.$=function(e){return Ir(e=Tr(this,e))?-1:_r(e)?0:1},t.abs=function(){return Ir(this)?Er(this):this},t.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.F(i))+(65535&e.F(i)),o=(s>>>16)+(this.F(i)>>>16)+(e.F(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new fr(n,-2147483648&n[n.length-1]?-1:0)},t.S=function(e){if(_r(this)||_r(e))return vr;if(Ir(this))return Ir(e)?Er(this).S(Er(e)):Er(Er(this).S(e));if(Ir(e))return Er(this.S(Er(e)));if(0>this.$(br)&&0>e.$(br))return gr(this.ga()*e.ga());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.F(r)>>>16,o=65535&this.F(r),a=e.F(i)>>>16,c=65535&e.F(i);n[2*r+2*i]+=o*c,Sr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Sr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Sr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Sr(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new fr(n,0)},t.jb=function(e){return Ar(this,e).h},t.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)&e.F(r);return new fr(n,this.h&e.h)},t.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)|e.F(r);return new fr(n,this.h|e.h)},t.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)^e.F(r);return new fr(n,this.h^e.h)},or.prototype.createWebChannel=or.prototype.g,ar.prototype.send=ar.prototype.u,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,lt.COMPLETE="complete",ft.EventType=mt,mt.OPEN="a",mt.CLOSE="b",mt.ERROR="c",mt.MESSAGE="d",Se.prototype.listen=Se.prototype.P,Cn.prototype.listenOnce=Cn.prototype.R,Cn.prototype.getLastError=Cn.prototype.Va,Cn.prototype.getLastErrorCode=Cn.prototype.La,Cn.prototype.getStatus=Cn.prototype.fa,Cn.prototype.getResponseJson=Cn.prototype.Za,Cn.prototype.getResponseText=Cn.prototype.ma,Cn.prototype.send=Cn.prototype.ja,Cn.prototype.setWithCredentials=Cn.prototype.Ra,hr.prototype.digest=hr.prototype.l,hr.prototype.reset=hr.prototype.reset,hr.prototype.update=hr.prototype.j,fr.prototype.add=fr.prototype.add,fr.prototype.multiply=fr.prototype.S,fr.prototype.modulo=fr.prototype.jb,fr.prototype.compare=fr.prototype.$,fr.prototype.toNumber=fr.prototype.ga,fr.prototype.toString=fr.prototype.toString,fr.prototype.getBits=fr.prototype.F,fr.fromNumber=gr,fr.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Er(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=gr(Math.pow(n,8)),i=vr,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=gr(Math.pow(n,o)),i=i.S(o).add(gr(a))):i=(i=i.S(r)).add(gr(a))}return i},e.exports.createWebChannelTransport=function(){return new or},e.exports.getStatEventTarget=function(){return nt()},e.exports.ErrorCode=ut,e.exports.EventType=lt,e.exports.Event=et,e.exports.Stat={Ab:0,Db:1,Eb:2,Xb:3,bc:4,Zb:5,$b:6,Yb:7,Wb:8,ac:9,PROXY:10,NOPROXY:11,Ub:12,Qb:13,Rb:14,Pb:15,Sb:16,Tb:17,wb:18,vb:19,xb:20},e.exports.FetchXmlHttpFactory=wn,e.exports.WebChannel=ft,e.exports.XhrIo=Cn,e.exports.Md5=hr,e.exports.Integer=fr}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},4568:e=>{!function(e,t,n,r,i){if("customElements"in n)i();else{if(n.AWAITING_WEB_COMPONENTS_POLYFILL)return void n.AWAITING_WEB_COMPONENTS_POLYFILL.then(i);var s=n.AWAITING_WEB_COMPONENTS_POLYFILL=c();s.then(i);var o=n.WEB_COMPONENTS_POLYFILL||"//cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/2.0.2/webcomponents-bundle.js",a=n.ES6_CORE_POLYFILL||"//cdnjs.cloudflare.com/ajax/libs/core-js/2.5.3/core.min.js";"Promise"in n?u(o).then((function(){s.isDone=!0,s.exec()})):u(a).then((function(){u(o).then((function(){s.isDone=!0,s.exec()}))}))}function c(){var e=[];return e.isDone=!1,e.exec=function(){e.splice(0).forEach((function(e){e()}))},e.then=function(t){return e.isDone?t():e.push(t),e},e}function u(e){var t=c(),n=r.createElement("script");return n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t.isDone=!0,t.exec())}:n.onload=function(){t.isDone=!0,t.exec()},n.src=e,r.getElementsByTagName("head")[0].appendChild(n),n.then=t.then,n}}(0,0,window,document,(function(){var t;window,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var s=(n=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),o=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[r].concat(o).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var s=this[i][0];"number"==typeof s&&(r[s]=!0)}for(i=0;i<e.length;i++){var o=e[i];"number"==typeof o[0]&&r[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),t.push(o))}},t}},function(e,t,n){var r=n(3);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){var r=n(4);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@-webkit-keyframes burst{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}90%{-webkit-transform:scale(1.5);transform:scale(1.5);opacity:0}}@keyframes burst{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}90%{-webkit-transform:scale(1.5);transform:scale(1.5);opacity:0}}@-webkit-keyframes flashing{0%{opacity:1}45%{opacity:0}90%{opacity:1}}@keyframes flashing{0%{opacity:1}45%{opacity:0}90%{opacity:1}}@-webkit-keyframes fade-left{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(-20px);transform:translateX(-20px);opacity:0}}@keyframes fade-left{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(-20px);transform:translateX(-20px);opacity:0}}@-webkit-keyframes fade-right{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(20px);transform:translateX(20px);opacity:0}}@keyframes fade-right{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(20px);transform:translateX(20px);opacity:0}}@-webkit-keyframes fade-up{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(-20px);transform:translateY(-20px);opacity:0}}@keyframes fade-up{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(-20px);transform:translateY(-20px);opacity:0}}@-webkit-keyframes fade-down{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(20px);transform:translateY(20px);opacity:0}}@keyframes fade-down{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(20px);transform:translateY(20px);opacity:0}}@-webkit-keyframes tada{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}10%,20%{-webkit-transform:scale3d(.95,.95,.95) rotate(-10deg);transform:scale3d(.95,.95,.95) rotate(-10deg)}30%,50%,70%,90%{-webkit-transform:scaleX(1) rotate(10deg);transform:scaleX(1) rotate(10deg)}40%,60%,80%{-webkit-transform:scaleX(1) rotate(-10deg);transform:scaleX(1) rotate(-10deg)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes tada{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}10%,20%{-webkit-transform:scale3d(.95,.95,.95) rotate(-10deg);transform:scale3d(.95,.95,.95) rotate(-10deg)}30%,50%,70%,90%{-webkit-transform:scaleX(1) rotate(10deg);transform:scaleX(1) rotate(10deg)}40%,60%,80%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}.bx-spin,.bx-spin-hover:hover{-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}.bx-tada,.bx-tada-hover:hover{-webkit-animation:tada 1.5s ease infinite;animation:tada 1.5s ease infinite}.bx-flashing,.bx-flashing-hover:hover{-webkit-animation:flashing 1.5s infinite linear;animation:flashing 1.5s infinite linear}.bx-burst,.bx-burst-hover:hover{-webkit-animation:burst 1.5s infinite linear;animation:burst 1.5s infinite linear}.bx-fade-up,.bx-fade-up-hover:hover{-webkit-animation:fade-up 1.5s infinite linear;animation:fade-up 1.5s infinite linear}.bx-fade-down,.bx-fade-down-hover:hover{-webkit-animation:fade-down 1.5s infinite linear;animation:fade-down 1.5s infinite linear}.bx-fade-left,.bx-fade-left-hover:hover{-webkit-animation:fade-left 1.5s infinite linear;animation:fade-left 1.5s infinite linear}.bx-fade-right,.bx-fade-right-hover:hover{-webkit-animation:fade-right 1.5s infinite linear;animation:fade-right 1.5s infinite linear}",""])},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,'.bx-rotate-90{transform:rotate(90deg);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)"}.bx-rotate-180{transform:rotate(180deg);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)"}.bx-rotate-270{transform:rotate(270deg);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"}.bx-flip-horizontal{transform:scaleX(-1);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)"}.bx-flip-vertical{transform:scaleY(-1);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}',""])},function(e,t,n){"use strict";n.r(t),n.d(t,"BoxIconElement",(function(){return v}));var r,i,s,o,a=n(1),c=n.n(a),u=n(2),l=n.n(u),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=(i=(r=Object).getPrototypeOf||function(e){return e.__proto__},s=r.setPrototypeOf||function(e,t){return e.__proto__=t,e},o="object"===("undefined"==typeof Reflect?"undefined":h(Reflect))?Reflect.construct:function(e,t,n){var r,i=[null];return i.push.apply(i,t),r=e.bind.apply(e,i),s(new r,n.prototype)},function(e){var t=i(e);return s(e,s((function(){return o(t,arguments,i(this).constructor)}),t))}),p=window,m={},g=document.createElement("template"),y=function(){return!!p.ShadyCSS};g.innerHTML='\n<style>\n:host {\n  display: inline-block;\n  font-size: initial;\n  box-sizing: border-box;\n  width: 24px;\n  height: 24px;\n}\n:host([size=xs]) {\n    width: 0.8rem;\n    height: 0.8rem;\n}\n:host([size=sm]) {\n    width: 1.55rem;\n    height: 1.55rem;\n}\n:host([size=md]) {\n    width: 2.25rem;\n    height: 2.25rem;\n}\n:host([size=lg]) {\n    width: 3.0rem;\n    height: 3.0rem;\n}\n\n:host([size]:not([size=""]):not([size=xs]):not([size=sm]):not([size=md]):not([size=lg])) {\n    width: auto;\n    height: auto;\n}\n:host([pull=left]) #icon {\n    float: left;\n    margin-right: .3em!important;\n}\n:host([pull=right]) #icon {\n    float: right;\n    margin-left: .3em!important;\n}\n:host([border=square]) #icon {\n    padding: .25em;\n    border: .07em solid rgba(0,0,0,.1);\n    border-radius: .25em;\n}\n:host([border=circle]) #icon {\n    padding: .25em;\n    border: .07em solid rgba(0,0,0,.1);\n    border-radius: 50%;\n}\n#icon,\nsvg {\n  width: 100%;\n  height: 100%;\n}\n#icon {\n    box-sizing: border-box;\n} \n'+c.a+"\n"+l.a+'\n</style>\n<div id="icon"></div>';var v=f(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.$ui=e.attachShadow({mode:"open"}),e.$ui.appendChild(e.ownerDocument.importNode(g.content,!0)),y()&&p.ShadyCSS.styleElement(e),e._state={$iconHolder:e.$ui.getElementById("icon"),type:e.getAttribute("type")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,HTMLElement),d(t,null,[{key:"getIconSvg",value:function(e,t){var n=this.cdnUrl+"/regular/bx-"+e+".svg";return"solid"===t?n=this.cdnUrl+"/solid/bxs-"+e+".svg":"logo"===t&&(n=this.cdnUrl+"/logos/bxl-"+e+".svg"),n&&m[n]||(m[n]=new Promise((function(e,t){var r=new XMLHttpRequest;r.addEventListener("load",(function(){this.status<200||this.status>=300?t(new Error(this.status+" "+this.responseText)):e(this.responseText)})),r.onerror=t,r.onabort=t,r.open("GET",n),r.send()}))),m[n]}},{key:"define",value:function(e){e=e||this.tagName,y()&&p.ShadyCSS.prepareTemplate(g,e),customElements.define(e,this)}},{key:"cdnUrl",get:function(){return"//unpkg.com/boxicons@2.1.4/svg"}},{key:"tagName",get:function(){return"box-icon"}},{key:"observedAttributes",get:function(){return["type","name","color","size","rotate","flip","animation","border","pull"]}}]),d(t,[{key:"attributeChangedCallback",value:function(e,t,n){var r=this._state.$iconHolder;switch(e){case"type":!function(e,t,n){var r=e._state;r.$iconHolder.textContent="",r.type&&(r.type=null),r.type=!n||"solid"!==n&&"logo"!==n?"regular":n,void 0!==r.currentName&&e.constructor.getIconSvg(r.currentName,r.type).then((function(e){r.type===n&&(r.$iconHolder.innerHTML=e)})).catch((function(e){console.error("Failed to load icon: "+r.currentName+"\n"+e)}))}(this,0,n);break;case"name":!function(e,t,n){var r=e._state;r.currentName=n,r.$iconHolder.textContent="",n&&void 0!==r.type&&e.constructor.getIconSvg(n,r.type).then((function(e){r.currentName===n&&(r.$iconHolder.innerHTML=e)})).catch((function(e){console.error("Failed to load icon: "+n+"\n"+e)}))}(this,0,n);break;case"color":r.style.fill=n||"";break;case"size":!function(e,t,n){var r=e._state;r.size&&(r.$iconHolder.style.width=r.$iconHolder.style.height="",r.size=r.sizeType=null),n&&!/^(xs|sm|md|lg)$/.test(r.size)&&(r.size=n.trim(),r.$iconHolder.style.width=r.$iconHolder.style.height=r.size)}(this,0,n);break;case"rotate":t&&r.classList.remove("bx-rotate-"+t),n&&r.classList.add("bx-rotate-"+n);break;case"flip":t&&r.classList.remove("bx-flip-"+t),n&&r.classList.add("bx-flip-"+n);break;case"animation":t&&r.classList.remove("bx-"+t),n&&r.classList.add("bx-"+n)}}},{key:"connectedCallback",value:function(){y()&&p.ShadyCSS.styleElement(this)}}]),t}());t.default=v,v.define()}])},e.exports=t()}))},1195:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".div-todo {\n\tdisplay: flex;\n\tbackground-color: bisque;\n}\n.div-izquierda {\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\twidth: 25%;\n}\n\n.div-centro {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\twidth: 50%;\n}\n.div-derecha {\n\tdisplay: flex;\n\twidth: 25%;\n}\n\n@media (max-width: 600px) {\n\t.div-todo {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tbackground-color: bisque;\n\t}\n\t.div-izquierda {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\twidth: 90%;\n\t\torder: 1;\n\t}\n\t.div-centro {\n\t\twidth: 90%;\n\t\torder: 3;\n\t}\n\t.contenedoropinion {\n\t\twidth: 90%;\n\t}\n\t.contenedorpub {\n\t\twidth: 90%;\n\t}\n\t.div-derecha {\n\t\twidth: 90%;\n\t\tjustify-content: center;\n\t\torder: 2;\n\t}\n}\n",""]);const a=o},3442:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,':host {\n    display: block;\n    max-width: 350px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff0f6; /* Fondo rosado claro */\n    border-radius: 10px; /* Bordes redondeados */\n    box-shadow: 0 4px 10px rgba(245, 189, 212, 0.3); /* Sombra sutil */\n    font-family:\'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif /* Fuente divertida */\n}\n\nh2 {\n    text-align: center;\n    color: #ff69b4; /* Color de texto rosado fuerte */\n    font-size: 24px;\n    margin-bottom: 20px;\n}\n\nform {\n    display: flex;\n    flex-direction: column;\n}\n\ninput[type="text"], input[type="password"] {\n    width: 100%;\n    padding: 12px 20px; /* Padding amplio */\n    margin-bottom: 15px; /* Espacio entre campos */\n    border: 2px solid #ffb6c1; /* Borde rosado claro */\n    border-radius: 20px; /* Bordes muy redondeados */\n    outline: none;\n    box-sizing: border-box;\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; /* Fuente divertida */\n    background-color: #fff5f7; /* Fondo rosado muy claro */\n}\n\ninput[type="text"]::placeholder, input[type="password"]::placeholder {\n    color: #ff69b4; /* Color del texto de los placeholders */\n    opacity: 0.7;\n}\n\nbutton[type="submit"], button {\n    width: 100%;\n    padding: 12px 0;\n    background-color: #ff69b4; /* Fondo rosado fuerte */\n    border: none;\n    border-radius: 20px; /* Bordes redondeados */\n    color: white;\n    cursor: pointer;\n    margin-top: 10px; /* Espacio superior */\n    font-size: 18px; /* Tamao de fuente mayor */\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; /* Fuente divertida */\n}\n\nbutton[type="submit"]:hover, button:hover {\n    background-color: #ff85a2; /* Color rosado un poco ms claro al hacer hover */\n}\n\n.footer-links {\n    display: flex;\n    justify-content: space-between;\n    font-size: 14px;\n    margin-top: 15px;\n}\n\n.footer-links a {\n    text-decoration: none;\n    color: #ff69b4; /* Color de texto rosado */\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; /* Fuente divertida */\n}\n\n.footer-links a:hover {\n    text-decoration: underline;\n}\n',""]);const a=o},8290:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,':host {\n    display: block;\n    max-width: 350px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff0f6; /* Fondo rosado claro */\n    border-radius: 10px; /* Bordes redondeados */\n    box-shadow: 0 4px 10px rgba(245, 189, 212, 0.3); /* Sombra sutil */\n    font-family:\'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif /* Fuente divertida */\n}\n\nh2 {\n    text-align: center;\n    color: #ff69b4; /* Color de texto rosado fuerte */\n    font-size: 24px;\n    margin-bottom: 20px;\n}\nform {\n    display: flex;\n    flex-direction: column;\n}\ninput[type="text"], input[type="email"], input[type="password"], input[type="tel"], input[type="date"] {\n    width: 100%;\n    padding: 12px 20px; /* Padding amplio */\n    margin-bottom: 15px; /* Espacio entre campos */\n    border: 2px solid #ffb6c1; /* Borde rosado claro */\n    border-radius: 20px; /* Bordes muy redondeados */\n    outline: none;\n    box-sizing: border-box;\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; /* Fuente divertida */\n    background-color: #fff5f7;\n}\n\ninput[type="submit"] {\n    color: #ff69b4; /* Color del texto de los placeholders */\n    opacity: 0.7;\n}\n\nbutton[type="submit"], button {\n    width: 100%;\n    padding: 12px 0;\n    background-color: #ff69b4; /* Fondo rosado fuerte */\n    border: none;\n    border-radius: 20px; /* Bordes redondeados */\n    color: white;\n    cursor: pointer;\n    margin-top: 10px; /* Espacio superior */\n    font-size: 18px; /* Tamao de fuente mayor */\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; /* Fuente divertida */\n}\n\ninput[type="submit"]:hover {\nbackground-color: #ff85a2;\n}\n\n.footer-links {\n    display: flex;\n    justify-content: center;\n    font-size: 14px;\n    margin-top: 15px;\n}\n\n.footer-links a {\n    text-decoration: none;\n    color: #ff69b4; /* Color de texto rosado */\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; /* Fuente divertida */\n}\n\n.footer-links a:hover {\n    text-decoration: underline;\n}\n           ',""]);const a=o},1358:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"* {\n\tpadding: 0;\n\tmargin: 0;\n\tbox-sizing: border-box;\n}\n\n.csstitulo {\n\tcolor: rgb(0, 0, 0);\n\tmargin: 20px;\n}\n\n.wrapper-tarjeta {\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 400px;\n\theight: auto;\n\tbackground-color: white;\n\tborder-radius: 10%;\n\tmargin-top: 40px;\n}\n\n.ocultar {\n\tdisplay: none;\n}\n\n.mostrar {\n\tdisplay: block;\n}\n#btntoggle {\n\twidth: 100px;\n\theight: 40px;\n\tborder-color: transparent;\n\tbackground-color: white;\n\tborder-radius: 20px;\n\tmargin-left: 20px;\n\tmargin-top: 10px;\n}\n\n@media (max-width: 600px) {\n\t.wrapper-tarjeta {\n\t\twidth: 100%;\n\t}\n}\n",""]);const a=o},4238:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".wrapper-ficha {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n\n@media (max-width: 600px) {\n\t.wrapper-ficha {\n\t\tflex-wrap: wrap;\n\t\tmargin-top: 2rem;\n\t\tmax-height: 270px;\n\t\toverflow-y: hidden;\n\t}\n}\n",""]);const a=o},9886:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".wrapper-opinion {\n\tbackground-color: white;\n\theight: 11rem;\n\twidth: 38rem;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder-radius: 20px;\n\tmargin-bottom: 20px;\n\tmargin-top: 10px;\n}\n\n@media (max-width: 600px) {\n\t.wrapper-opinion {\n\t\twidth: 100%;\n\t\tflex-shrink: 1;\n\t}\n}\n",""]);const a=o},4199:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".fotopfp {\n\tmargin-left: 10px;\n\theight: 70px;\n\twidth: 70px;\n\tborder-radius: 40%;\n}\n.header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tpadding-top: 10px;\n\tpadding-bottom: 10px;\n}\n.publicacion {\n\tbackground-color: black;\n\theight: 20rem;\n\tdisplay: flex;\n}\n#publicacion {\n\tbackground-color: rgb(228, 228, 228);\n\tborder-radius: 20px;\n}\n#seguir2 {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 30px;\n}\n.deshabilitar {\n\tbackground-color: rgb(212, 101, 162) !important;\n\tcolor: rgb(255, 255, 255);\n}\n.margintexto {\n\tmargin-left: 10px;\n\tpadding-bottom: 15px;\n}\n\n.habilitar {\n\tbackground-color: rgb(255, 187, 224) !important;\n\tcolor: black;\n}\n.fotopublic {\n\theight: 500px;\n\twidth: 500px;\n\tobject-fit: cover;\n}\nimg {\n\twidth: 100%;\n\tmax-width: 600px;\n}\n.footer {\n\tdisplay: flex;\n\tjustify-content: space-between;\n}\n@media (max-width: 600px) {\n\t.fotopublic {\n\t\twidth: 100%;\n\t\tobject-fit: cover;\n\t}\n}\n",""]);const a=o},3002:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"* {\n\tpadding: 0;\n\tmargin: 0;\n\tbox-sizing: border-box;\n}\n.wrapper-publicacion {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\twidth: 38rem;\n\tpadding-top: 30px;\n\tborder-radius: 30px;\n\theight: auto;\n\tbackground-color: white;\n}\n@media (max-width: 600px) {\n\t.wrapper-publicacion {\n\t\twidth: 100%;\n\t}\n}\n",""]);const a=o},7662:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".fotopfp {\n\tmargin-left: 10px;\n\theight: 70px;\n\twidth: 70px;\n\tborder-radius: 40%;\n\tmargin-right: 10px;\n}\n.aderopinion {\n\tdisplay: flex;\n\n\twidth: 22rem;\n\tmargin-bottom: 20px;\n}\n.textopinion {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n#write {\n\tborder-color: transparent;\n\tmargin-right: 20px;\n\twidth: 15rem;\n}\n#post {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 30px;\n}\n.deshabilitar {\n\tbackground-color: rgb(212, 101, 162) !important;\n\tcolor: rgb(255, 255, 255);\n}\n.headeropinion {\n\tdisplay: flex;\n\tmargin-bottom: 10px;\n}\n\n.habilitar {\n\tbackground-color: rgb(255, 187, 224) !important;\n\tcolor: black;\n}\n.linea {\n\twidth: 100%;\n\theight: 5px;\n\tbackground-color: pink;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n\tborder-radius: 20px;\n}\n\n@media (max-width: 600px) {\n\t.headeropinion {\n\t\twidth: 100%;\n\t}\n\t#write {\n\t\twidth: auto;\n\t}\n}\n/* lo del modal */\n.contenedorpost {\n\tdisplay: flex;\n\tbackground-color: rgba(255, 232, 195, 0.445);\n\twidth: 100%;\n\theight: 100vh;\n\talign-items: center;\n\tjustify-content: center;\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 1;\n}\n\n.ocultarpost {\n\tdisplay: none;\n}\n\n.mostrarpost {\n\tdisplay: flex;\n}\n\n.formulario {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\talign-items: center;\n\tbackground-color: white;\n\twidth: 50%;\n\theight: 50vh;\n\topacity: 1;\n\tz-index: 10;\n\tborder-radius: 30px;\n}\n#guardar {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 110px;\n\theight: 50px;\n\tborder-radius: 30px;\n\tmargin-top: 15px;\n}\n#cancelar {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 110px;\n\theight: 50px;\n\tborder-radius: 30px;\n\tmargin-top: 15px;\n}\n#imagenpost {\n\twidth: 150px;\n\theight: 20px;\n}\n",""]);const a=o},826:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"body {\n\tmargin: 0;\n\tpadding: 0;\n\tfont-family: Arial, sans-serif;\n\tdisplay: flex;\n\tbackground-color: #ffdbd1;\n}\n\n.etiqueta {\n\tcolor: #fa9ebc;\n}\n\n.texto {\n\tcolor: #570228;\n\tmargin: 0;\n\tfont-size: 15pt;\n}\n\n.sidebar {\n\tbackground-color: white;\n\tpadding: 20px;\n\tbox-sizing: border-box;\n\theight: auto;\n\tmargin-right: 30px;\n\tmargin-top: 50px;\n\tborder-radius: 30px;\n\twidth: 13rem;\n}\n\n.sidebar h2,\n.follow h2 {\n\tmargin-top: 0;\n}\n\n.sidebar ul,\n.follow ul {\n\tlist-style-type: none;\n\tpadding: 0;\n}\n\n.sidebar ul li,\n.follow ul li {\n\tmargin-bottom: 10px;\n}\n\n.sidebar ul li a,\n.follow ul li a {\n\ttext-decoration: none;\n}\n\n.content {\n\tflex: 1;\n\tpadding: 20px;\n\tbox-sizing: border-box;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: flex-start; /* Ajuste para alinear el contenido arriba */\n}\n\n.seguir {\n\tbackground-color: #fa9ebc;\n\tcolor: white;\n\tborder: none;\n\tpadding: 5px 10px;\n\tborder-radius: 5px;\n}\n\n.pequeno {\n\tfont-size: small;\n}\n\n.sugerencias {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n.foto {\n\twidth: 30px; /* Ajusta el tamao de la foto segn sea necesario */\n\theight: 30%; /* Ajusta el tamao de la foto segn sea necesario */\n\tpadding: 0 4% 0% 0%;\n}\n\n.slider {\n\tdisplay: flex;\n\toverflow-x: auto; /* Permite desplazarse horizontalmente */\n}\n\n.slide {\n\tflex: 0 0 auto;\n\tmargin-right: 10px; /* Espacio entre las imgenes */\n}\n\n.menuiconos {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n@media (max-width: 600px) {\n\t* {\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t\tbox-sizing: border-box;\n\t}\n\n\ta {\n\t\tdisplay: none;\n\t}\n\tli {\n\t\tpadding-right: 1rem;\n\t}\n\ti {\n\t\tfont-size: 2rem;\n\t}\n\t.menuiconos {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin-top: 12px;\n\t}\n\t.sidebar {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tflex-direction: column;\n\t\twidth: 100%;\n\t\tmargin-right: 0px;\n\t\tmargin-top: 1rem;\n\t}\n}\n",""]);const a=o},9918:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".pfp {\n\theight: 70px;\n\twidth: 70px;\n\tborder-radius: 40%;\n\tpadding: 0 4% 0% 0%;\n\tborder-radius: 50%;\n\tmargin: 10px;\n}\n\n.slider {\n\tdisplay: flex;\n\toverflow-x: auto; /* Permite desplazarse horizontalmente */\n}\n\n.slide {\n\tflex: 0 0 auto;\n\tmargin-right: 10px; /* Espacio entre las imgenes */\n}\n\n.stories {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n}\n",""]);const a=o},824:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"* {\n\tpadding: 0;\n\tmargin: 0;\n\tbox-sizing: border-box;\n}\n#whoto-container {\n\tmargin-bottom: 10px;\n\tdisplay: flex;\n\twidth: 100%;\n\tjustify-content: space-around;\n\talign-items: center;\n}\n#names {\n\tflex-grow: 10;\n\tdisplay: flex;\n\tmargin-left: 10px;\n\theight: 60px;\n\n\tflex-direction: column;\n\tjustify-content: space-around;\n}\n.foto {\n\tmargin-left: 10px;\n\theight: 70px;\n\twidth: 70px;\n\tborder-radius: 40%;\n}\n#seguir {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 50px;\n}\n.deshabilitar {\n\tbackground-color: rgb(212, 101, 162) !important;\n\tcolor: rgb(255, 255, 255);\n}\n\n.habilitar {\n\tbackground-color: rgb(255, 187, 224) !important;\n\tcolor: black;\n}\n",""]);const a=o},9178:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".fotocuadrado {\n\twidth: 350px;\n\theight: 350px;\n\tmargin-top: 15px;\n\tmargin-right: 15px;\n}\n* {\n\tpadding: 0;\n\tmargin: 0;\n\tbox-sizing: border-box;\n}\n@media (max-width: 600px) {\n\t.fotocuadrado {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 255px;\n\t\theight: 255px;\n\t\tmargin-top: 15px;\n\t}\n}\n",""]);const a=o},6903:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".foto-contenedor {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tflex-wrap: wrap;\n\tbackground-color: white;\n}\n* {\n\tpadding: 0;\n\tmargin: 0;\n\tbox-sizing: border-box;\n}\n",""]);const a=o},3603:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"* {\n\tpadding: 0;\n\tmargin: 0;\n\tbox-sizing: border-box;\n}\n.div-botones {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.div-primero {\n\tbackground-color: bisque;\n\twidth: 100%;\n\theight: 80px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n#alogin {\n\tbackground-color: white;\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 30px;\n}\n#asingup {\n\tbackground-color: white;\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 30px;\n}\n.div-todo {\n\tdisplay: flex;\n\tbackground-color: bisque;\n}\n.div-todo2 {\n\tdisplay: flex;\n\tbackground-color: rgb(254, 175, 78);\n}\n.div-izquierda {\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\twidth: 25%;\n}\n.div-centro {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\twidth: 50%;\n}\n.div-derecha {\n\tdisplay: flex;\n\twidth: 25%;\n}\n\n@media (max-width: 600px) {\n\t.div-todo {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tbackground-color: bisque;\n\t}\n\t.div-izquierda {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\twidth: 90%;\n\t\torder: 1;\n\t}\n\t.div-centro {\n\t\twidth: 90%;\n\t\torder: 3;\n\t}\n\t.contenedoropinion {\n\t\twidth: 90%;\n\t}\n\t.contenedorpub {\n\t\twidth: 90%;\n\t}\n\t.div-derecha {\n\t\twidth: 90%;\n\t\tjustify-content: center;\n\t\torder: 2;\n\t}\n}\n",""]);const a=o},2858:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,'\n.div-fondo {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    width: 100%; \n    max-width: 300px; \n    margin: 0 auto; \n    padding: 20px;\n    background-color: #FAFAFA; \n    border-radius: 8px; \n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); \n    font-family: Arial, sans-serif; \n}\n\nh2 {\n    text-align: center; \n    color: #333; \n    margin-bottom: 20px; \n}\n\ninput[type="text"], input[type="password"] {\n    width: calc(100% - 20px);\n    padding: 10px;\n    margin-bottom: 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\n#botonregreso {\n    width: 100%;\n    padding: 10px;\n    border: none;\n    background-color: #ff85a2;\n    color: white;\n    border-radius: 4px;\n    cursor: pointer;\n    margin-top: 10px;\n}\n\nbutton:hover {\n    background-color: #e76393;\n}\n\n.login-links {\n    text-align: center;\n    margin-top: 10px;\n}\n\n.login-links a {\n    color: #666;\n    text-decoration: none;\n    font-size: 0.9rem;\n}\n\n.login-links a:hover {\n    text-decoration: underline;\n}\n\nlabel {\n    display: block;\n    margin-bottom: 5px;\n}\n\ninput[type="checkbox"] {\n    margin-right: 5px;\n}\n',""]);const a=o},6082:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".div-fondo {\n\theight: 100vh;\n\tdisplay: flex;\n\talign-items: center;\n\tbackground-color: bisque;\n\tflex-direction: column;\n}\n.div-arriba {\n\tdisplay: flex;\n\tbackground-color: white;\n\twidth: 80%;\n}\n.div-fotos {\n\tbackground-color: white;\n\tdisplay: flex;\n\twidth: 80%;\n\tjustify-content: center;\n\talign-items: center;\n}\n.div-arribafoto {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\twidth: 30%;\n}\n.div-arribatexto {\n\twidth: 70%;\n}\n.fotopfp {\n\twidth: 140px;\n\theight: 140px;\n\tborder-radius: 70px;\n}\n.div-arribatextoboton {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n#cerrarperfil {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 30px;\n}\n#editarperfil {\n\tbackground-color: rgb(255, 187, 224);\n\tmargin-right: 15px;\n\tborder-color: transparent;\n\twidth: 85px;\n\theight: 30px;\n\tborder-radius: 30px;\n}\n.div-linea {\n\twidth: 90%;\n\tbackground-color: black;\n\theight: 2px;\n}\n@media (max-width: 600px) {\n\t.fotopfp {\n\t\twidth: 70px;\n\t\theight: 70px;\n\t\tborder-radius: 30px;\n\t\tmargin-top: 10px;\n\t}\n\t.div-arribatextoboton {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 10px;\n\t}\n\t.div-arribatexto {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 70%;\n\t}\n\t.div-arribafoto {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: flex-start;\n\t\twidth: 30%;\n\t}\n}\n",""]);const a=o},6441:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,'.div-fondo {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 20px;\n    background-color: #fff0f6; /* Fondo rosado claro */\n    box-shadow: 0 4px 10px rgba(245, 189, 212, 0.3); /* Sombra rosada */\n    border-radius: 10px; /* Bordes redondeados */\n    width: 100%; /* Ancho completo */\n    max-width: 400px; /* Ancho mximo */\n    margin: 20px auto; /* Centrado */\n   \n}\n\nh2 {\n    text-align: center;\n    color: #ff69b4; /* Color de texto rosado fuerte */\n    font-size: 24px;\n    margin-bottom: 20px;\n}\n\ninput[type="text"], input[type="email"], input[type="password"], input[type="tel"], input[type="date"] {\n    width: 100%;\n    padding: 12px 20px; /* Padding amplio */\n    margin-bottom: 15px; /* Espacio entre campos */\n    border: 2px solid #ffb6c1; /* Borde rosado claro */\n    border-radius: 20px; /* Bordes muy redondeados */\n    outline: none;\n    box-sizing: border-box;\n    font-family: \'Comic Sans MS\', cursive, sans-serif; /* Fuente divertida */\n    background-color: #fff5f7; /* Fondo rosado muy claro */\n}\n\ninput[type="text"]::placeholder, input[type="email"]::placeholder, input[type="password"]::placeholder, input[type="tel"]::placeholder, input[type="date"]::placeholder {\n    color: #ff69b4; /* Color del texto de los placeholders */\n    opacity: 0.7;\n}\n\nbutton[type="submit"] {\n    width: 100%;\n    padding: 12px 0;\n    background-color: #ff69b4; /* Fondo rosado fuerte */\n    border: none;\n    border-radius: 20px; /* Bordes redondeados */\n    color: white;\n    cursor: pointer;\n    margin-top: 20px; /* Espacio superior */\n    font-size: 18px; /* Tamao de fuente mayor */\n    font-family: \'Comic Sans MS\', cursive, sans-serif; /* Fuente divertida */\n}\n\nbutton[type="submit"]:hover {\n    background-color: #ff85a2; /* Color rosado un poco ms claro al hacer hover */\n}\n\n.footer-links {\n    text-align: center;\n    margin-top: 15px;\n}\n\n.footer-links a {\n    text-decoration: none;\n    color: #ff69b4; /* Color de texto rosado */\n    font-size: 14px;\n    font-family: \'Comic Sans MS\', cursive, sans-serif; /* Fuente divertida */\n}\n\n.footer-links a:hover {\n    text-decoration: underline;\n}\n\n.flex-container {\n    display: flex;\n    justify-content: space-between;\n    width: 100%;\n}\n\n.flex-container input {\n    width: 48%; /* Ancho de cada input dentro del contenedor flex */\n}\n',""]);const a=o},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&o[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),t.push(l))}},t}},1601:e=>{"use strict";e.exports=function(e){return e[1]}},5577:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6199);r.registerVersion("firebase","10.9.0","app"),Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},5052:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3301);Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},9815:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1241);Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},2650:(e,t,n)=>{"use strict";var r=n(6336),i=n(6199),s=n(5844),o=n(1635),a=n(5319);const c=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},u=new r.ErrorFactory("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),l=new s.Logger("@firebase/auth");function h(e,...t){l.logLevel<=s.LogLevel.ERROR&&l.error(`Auth (${i.SDK_VERSION}): ${e}`,...t)}function d(e,...t){throw g(e,...t)}function f(e,...t){return g(e,...t)}function p(e,t,n){const i=Object.assign(Object.assign({},c()),{[t]:n});return new r.ErrorFactory("auth","Firebase",i).create(t,{appName:e.name})}function m(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&d(e,"argument-error"),p(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function g(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return u.create(e,...t)}function y(e,t,...n){if(!e)throw g(t,...n)}function v(e){const t="INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function w(e,t){e||v(t)}function b(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function _(){return"http:"===I()||"https:"===I()}function I(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class E{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=r.isMobileCordova()||r.isReactNative()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(_()||r.isBrowserExtension()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function T(e,t){w(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class S{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void v("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void v("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void v("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const C={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},A=new E(3e4,6e4);function x(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function k(e,t,n,i,s={}){return D(e,s,(async()=>{let s={},o={};i&&("GET"===t?o=i:s={body:JSON.stringify(i)});const a=r.querystring(Object.assign({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();return c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode),S.fetch()(O(e,e.config.apiHost,n,a),Object.assign({method:t,headers:c,referrerPolicy:"no-referrer"},s))}))}async function D(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},C),t);try{const t=new R(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw L(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw L(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw L(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw L(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw p(e,a,o);d(e,a)}}catch(t){if(t instanceof r.FirebaseError)throw t;d(e,"network-request-failed",{message:String(t)})}}async function N(e,t,n,r,i={}){const s=await k(e,t,n,r,i);return"mfaPendingCredential"in s&&d(e,"multi-factor-auth-required",{_serverResponse:s}),s}function O(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?T(e.config,i):`${e.config.apiScheme}://${i}`}function P(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class R{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(f(this.auth,"network-request-failed"))),A.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function L(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=f(e,t,r);return i.customData._tokenResponse=n,i}function M(e){return void 0!==e&&void 0!==e.getResponse}function F(e){return void 0!==e&&void 0!==e.enterprise}class U{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return P(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function V(e,t){return k(e,"GET","/v2/recaptchaConfig",x(e,t))}function j(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function q(e,t=!1){const n=r.getModularInstance(e),i=await n.getIdToken(t),s=z(i);y(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:j(B(s.auth_time)),issuedAtTime:j(B(s.iat)),expirationTime:j(B(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function B(e){return 1e3*Number(e)}function z(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return h("JWT malformed, contained fewer than 3 sections"),null;try{const e=r.base64Decode(n);return e?JSON.parse(e):(h("Failed to decode base64 JWT payload"),null)}catch(e){return h("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function G(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof r.FirebaseError&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class H{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class K{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=j(this.lastLoginAt),this.creationTime=j(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function $(e){var t;const n=e.auth,r=await e.getIdToken(),i=await G(e,async function(e,t){return k(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));y(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=o.__rest(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],c=(u=e.providerData,l=a,[...u.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var u,l;const h=e.isAnonymous,d=!(e.email&&s.passwordHash||(null==c?void 0:c.length)),f=!!h&&d,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new K(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(e,p)}async function W(e){const t=r.getModularInstance(e);await $(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}class Q{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){y(e.idToken,"internal-error"),y(void 0!==e.idToken,"internal-error"),y(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=z(e);return y(t,"internal-error"),y(void 0!==t.exp,"internal-error"),y(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return y(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await D(e,{},(async()=>{const n=r.querystring({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=O(e,i,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",S.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Q;return n&&(y("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(y("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(y("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Q,this.toJSON())}_performRefresh(){return v("not implemented")}}function Y(e,t){y("string"==typeof e||void 0===e,"internal-error",{appName:t})}class X{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=o.__rest(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new K(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await G(this,this.stsTokenManager.getToken(this.auth,e));return y(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return q(this,e)}reload(){return W(this)}_assign(e){this!==e&&(y(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new X(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await $(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await G(this,async function(e,t){return k(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:w,emailVerified:b,isAnonymous:_,providerData:I,stsTokenManager:E}=t;y(w&&E,e,"internal-error");const T=Q.fromJSON(this.name,E);y("string"==typeof w,e,"internal-error"),Y(l,e.name),Y(h,e.name),y("boolean"==typeof b,e,"internal-error"),y("boolean"==typeof _,e,"internal-error"),Y(d,e.name),Y(f,e.name),Y(p,e.name),Y(m,e.name),Y(g,e.name),Y(v,e.name);const S=new X({uid:w,auth:e,email:h,emailVerified:b,displayName:l,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:g,lastLoginAt:v});return I&&Array.isArray(I)&&(S.providerData=I.map((e=>Object.assign({},e)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(e,t,n=!1){const r=new Q;r.updateFromServerResponse(t);const i=new X({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await $(i),i}}const J=new Map;function Z(e){w(e instanceof Function,"Expected a class definition");let t=J.get(e);return t?(w(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,J.set(e,t),t)}class ee{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ee.type="NONE";const te=ee;function ne(e,t,n){return`firebase:${e}:${t}:${n}`}class re{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ne(this.userKey,r.apiKey,i),this.fullPersistenceKey=ne("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?X._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new re(Z(te),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Z(te);const s=ne(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=X._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new re(i,e,n)):new re(i,e,n)}}function ie(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ce(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(se(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(le(t))return"Blackberry";if(he(t))return"Webos";if(oe(t))return"Safari";if((t.includes("chrome/")||ae(t))&&!t.includes("edge/"))return"Chrome";if(ue(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function se(e=r.getUA()){return/firefox\//i.test(e)}function oe(e=r.getUA()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ae(e=r.getUA()){return/crios\//i.test(e)}function ce(e=r.getUA()){return/iemobile/i.test(e)}function ue(e=r.getUA()){return/android/i.test(e)}function le(e=r.getUA()){return/blackberry/i.test(e)}function he(e=r.getUA()){return/webos/i.test(e)}function de(e=r.getUA()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function fe(e=r.getUA()){return de(e)||ue(e)||he(e)||le(e)||/windows phone/i.test(e)||ce(e)}function pe(e,t=[]){let n;switch(e){case"Browser":n=ie(r.getUA());break;case"Worker":n=`${ie(r.getUA())}-${e}`;break;default:n=e}const s=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${i.SDK_VERSION}/${s}`}class me{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class ge{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class ye{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new we(this),this.idTokenSubscription=new we(this),this.beforeStateQueue=new me(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Z(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await re.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return y(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?r.getModularInstance(e):null;return t&&y(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&y(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Z(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return k(e,"GET","/v2/passwordPolicy",x(e,t))}(this),t=new ge(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new r.ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return k(e,"POST","/v2/accounts:revokeToken",x(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Z(e)||this._popupRedirectResolver;y(t,this,"argument-error"),this.redirectPersistenceManager=await re.create(this,[Z(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(y(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){l.logLevel<=s.LogLevel.WARN&&l.warn(`Auth (${i.SDK_VERSION}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function ve(e){return r.getModularInstance(e)}class we{constructor(e){this.auth=e,this.observer=null,this.addObserver=r.createSubscribe((e=>this.observer=e))}get next(){return y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let be={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _e(e){return be.loadJS(e)}function Ie(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Ee{constructor(e){this.type="recaptcha-enterprise",this.auth=ve(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;F(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{V(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new U(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&F(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=be.recaptchaEnterpriseScript;0!==t.length&&(t+=i),_e(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Te(e,t,n,r=!1){const i=new Ee(e);let s;try{s=await i.verify(n)}catch(e){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Se(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Te(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Te(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Ce(e,t){const n=i._getProvider(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),i=n.getOptions();if(r.deepEqual(i,null!=t?t:{}))return e;d(e,"already-initialized")}return n.initialize({options:t})}function Ae(e,t,n){const r=ve(e);y(r._canInitEmulator,r,"emulator-config-failed"),y(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=xe(t),{host:o,port:a}=function(e){const t=xe(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:ke(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ke(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function xe(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ke(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class De{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return v("not implemented")}_getIdTokenResponse(e){return v("not implemented")}_linkToIdToken(e,t){return v("not implemented")}_getReauthenticationResolver(e){return v("not implemented")}}async function Ne(e,t){return k(e,"POST","/v1/accounts:resetPassword",x(e,t))}async function Oe(e,t){return k(e,"POST","/v1/accounts:signUp",t)}async function Pe(e,t){return N(e,"POST","/v1/accounts:signInWithPassword",x(e,t))}async function Re(e,t){return k(e,"POST","/v1/accounts:sendOobCode",x(e,t))}async function Le(e,t){return Re(e,t)}async function Me(e,t){return Re(e,t)}class Fe extends De{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Fe(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Fe(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Se(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Pe);case"emailLink":return async function(e,t){return N(e,"POST","/v1/accounts:signInWithEmailLink",x(e,t))}(e,{email:this._email,oobCode:this._password});default:d(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Se(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Oe);case"emailLink":return async function(e,t){return N(e,"POST","/v1/accounts:signInWithEmailLink",x(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:d(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ue(e,t){return N(e,"POST","/v1/accounts:signInWithIdp",x(e,t))}class Ve extends De{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ve(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):d("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=o.__rest(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Ve(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ue(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ue(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ue(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=r.querystring(t)}return e}}const je={USER_NOT_FOUND:"user-not-found"};class qe extends De{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new qe({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new qe({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return N(e,"POST","/v1/accounts:signInWithPhoneNumber",x(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await N(e,"POST","/v1/accounts:signInWithPhoneNumber",x(e,t));if(n.temporaryProof)throw L(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return N(e,"POST","/v1/accounts:signInWithPhoneNumber",x(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),je)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new qe({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Be{constructor(e){var t,n,i,s,o,a;const c=r.querystringDecode(r.extractQuerystring(e)),u=null!==(t=c.apiKey)&&void 0!==t?t:null,l=null!==(n=c.oobCode)&&void 0!==n?n:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);y(u&&l&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=l,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=r.querystringDecode(r.extractQuerystring(e)).link,n=t?r.querystringDecode(r.extractQuerystring(t)).deep_link_id:null,i=r.querystringDecode(r.extractQuerystring(e)).deep_link_id;return(i?r.querystringDecode(r.extractQuerystring(i)).link:null)||i||n||t||e}(e);try{return new Be(t)}catch(e){return null}}}class ze{constructor(){this.providerId=ze.PROVIDER_ID}static credential(e,t){return Fe._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Be.parseLink(t);return y(n,"argument-error"),Fe._fromEmailAndCode(e,n.code,n.tenantId)}}ze.PROVIDER_ID="password",ze.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ze.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ge{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class He extends Ge{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ke extends He{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return y("providerId"in t&&"signInMethod"in t,"argument-error"),Ve._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return y(e.idToken||e.accessToken,"argument-error"),Ve._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ke.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ke.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new Ke(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:i})}catch(e){return null}}}class $e extends He{constructor(){super("facebook.com")}static credential(e){return Ve._fromParams({providerId:$e.PROVIDER_ID,signInMethod:$e.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $e.credentialFromTaggedObject(e)}static credentialFromError(e){return $e.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return $e.credential(e.oauthAccessToken)}catch(e){return null}}}$e.FACEBOOK_SIGN_IN_METHOD="facebook.com",$e.PROVIDER_ID="facebook.com";class We extends He{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ve._fromParams({providerId:We.PROVIDER_ID,signInMethod:We.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return We.credentialFromTaggedObject(e)}static credentialFromError(e){return We.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return We.credential(t,n)}catch(e){return null}}}We.GOOGLE_SIGN_IN_METHOD="google.com",We.PROVIDER_ID="google.com";class Qe extends He{constructor(){super("github.com")}static credential(e){return Ve._fromParams({providerId:Qe.PROVIDER_ID,signInMethod:Qe.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qe.credentialFromTaggedObject(e)}static credentialFromError(e){return Qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Qe.credential(e.oauthAccessToken)}catch(e){return null}}}Qe.GITHUB_SIGN_IN_METHOD="github.com",Qe.PROVIDER_ID="github.com";class Ye extends De{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Ue(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ue(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ue(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Ye(n,i):null}static _create(e,t){return new Ye(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Xe extends Ge{constructor(e){y(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return Xe.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Xe.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Ye.fromJSON(e);return y(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Ye._create(n,t)}catch(e){return null}}}class Je extends He{constructor(){super("twitter.com")}static credential(e,t){return Ve._fromParams({providerId:Je.PROVIDER_ID,signInMethod:Je.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Je.credentialFromTaggedObject(e)}static credentialFromError(e){return Je.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Je.credential(t,n)}catch(e){return null}}}async function Ze(e,t){return N(e,"POST","/v1/accounts:signUp",x(e,t))}Je.TWITTER_SIGN_IN_METHOD="twitter.com",Je.PROVIDER_ID="twitter.com";class et{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await X._fromIdTokenResponse(e,n,r),s=tt(n);return new et({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=tt(n);return new et({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function tt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class nt extends r.FirebaseError{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,nt.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new nt(e,t,n,r)}}function rt(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw nt._fromErrorAndOperation(e,n,t,r);throw n}))}function it(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}async function st(e,t,n=!1){const r=await G(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return et._forOperation(e,"link",r)}async function ot(e,t,n){await $(t);const r=!1===e?"provider-already-linked":"no-such-provider";y(it(t.providerData).has(n)===e,t.auth,r)}async function at(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await G(e,rt(r,i,t,e),n);y(s.idToken,r,"internal-error");const o=z(s.idToken);y(o,r,"internal-error");const{sub:a}=o;return y(e.uid===a,r,"user-mismatch"),et._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&d(r,"user-mismatch"),e}}async function ct(e,t,n=!1){const r="signIn",i=await rt(e,r,t),s=await et._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function ut(e,t){return ct(ve(e),t)}async function lt(e,t){const n=r.getModularInstance(e);return await ot(!1,n,t.providerId),st(n,t)}async function ht(e,t){return at(r.getModularInstance(e),t)}class dt{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?ft._fromServerResponse(e,t):"totpInfo"in t?pt._fromServerResponse(e,t):d(e,"internal-error")}}class ft extends dt{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new ft(t)}}class pt extends dt{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new pt(t)}}function mt(e,t,n){var r;y((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),y(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(y(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(y(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function gt(e){const t=ve(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function yt(e,t){const n=r.getModularInstance(e),i=await Ne(n,{oobCode:t}),s=i.requestType;switch(y(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":y(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":y(i.mfaInfo,n,"internal-error");default:y(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=dt._fromServerResponse(ve(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function vt(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await G(e,async function(e,t){return k(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(s,!0)}class wt{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class bt extends wt{constructor(e,t,n,r){super(e,t,n),this.username=r}}class _t extends wt{constructor(e,t){super(e,"facebook.com",t)}}class It extends bt{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class Et extends wt{constructor(e,t){super(e,"google.com",t)}}class Tt extends bt{constructor(e,t,n){super(e,"twitter.com",t,n)}}function St(e,t,n,i){return r.getModularInstance(e).onIdTokenChanged(t,n,i)}function Ct(e,t,n){return r.getModularInstance(e).beforeAuthStateChanged(t,n)}class At{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new At("enroll",e,t)}static _fromMfaPendingCredential(e){return new At("signin",e)}toJSON(){const e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return At._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return At._fromIdtoken(e.multiFactorSession.idToken)}return null}}class xt{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=ve(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map((e=>dt._fromServerResponse(n,e)));y(r.mfaPendingCredential,n,"internal-error");const s=At._fromMfaPendingCredential(r.mfaPendingCredential);return new xt(s,i,(async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await et._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return y(t.user,n,"internal-error"),et._forOperation(t.user,t.operationType,o);default:d(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class kt{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>dt._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new kt(e)}async getSession(){return At._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await G(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await G(this.user,(r=this.user.auth,i={idToken:n,mfaEnrollmentId:t},k(r,"POST","/v2/accounts/mfaEnrollment:withdraw",x(r,i))));this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}var r,i}}const Dt=new WeakMap,Nt="__sak";class Ot{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nt,"1"),this.storage.removeItem(Nt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Pt extends Ot{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=r.getUA();return oe(e)||de(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=fe(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);r.isIE()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Pt.type="LOCAL";const Rt=Pt;class Lt extends Ot{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Lt.type="SESSION";const Mt=Lt;class Ft{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ft(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ut(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Ft.receivers=[];class Vt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Ut("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function jt(){return window}function qt(){return void 0!==jt().WorkerGlobalScope&&"function"==typeof jt().importScripts}const Bt="firebaseLocalStorageDb",zt="firebaseLocalStorage",Gt="fbase_key";class Ht{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Kt(e,t){return e.transaction([zt],t?"readwrite":"readonly").objectStore(zt)}function $t(){const e=indexedDB.open(Bt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(zt,{keyPath:Gt})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(zt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Bt);return new Ht(e).toPromise()}(),t(await $t()))}))}))}async function Wt(e,t,n){const r=Kt(e,!0).put({[Gt]:t,value:n});return new Ht(r).toPromise()}function Qt(e,t){const n=Kt(e,!0).delete(t);return new Ht(n).toPromise()}class Yt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await $t()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ft._getInstance(qt()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Vt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $t();return await Wt(e,Nt,"1"),await Qt(e,Nt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Wt(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Kt(e,!1).get(t),r=await new Ht(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Qt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Kt(e,!1).getAll();return new Ht(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Yt.type="LOCAL";const Xt=Yt,Jt=1e12;class Zt{constructor(e){this.auth=e,this.counter=Jt,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new en(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Jt;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Jt;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Jt;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class en{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;y(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let e=0;e<50;e++)t.push(n.charAt(Math.floor(62*Math.random())));return t.join("")}();const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const tn=Ie("rcb"),nn=new E(3e4,6e4);class rn{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=jt().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return y(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&M(jt().grecaptcha)?Promise.resolve(jt().grecaptcha):new Promise(((n,i)=>{const s=jt().setTimeout((()=>{i(f(e,"network-request-failed"))}),nn.get());jt()[tn]=()=>{jt().clearTimeout(s),delete jt()[tn];const r=jt().grecaptcha;if(!r||!M(r))return void i(f(e,"internal-error"));const o=r.render;r.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(r)},_e(`${be.recaptchaV2Script}?${r.querystring({onload:tn,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(s),i(f(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=jt().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class sn{async load(e){return new Zt(e)}clearedOneInstance(){}}const on="recaptcha",an={theme:"light",type:"image"};class cn{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=qe._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function un(e,t,n){var r;const i=await n.verify();try{let s;if(y("string"==typeof i,e,"argument-error"),y(n.type===on,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){y("enroll"===t.type,e,"internal-error");const n=await function(e,t){return k(e,"POST","/v2/accounts/mfaEnrollment:start",x(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{y("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;y(n,e,"missing-multi-factor-info");const o=await function(e,t){return k(e,"POST","/v2/accounts/mfaSignIn:start",x(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return k(e,"POST","/v1/accounts:sendVerificationCode",x(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class ln{constructor(e){this.providerId=ln.PROVIDER_ID,this.auth=ve(e)}verifyPhoneNumber(e,t){return un(this.auth,e,r.getModularInstance(t))}static credential(e,t){return qe._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ln.credentialFromTaggedObject(t)}static credentialFromError(e){return ln.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?qe._fromTokenResponse(t,n):null}}function hn(e,t){return t?Z(t):(y(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ln.PROVIDER_ID="phone",ln.PHONE_SIGN_IN_METHOD="phone";class dn extends De{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ue(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ue(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ue(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function fn(e){return ct(e.auth,new dn(e),e.bypassAuthState)}function pn(e){const{auth:t,user:n}=e;return y(n,t,"internal-error"),at(n,new dn(e),e.bypassAuthState)}async function mn(e){const{auth:t,user:n}=e;return y(n,t,"internal-error"),st(n,new dn(e),e.bypassAuthState)}class gn{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fn;case"linkViaPopup":case"linkViaRedirect":return mn;case"reauthViaPopup":case"reauthViaRedirect":return pn;default:d(this.auth,"internal-error")}}resolve(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yn=new E(2e3,1e4);class vn extends gn{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,vn.currentPopupAction&&vn.currentPopupAction.cancel(),vn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return y(e,this.auth,"internal-error"),e}async onExecution(){w(1===this.filter.length,"Popup operations only handle one event");const e=Ut();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(f(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(f(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(f(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,yn.get())};e()}}vn.currentPopupAction=null;const wn="pendingRedirect",bn=new Map;class _n extends gn{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=bn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Sn(t),r=Tn(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}bn.set(this.auth._key(),e)}return this.bypassAuthState||bn.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function In(e,t){return Tn(e)._set(Sn(t),"true")}function En(e,t){bn.set(e._key(),t)}function Tn(e){return Z(e._redirectPersistence)}function Sn(e){return ne(wn,e.config.apiKey,e.name)}async function Cn(e,t,n=!1){const r=ve(e),i=hn(r,t),s=new _n(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function An(e){const t=Ut(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class xn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Dn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Dn(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(f(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(kn(e))}saveEventToCache(e){this.cachedEventUids.add(kn(e)),this.lastProcessedEventTime=Date.now()}}function kn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Dn({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function Nn(e,t={}){return k(e,"GET","/v1/projects",t)}const On=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Pn=/^https?/;function Rn(e){const t=b(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Pn.test(n))return!1;if(On.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Ln=new E(3e4,6e4);function Mn(){const e=jt().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function Fn(e){return new Promise(((t,n)=>{var r,i,s;function o(){Mn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Mn(),n(f(e,"network-request-failed"))},timeout:Ln.get()})}if(null===(i=null===(r=jt().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=jt().gapi)||void 0===s?void 0:s.load)){const t=Ie("iframefcb");return jt()[t]=()=>{gapi.load?o():n(f(e,"network-request-failed"))},_e(`${be.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Un=null,e}))}let Un=null;const Vn=new E(5e3,15e3),jn="__/auth/iframe",qn="emulator/auth/iframe",Bn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Gn(e){const t=e.config;y(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?T(t,qn):`https://${e.config.authDomain}/${jn}`,s={apiKey:t.apiKey,appName:e.name,v:i.SDK_VERSION},o=zn.get(e.config.apiHost);o&&(s.eid=o);const a=e._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${r.querystring(s).slice(1)}`}const Hn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Kn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const $n=encodeURIComponent("fac");async function Wn(e,t,n,s,o,a){y(e.config.authDomain,e,"auth-domain-config-required"),y(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:i.SDK_VERSION,eventId:o};if(t instanceof Ge){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",r.isEmpty(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(t instanceof He){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];const l=await e._getAppCheckToken(),h=l?`#${$n}=${encodeURIComponent(l)}`:"";return`${function({config:e}){return e.emulator?T(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${r.querystring(u).slice(1)}${h}`}const Qn="webStorageSupport",Yn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Mt,this._completeRedirectFn=Cn,this._overrideRedirectResult=En}async _openPopup(e,t,n,i){var s;return w(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Hn),{width:i.toString(),height:s.toString(),top:o,left:a}),l=r.getUA().toLowerCase();n&&(c=ae(l)?"_blank":n),se(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=r.getUA()){var t;return de(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Kn(null);const d=window.open(t||"",c,h);y(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Kn(d)}(e,await Wn(e,t,n,b(),i),Ut())}async _openRedirect(e,t,n,r){return await this._originValidation(e),i=await Wn(e,t,n,b(),r),jt().location.href=i,new Promise((()=>{}));var i}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(w(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return Un=Un||Fn(e),Un}(e),n=jt().gapi;return y(n,e,"internal-error"),t.open({where:document.body,url:Gn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Bn,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=f(e,"network-request-failed"),s=jt().setTimeout((()=>{r(i)}),Vn.get());function o(){jt().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new xn(e);return t.register("authEvent",(t=>(y(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qn,{type:Qn},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[Qn];void 0!==i&&t(!!i),d(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Nn(e);for(const e of t)try{if(Rn(e))return}catch(e){}d(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fe()||oe()||de()}};class Xn{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return v("unexpected MultiFactorSessionType")}}}class Jn extends Xn{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Jn(e)}_finalizeEnroll(e,t,n){return function(e,t){return k(e,"POST","/v2/accounts/mfaEnrollment:finalize",x(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return k(e,"POST","/v2/accounts/mfaSignIn:finalize",x(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Zn{constructor(){}static assertion(e){return Jn._fromCredential(e)}}Zn.FACTOR_ID="phone";class er{static assertionForEnrollment(e,t){return tr._fromSecret(e,t)}static assertionForSignIn(e,t){return tr._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const n=e;y(void 0!==(null===(t=n.user)||void 0===t?void 0:t.auth),"internal-error");const r=await(i=n.user.auth,s={idToken:n.credential,totpEnrollmentInfo:{}},k(i,"POST","/v2/accounts/mfaEnrollment:start",x(i,s)));var i,s;return nr._fromStartTotpMfaEnrollmentResponse(r,n.user.auth)}}er.FACTOR_ID="totp";class tr extends Xn{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new tr(t,void 0,e)}static _fromEnrollmentId(e,t){return new tr(t,e)}async _finalizeEnroll(e,t,n){return y(void 0!==this.secret,e,"argument-error"),function(e,t){return k(e,"POST","/v2/accounts/mfaEnrollment:finalize",x(e,t))}(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){y(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");const n={verificationCode:this.otp};return function(e,t){return k(e,"POST","/v2/accounts/mfaSignIn:finalize",x(e,t))}(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}}class nr{constructor(e,t,n,r,i,s,o){this.sessionInfo=s,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=r,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new nr(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var n;let r=!1;return(rr(e)||rr(t))&&(r=!0),r&&(rr(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),rr(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function rr(e){return void 0===e||0===(null==e?void 0:e.length)}var ir="@firebase/auth",sr="1.6.2";class or{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ar=r.getExperimentalSetting("authIdTokenMaxAge")||300;let cr=null;var ur;be={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=f("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},ur="Browser",i._registerComponent(new a.Component("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;y(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:ur,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pe(ur)},c=new ye(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Z);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),i._registerComponent(new a.Component("auth-internal",(e=>{return t=ve(e.getProvider("auth").getImmediate()),new or(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),i.registerVersion(ir,sr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(ur)),i.registerVersion(ir,sr,"cjs2017"),t.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"},t.ActionCodeOperation={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"},t.ActionCodeURL=Be,t.AuthCredential=De,t.AuthEventManager=xn,t.AuthImpl=ye,t.AuthPopup=Kn,t.EmailAuthCredential=Fe,t.EmailAuthProvider=ze,t.FacebookAuthProvider=$e,t.FactorId={PHONE:"phone",TOTP:"totp"},t.FetchProvider=S,t.GithubAuthProvider=Qe,t.GoogleAuthProvider=We,t.OAuthCredential=Ve,t.OAuthProvider=Ke,t.OperationType={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},t.PhoneAuthCredential=qe,t.PhoneAuthProvider=ln,t.PhoneMultiFactorGenerator=Zn,t.ProviderId={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},t.RecaptchaVerifier=class{constructor(e,t,n=Object.assign({},an)){this.parameters=n,this.type=on,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ve(e),this.isInvisible="invisible"===this.parameters.size,y("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof t?document.getElementById(t):t;y(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new sn:new rn,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha();return t.getResponse(e)||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){y(!this.parameters.sitekey,this.auth,"argument-error"),y(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),y("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=jt()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){y(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){y(_()&&!qt(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await k(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);y(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return y(this.recaptcha,this.auth,"internal-error"),this.recaptcha}},t.SAMLAuthCredential=Ye,t.SAMLAuthProvider=Xe,t.SignInMethod={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},t.TotpMultiFactorGenerator=er,t.TotpSecret=nr,t.TwitterAuthProvider=Je,t.UserImpl=X,t._assert=y,t._castAuth=ve,t._clearRedirectOutcomes=function(){bn.clear()},t._createError=f,t._fail=d,t._generateEventId=Ut,t._getClientVersion=pe,t._getInstance=Z,t._getProjectConfig=Nn,t._getRedirectResult=Cn,t._getRedirectUrl=Wn,t._isAndroid=ue,t._isIOS=de,t._isIOS7Or8=function(e=r.getUA()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)},t._overrideRedirectResult=En,t._persistenceKeyName=ne,t.applyActionCode=async function(e,t){await async function(e,t){return k(e,"POST","/v1/accounts:update",x(e,t))}(r.getModularInstance(e),{oobCode:t})},t.beforeAuthStateChanged=Ct,t.browserLocalPersistence=Rt,t.browserPopupRedirectResolver=Yn,t.browserSessionPersistence=Mt,t.checkActionCode=yt,t.confirmPasswordReset=async function(e,t,n){await Ne(r.getModularInstance(e),{oobCode:t,newPassword:n}).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&gt(e),t}))},t.connectAuthEmulator=Ae,t.createUserWithEmailAndPassword=async function(e,t,n){const r=ve(e),i=Se(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ze),s=await i.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&gt(e),t})),o=await et._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o},t.debugAssert=w,t.debugErrorMap=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},t.deleteUser=async function(e){return r.getModularInstance(e).delete()},t.fetchSignInMethodsForEmail=async function(e,t){const n={identifier:t,continueUri:_()?b():"http://localhost"},{signinMethods:i}=await async function(e,t){return k(e,"POST","/v1/accounts:createAuthUri",x(e,t))}(r.getModularInstance(e),n);return i||[]},t.getAdditionalUserInfo=function(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=z(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new wt(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new _t(s,i);case"github.com":return new It(s,i);case"google.com":return new Et(s,i);case"twitter.com":return new Tt(s,i,e.screenName||null);case"custom":case"anonymous":return new wt(s,null);default:return new wt(s,r,i)}}(n)},t.getAuth=function(e=i.getApp()){const t=i._getProvider(e,"auth");if(t.isInitialized())return t.getImmediate();const n=Ce(e,{popupRedirectResolver:Yn,persistence:[Xt,Rt,Mt]}),s=r.getExperimentalSetting("authTokenSyncURL");if(s&&s.match(/^\/[^\/].*/)){const e=(o=s,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ar)return;const r=null==t?void 0:t.token;cr!==r&&(cr=r,await fetch(o,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});Ct(n,e,(()=>e(n.currentUser))),St(n,(t=>e(t)))}var o;const a=r.getDefaultEmulatorHost("auth");return a&&Ae(n,`http://${a}`),n},t.getIdToken=function(e,t=!1){return r.getModularInstance(e).getIdToken(t)},t.getIdTokenResult=q,t.getMultiFactorResolver=function(e,t){var n;const i=r.getModularInstance(e),s=t;return y(t.customData.operationType,i,"argument-error"),y(null===(n=s.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),xt._fromError(i,s)},t.getRedirectResult=async function(e,t){return await ve(e)._initializationPromise,Cn(e,t,!1)},t.inMemoryPersistence=te,t.indexedDBLocalPersistence=Xt,t.initializeAuth=Ce,t.initializeRecaptchaConfig=function(e){return async function(e){const t=ve(e),n=await V(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new U(n);null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new Ee(t).verify()}(e)},t.isSignInWithEmailLink=function(e,t){const n=Be.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)},t.linkWithCredential=lt,t.linkWithPhoneNumber=async function(e,t,n){const i=r.getModularInstance(e);await ot(!1,i,"phone");const s=await un(i.auth,t,r.getModularInstance(n));return new cn(s,(e=>lt(i,e)))},t.linkWithPopup=async function(e,t,n){const i=r.getModularInstance(e);m(i.auth,t,Ge);const s=hn(i.auth,n);return new vn(i.auth,"linkViaPopup",t,s,i).executeNotNull()},t.linkWithRedirect=function(e,t,n){return async function(e,t,n){const i=r.getModularInstance(e);m(i.auth,t,Ge),await i.auth._initializationPromise;const s=hn(i.auth,n);await ot(!1,i,t.providerId),await In(s,i.auth);const o=await An(i);return s._openRedirect(i.auth,t,"linkViaRedirect",o)}(e,t,n)},t.multiFactor=function(e){const t=r.getModularInstance(e);return Dt.has(t)||Dt.set(t,kt._fromUser(t)),Dt.get(t)},t.onAuthStateChanged=function(e,t,n,i){return r.getModularInstance(e).onAuthStateChanged(t,n,i)},t.onIdTokenChanged=St,t.parseActionCodeURL=function(e){return Be.parseLink(e)},t.prodErrorMap=c,t.reauthenticateWithCredential=ht,t.reauthenticateWithPhoneNumber=async function(e,t,n){const i=r.getModularInstance(e),s=await un(i.auth,t,r.getModularInstance(n));return new cn(s,(e=>ht(i,e)))},t.reauthenticateWithPopup=async function(e,t,n){const i=r.getModularInstance(e);m(i.auth,t,Ge);const s=hn(i.auth,n);return new vn(i.auth,"reauthViaPopup",t,s,i).executeNotNull()},t.reauthenticateWithRedirect=function(e,t,n){return async function(e,t,n){const i=r.getModularInstance(e);m(i.auth,t,Ge),await i.auth._initializationPromise;const s=hn(i.auth,n);await In(s,i.auth);const o=await An(i);return s._openRedirect(i.auth,t,"reauthViaRedirect",o)}(e,t,n)},t.reload=W,t.revokeAccessToken=function(e,t){return ve(e).revokeAccessToken(t)},t.sendEmailVerification=async function(e,t){const n=r.getModularInstance(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&mt(n.auth,i,t);const{email:s}=await async function(e,t){return Re(e,t)}(n.auth,i);s!==e.email&&await e.reload()},t.sendPasswordResetEmail=async function(e,t,n){const r=ve(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&mt(r,i,n),await Se(r,i,"getOobCode",Le)},t.sendSignInLinkToEmail=async function(e,t,n){const r=ve(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){y(t.handleCodeInApp,r,"argument-error"),t&&mt(r,e,t)}(i,n),await Se(r,i,"getOobCode",Me)},t.setPersistence=function(e,t){return r.getModularInstance(e).setPersistence(t)},t.signInAnonymously=async function(e){var t;const n=ve(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new et({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Ze(n,{returnSecureToken:!0}),i=await et._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i},t.signInWithCredential=ut,t.signInWithCustomToken=async function(e,t){const n=ve(e),r=await async function(e,t){return N(e,"POST","/v1/accounts:signInWithCustomToken",x(e,t))}(n,{token:t,returnSecureToken:!0}),i=await et._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i},t.signInWithEmailAndPassword=function(e,t,n){return ut(r.getModularInstance(e),ze.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&gt(e),t}))},t.signInWithEmailLink=async function(e,t,n){const i=r.getModularInstance(e),s=ze.credentialWithLink(t,n||b());return y(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),ut(i,s)},t.signInWithPhoneNumber=async function(e,t,n){const i=ve(e),s=await un(i,t,r.getModularInstance(n));return new cn(s,(e=>ut(i,e)))},t.signInWithPopup=async function(e,t,n){const r=ve(e);m(e,t,Ge);const i=hn(r,n);return new vn(r,"signInViaPopup",t,i).executeNotNull()},t.signInWithRedirect=function(e,t,n){return async function(e,t,n){const r=ve(e);m(e,t,Ge),await r._initializationPromise;const i=hn(r,n);return await In(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)},t.signOut=function(e){return r.getModularInstance(e).signOut()},t.unlink=async function(e,t){const n=r.getModularInstance(e);await ot(!0,n,t);const{providerUserInfo:i}=await async function(e,t){return k(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=it(i||[]);return n.providerData=n.providerData.filter((e=>s.has(e.providerId))),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n},t.updateCurrentUser=function(e,t){return r.getModularInstance(e).updateCurrentUser(t)},t.updateEmail=function(e,t){return vt(r.getModularInstance(e),t,null)},t.updatePassword=function(e,t){return vt(r.getModularInstance(e),null,t)},t.updatePhoneNumber=async function(e,t){await st(r.getModularInstance(e),t)},t.updateProfile=async function(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const i=r.getModularInstance(e),s={idToken:await i.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},o=await G(i,async function(e,t){return k(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find((({providerId:e})=>"password"===e));a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)},t.useDeviceLanguage=function(e){r.getModularInstance(e).useDeviceLanguage()},t.validatePassword=async function(e,t){return ve(e).validatePassword(t)},t.verifyBeforeUpdateEmail=async function(e,t,n){const i=r.getModularInstance(e),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&mt(i.auth,s,n);const{email:o}=await async function(e,t){return Re(e,t)}(i.auth,s);o!==e.email&&await e.reload()},t.verifyPasswordResetCode=async function(e,t){const{data:n}=await yt(r.getModularInstance(e),t);return n.email}},3301:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2650);n(6336),n(6199),n(5844),n(1635),n(5319),t.ActionCodeOperation=r.ActionCodeOperation,t.ActionCodeURL=r.ActionCodeURL,t.AuthCredential=r.AuthCredential,t.AuthErrorCodes=r.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY,t.EmailAuthCredential=r.EmailAuthCredential,t.EmailAuthProvider=r.EmailAuthProvider,t.FacebookAuthProvider=r.FacebookAuthProvider,t.FactorId=r.FactorId,t.GithubAuthProvider=r.GithubAuthProvider,t.GoogleAuthProvider=r.GoogleAuthProvider,t.OAuthCredential=r.OAuthCredential,t.OAuthProvider=r.OAuthProvider,t.OperationType=r.OperationType,t.PhoneAuthCredential=r.PhoneAuthCredential,t.PhoneAuthProvider=r.PhoneAuthProvider,t.PhoneMultiFactorGenerator=r.PhoneMultiFactorGenerator,t.ProviderId=r.ProviderId,t.RecaptchaVerifier=r.RecaptchaVerifier,t.SAMLAuthProvider=r.SAMLAuthProvider,t.SignInMethod=r.SignInMethod,t.TotpMultiFactorGenerator=r.TotpMultiFactorGenerator,t.TotpSecret=r.TotpSecret,t.TwitterAuthProvider=r.TwitterAuthProvider,t.applyActionCode=r.applyActionCode,t.beforeAuthStateChanged=r.beforeAuthStateChanged,t.browserLocalPersistence=r.browserLocalPersistence,t.browserPopupRedirectResolver=r.browserPopupRedirectResolver,t.browserSessionPersistence=r.browserSessionPersistence,t.checkActionCode=r.checkActionCode,t.confirmPasswordReset=r.confirmPasswordReset,t.connectAuthEmulator=r.connectAuthEmulator,t.createUserWithEmailAndPassword=r.createUserWithEmailAndPassword,t.debugErrorMap=r.debugErrorMap,t.deleteUser=r.deleteUser,t.fetchSignInMethodsForEmail=r.fetchSignInMethodsForEmail,t.getAdditionalUserInfo=r.getAdditionalUserInfo,t.getAuth=r.getAuth,t.getIdToken=r.getIdToken,t.getIdTokenResult=r.getIdTokenResult,t.getMultiFactorResolver=r.getMultiFactorResolver,t.getRedirectResult=r.getRedirectResult,t.inMemoryPersistence=r.inMemoryPersistence,t.indexedDBLocalPersistence=r.indexedDBLocalPersistence,t.initializeAuth=r.initializeAuth,t.initializeRecaptchaConfig=r.initializeRecaptchaConfig,t.isSignInWithEmailLink=r.isSignInWithEmailLink,t.linkWithCredential=r.linkWithCredential,t.linkWithPhoneNumber=r.linkWithPhoneNumber,t.linkWithPopup=r.linkWithPopup,t.linkWithRedirect=r.linkWithRedirect,t.multiFactor=r.multiFactor,t.onAuthStateChanged=r.onAuthStateChanged,t.onIdTokenChanged=r.onIdTokenChanged,t.parseActionCodeURL=r.parseActionCodeURL,t.prodErrorMap=r.prodErrorMap,t.reauthenticateWithCredential=r.reauthenticateWithCredential,t.reauthenticateWithPhoneNumber=r.reauthenticateWithPhoneNumber,t.reauthenticateWithPopup=r.reauthenticateWithPopup,t.reauthenticateWithRedirect=r.reauthenticateWithRedirect,t.reload=r.reload,t.revokeAccessToken=r.revokeAccessToken,t.sendEmailVerification=r.sendEmailVerification,t.sendPasswordResetEmail=r.sendPasswordResetEmail,t.sendSignInLinkToEmail=r.sendSignInLinkToEmail,t.setPersistence=r.setPersistence,t.signInAnonymously=r.signInAnonymously,t.signInWithCredential=r.signInWithCredential,t.signInWithCustomToken=r.signInWithCustomToken,t.signInWithEmailAndPassword=r.signInWithEmailAndPassword,t.signInWithEmailLink=r.signInWithEmailLink,t.signInWithPhoneNumber=r.signInWithPhoneNumber,t.signInWithPopup=r.signInWithPopup,t.signInWithRedirect=r.signInWithRedirect,t.signOut=r.signOut,t.unlink=r.unlink,t.updateCurrentUser=r.updateCurrentUser,t.updateEmail=r.updateEmail,t.updatePassword=r.updatePassword,t.updatePhoneNumber=r.updatePhoneNumber,t.updateProfile=r.updateProfile,t.useDeviceLanguage=r.useDeviceLanguage,t.validatePassword=r.validatePassword,t.verifyBeforeUpdateEmail=r.verifyBeforeUpdateEmail,t.verifyPasswordResetCode=r.verifyPasswordResetCode},4205:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LoginComponent=void 0;const s=i(n(3442)),o=n(2482),a=n(155),c=n(594),u=n(6164);class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.render()}connectedCallback(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#botonregreso");null==t||t.addEventListener("click",(()=>{var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("form"))||void 0===t||t.addEventListener("submit",this.submitLogin.bind(this))}))}disconnectedCallback(){var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("form"))||void 0===t||t.removeEventListener("submit",this.submitLogin.bind(this))}submitLogin(e){return r(this,void 0,void 0,(function*(){var t,n;e.preventDefault();const r=(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#username")).value,i=(null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#password")).value;try{""!=(yield(0,u.login)(r,i))?(0,o.dispatch)((0,a.navigate)(c.PANTALLAS.DASHBOARD)):alert("Error al iniciar sesin")}catch(e){alert(e)}}))}render(){if(this.shadowRoot){this.shadowRoot.innerHTML="";const e=document.createElement("div"),t=document.createElement("h2");t.textContent="Login Now",e.appendChild(t);const n=document.createElement("form");n.onsubmit=this.submitLogin.bind(this);const r=document.createElement("label");r.textContent="Email",n.appendChild(r);const i=document.createElement("input");i.id="username",i.type="text",i.placeholder="Enter your email",n.appendChild(i);const o=document.createElement("label");o.textContent="Password",n.appendChild(o);const a=document.createElement("input");a.id="password",a.type="password",a.placeholder="Enter your password",n.appendChild(a);const c=document.createElement("label"),u=document.createElement("input");u.type="checkbox",c.appendChild(u),c.append(" Remember me"),n.appendChild(c);const l=document.createElement("button");l.type="submit",l.onclick=this.submitLogin.bind(this),l.setAttribute("id","botonregreso"),l.textContent="Login",n.appendChild(l);const h=document.createElement("div");h.className="footer-links";const d=document.createElement("a");d.href="#",d.textContent="Dont have an account?",h.appendChild(d);const f=document.createElement("a");f.href="#",f.textContent="Forgot password?",h.appendChild(f),n.appendChild(h),e.appendChild(n),this.shadowRoot.appendChild(e);const p=document.createElement("style");p.textContent=s.default,this.shadowRoot.appendChild(p)}}}t.LoginComponent=l,window.customElements.define("login-component",l)},8213:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginComponent=void 0;var r=n(4205);Object.defineProperty(t,"LoginComponent",{enumerable:!0,get:function(){return r.LoginComponent}})},2849:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(6164),o=i(n(8290)),a=n(2482),c=n(155),u=n(594);class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.render()}connectedCallback(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#botonregreso");null==t||t.addEventListener("click",(()=>{var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("form"))||void 0===t||t.addEventListener("submit",this.submitSignup.bind(this))}))}disconnectedCallback(){var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("form"))||void 0===t||t.removeEventListener("submit",this.submitSignup.bind(this))}submitSignup(e){return r(this,void 0,void 0,(function*(){var t,n,r,i,o;console.log("submitSignup"),e.preventDefault();const l=(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#username")).value,h=(null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#email")).value,d=(null===(r=this.shadowRoot)||void 0===r?void 0:r.querySelector("#birthday")).value,f=(null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector("#phone")).value,p=(null===(o=this.shadowRoot)||void 0===o?void 0:o.querySelector("#password")).value;try{const e=yield(0,s.registrarUsuario)(l,h,p,d,f);alert(`Usuario registrado con id: ${e}`),""!=e?(0,a.dispatch)((0,c.navigate)(u.PANTALLAS.LOGIN)):alert("Error registrando usuario")}catch(e){alert(e)}}))}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=document.createElement("h2");t.textContent="Sign up Now";const n=document.createElement("form");n.onsubmit=this.submitSignup.bind(this);const r=document.createElement("input");r.id="username",r.type="text",r.placeholder="Enter your username",n.appendChild(r);const i=document.createElement("input");i.id="email",i.type="email",i.placeholder="Enter your email",n.appendChild(i);const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between";const a=document.createElement("input");a.id="birthday",a.type="date",a.style.flex="1",a.style.marginRight="4px",s.appendChild(a);const c=document.createElement("input");c.id="phone",c.type="tel",c.placeholder="Enter your phone number",c.style.flex="1",c.style.marginLeft="4px",s.appendChild(c),n.appendChild(s);const u=document.createElement("input");u.id="password",u.type="password",u.placeholder="Enter your password",n.appendChild(u);const l=document.createElement("button");l.setAttribute("id","botonregreso"),l.textContent="Sign up",l.type="submit",l.onclick=this.submitSignup.bind(this),n.appendChild(l);const h=document.createElement("div");h.className="footer-links";const d=document.createElement("a");d.href="#",d.textContent="Already have an account?",h.appendChild(d),n.appendChild(h),this.shadowRoot.appendChild(t),this.shadowRoot.appendChild(n);const f=document.createElement("style");f.textContent=o.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(f)}}}window.customElements.define("sign-up-component",l),t.default=l},2249:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SignUpComponent=t.storyCard=t.cardStories=t.cardInicio=t.wrapperOpinion=t.CrearOpinion=t.publicWrapper=t.CrearPublicacion=t.cardFollow=t.toFollow=void 0;var i=n(5357);Object.defineProperty(t,"toFollow",{enumerable:!0,get:function(){return r(i).default}});var s=n(1855);Object.defineProperty(t,"cardFollow",{enumerable:!0,get:function(){return r(s).default}});var o=n(8900);Object.defineProperty(t,"CrearPublicacion",{enumerable:!0,get:function(){return r(o).default}});var a=n(2287);Object.defineProperty(t,"publicWrapper",{enumerable:!0,get:function(){return r(a).default}});var c=n(6679);Object.defineProperty(t,"CrearOpinion",{enumerable:!0,get:function(){return r(c).default}});var u=n(2323);Object.defineProperty(t,"wrapperOpinion",{enumerable:!0,get:function(){return r(u).default}});var l=n(2591);Object.defineProperty(t,"cardInicio",{enumerable:!0,get:function(){return r(l).default}});var h=n(2723);Object.defineProperty(t,"cardStories",{enumerable:!0,get:function(){return r(h).default}});var d=n(8059);Object.defineProperty(t,"storyCard",{enumerable:!0,get:function(){return r(d).default}});var f=n(2849);Object.defineProperty(t,"SignUpComponent",{enumerable:!0,get:function(){return r(f).default}})},1855:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(7153),s=n(5357),o=r(n(1358));class a extends HTMLElement{constructor(){super(),this.profiles=[],this.showless=!1,this.attachShadow({mode:"open"})}mostrartoggle(){let e=0;this.profiles.forEach((t=>{this.showless?(e++,e>3&&(t.className="ocultar"),this.shadowRoot.querySelector("#btntoggle").innerHTML="Show More"):(t.className="mostrar",this.shadowRoot.querySelector("#btntoggle").innerHTML="Show Less")})),this.showless=!this.showless}connectedCallback(){var e,t;i.whotofollow.forEach((e=>{const t=this.ownerDocument.createElement("crear-whotofollow");t.setAttribute(s.datacosas.image,e.image),t.setAttribute(s.datacosas.name,e.name),t.setAttribute(s.datacosas.arroba,e.arroba),this.profiles.push(t)})),this.render(),null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#btntoggle"))||void 0===t||t.addEventListener("click",(()=>{this.mostrartoggle()}))}attributeChangedCallback(e,t,n){this.render()}render(){var e,t;let n=0;if(this.shadowRoot){const t=this.ownerDocument.createElement("div");t.className="wrapper-tarjeta";const r=this.ownerDocument.createElement("h2");r.innerHTML="Who to follow",r.className="csstitulo",t.appendChild(r),this.profiles.forEach((e=>{n++,n>3&&(e.className="ocultar"),t.appendChild(e)}));const i=this.ownerDocument.createElement("button");i.innerHTML="Show More",i.setAttribute("id","btntoggle"),t.appendChild(i),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}const r=this.ownerDocument.createElement("style");r.innerHTML=o.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}window.customElements.define("tarjeta-whotofollow",a),t.default=a},2723:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(7153),c=s(n(8059)),u=o(n(4238));class l extends HTMLElement{constructor(){super(),this.storiesArray=[],this.attachShadow({mode:"open"})}connectedCallback(){a.stories.forEach((e=>{const t=new c.default;t.setAttribute(c.storyType.image,e.image),t.setAttribute(c.storyType.name,e.name),this.storiesArray.push(t)})),this.render()}attributeChangedCallback(e,t,n){this.render()}render(){var e,t;if(this.shadowRoot){const t=this.ownerDocument.createElement("div");t.className="wrapper-ficha",this.storiesArray.forEach((e=>{t.appendChild(e)})),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}const n=this.ownerDocument.createElement("style");n.innerHTML=u.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}}window.customElements.define("card-stories",l),t.default=l},7502:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.storyCard=t.cardStories=t.cardInicio=t.wrapperopinion=t.Crearopinion=t.publicwrapper=t.Crearpublicacion=t.cardFollow=t.tofollow=void 0;var i=n(5357);Object.defineProperty(t,"tofollow",{enumerable:!0,get:function(){return r(i).default}});var s=n(1855);Object.defineProperty(t,"cardFollow",{enumerable:!0,get:function(){return r(s).default}});var o=n(8900);Object.defineProperty(t,"Crearpublicacion",{enumerable:!0,get:function(){return r(o).default}});var a=n(2287);Object.defineProperty(t,"publicwrapper",{enumerable:!0,get:function(){return r(a).default}});var c=n(6679);Object.defineProperty(t,"Crearopinion",{enumerable:!0,get:function(){return r(c).default}});var u=n(2323);Object.defineProperty(t,"wrapperopinion",{enumerable:!0,get:function(){return r(u).default}});var l=n(2591);Object.defineProperty(t,"cardInicio",{enumerable:!0,get:function(){return r(l).default}});var h=n(2723);Object.defineProperty(t,"cardStories",{enumerable:!0,get:function(){return r(h).default}});var d=n(8059);Object.defineProperty(t,"storyCard",{enumerable:!0,get:function(){return r(d).default}})},2323:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(7153),s=n(6679),o=r(n(9886));class a extends HTMLElement{constructor(){super(),this.opinions=[],this.attachShadow({mode:"open"})}connectedCallback(){i.useropinion.forEach((e=>{const t=this.ownerDocument.createElement("crear-opinion");t.setAttribute(s.datacosas3.userpfp,e.userpfp),this.opinions.push(t)})),this.render()}attributeChangedCallback(e,t,n){this.render()}render(){var e,t;if(this.shadowRoot){const n=this.ownerDocument.createElement("div");n.className="wrapper-opinion",this.opinions.forEach((e=>{n.appendChild(e)})),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("style");r.innerHTML=o.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}}window.customElements.define("wrapper-opinion",a),t.default=a},8900:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.datacosas2=void 0;const i=n(6164),s=r(n(4199));var o;n(4568),function(e){e.idpost="idpost",e.user="user",e.userpfp="userpfp",e.image="image",e.likes="likes"}(o||(t.datacosas2=o={}));class a extends HTMLElement{constructor(){super(),this.megusta=!1,this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({idpost:null,user:null,userpfp:null,image:null,likes:null})}followprofile(){"UNFOLLOW"==this.innerHTML?(this.innerHTML="FOLLOW",this.className="habilitar"):(this.innerHTML="UNFOLLOW",this.className="deshabilitar")}corazontoggle(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#corazon");this.megusta?null==t||t.setAttribute("type","regular"):null==t||t.setAttribute("type","solid"),this.megusta=!this.megusta,console.log("Me gusta cambiado")}favoritotoggle(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#favorito");this.megusta?null==t||t.setAttribute("type","regular"):null==t||t.setAttribute("type","solid"),this.megusta=!this.megusta}connectedCallback(){var e,t,n,r;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#seguir2"))||void 0===t||t.addEventListener("click",this.followprofile),null===(r=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#favorito"))||void 0===r||r.addEventListener("click",(()=>{this.favoritotoggle()}))}attributeChangedCallback(e,t,n){this[e]=n,this.render()}render(){var e,t;if(this.shadowRoot){this.shadowRoot.innerHTML='<script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"><\/script>';const t=this.ownerDocument.createElement("div");t.setAttribute("id","publicacion");const n=this.ownerDocument.createElement("div");let r;n.className="header",this.userpfp?(r=this.ownerDocument.createElement("img"),r.className="fotopfp",r.setAttribute("src",this.userpfp)):(r=this.ownerDocument.createElement("img"),r.className="fotopfp");const i=this.ownerDocument.createElement("h3");i.innerHTML=this.user;const s=this.ownerDocument.createElement("button");let o;s.setAttribute("id","seguir2"),s.innerHTML="FOLLOW",n.appendChild(r),n.appendChild(i),n.appendChild(s),this.image?(o=this.ownerDocument.createElement("img"),o.className="fotopublic",o.setAttribute("src",this.image)):(o=this.ownerDocument.createElement("img"),o.className="fotopublic");const a=this.ownerDocument.createElement("div");a.className="footer";const c=this.ownerDocument.createElement("box-icon");c.setAttribute("id","corazon"),c.setAttribute("name","heart"),c.setAttribute("size","md"),c.setAttribute("color","red"),c.addEventListener("click",this.toggleCorazon.bind(this)),this.megusta?null==c||c.setAttribute("type","solid"):null==c||c.setAttribute("type","regular");const u=this.ownerDocument.createElement("box-icon");u.setAttribute("id","favorito"),u.setAttribute("name","message-alt"),u.setAttribute("size","md"),u.setAttribute("color","yellow"),a.appendChild(c),a.appendChild(u);const l=this.ownerDocument.createElement("p");l.className="margintexto",l.innerHTML=this.likes+" Likes",t.appendChild(n),t.appendChild(o),t.appendChild(a),t.appendChild(l),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}const n=this.ownerDocument.createElement("style");n.innerHTML=s.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}toggleCorazon(){if(this.megusta){const e={id:this.idpost,user:this.user,userpfp:this.userpfp,image:this.image,likes:(parseInt(this.likes)-1).toString()};this.likes=(parseInt(this.likes)-1).toString(),(0,i.sumarMegusta)(e)}else{const e={id:this.idpost,user:this.user,userpfp:this.userpfp,image:this.image,likes:(parseInt(this.likes)+1).toString()};this.likes=(parseInt(this.likes)+1).toString(),(0,i.sumarMegusta)(e)}this.corazontoggle(),this.render()}}window.customElements.define("crear-publicacion",a),t.default=a},2287:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(6164),o=n(8900),a=i(n(3002));class c extends HTMLElement{constructor(){super(),this.profiles=[],this.attachShadow({mode:"open"})}connectedCallback(){return r(this,void 0,void 0,(function*(){(yield(0,s.getpublicaciones)()).forEach((e=>{const t=this.ownerDocument.createElement("crear-publicacion");t.setAttribute("idpost",e.id),t.setAttribute(o.datacosas2.user,e.user),t.setAttribute(o.datacosas2.userpfp,e.userpfp),t.setAttribute(o.datacosas2.image,e.image),t.setAttribute(o.datacosas2.likes,e.likes),this.profiles.push(t)})),this.render()}))}attributeChangedCallback(e,t,n){this.render()}render(){var e,t;if(this.shadowRoot){const n=this.ownerDocument.createElement("div");n.className="wrapper-publicacion",this.profiles.forEach((e=>{n.appendChild(e)})),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("style");r.innerHTML=a.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}}window.customElements.define("public-wrapper",c),t.default=c},6679:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.datacosas3=void 0;const i=r(n(7662)),s=n(7153),o=n(594),a=n(155),c=n(2482),u=n(6164);var l;!function(e){e.userpfp="userpfp"}(l||(t.datacosas3=l={}));class h extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({userpfp:null})}onClickPost(){"POSTED"==this.innerHTML?(this.innerHTML="POST",this.className="habilitar"):(this.innerHTML="POSTED",this.className="deshabilitar")}connectedCallback(){var e,t,n,r;this.render();const i=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#imagenpost"),l=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#guardar");null==l||l.addEventListener("click",(()=>{this.modal.className="contenedorpost ocultarpost";const e={user:"pepito",userpfp:"",image:i.value,likes:"0"};s.publics.push(e),(0,u.addpublicacion)(e),(0,c.dispatch)((0,a.navigate)(o.PANTALLAS.DASHBOARD))}));const h=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#post");null==h||h.addEventListener("click",(()=>{this.modal.className="contenedorpost mostrarpost"}));const d=null===(r=this.shadowRoot)||void 0===r?void 0:r.querySelector("#cancelar");null==d||d.addEventListener("click",(()=>{this.modal.className="contenedorpost ocultarpost"}))}attributeChangedCallback(e,t,n){this[e]=n,this.render()}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML=`\n\n\t\t\t\t<div class="headeropinion">\n\t\t\t\t\t<img class="fotopfp" src="${this.userpfp}" />\n          <h2>What is happening?</h2>\n        </div>\n\n        <div class="textopinion">\n        <button id="post">POST</button>\n\n        </div>\n\t\t\t\t<div class="linea"></div>\n      `,this.modal=this.ownerDocument.createElement("div"),this.modal.className="contenedorpost ocultarpost";const e=this.ownerDocument.createElement("div");e.className="formulario";const t=this.ownerDocument.createElement("H1");e.appendChild(t),t.innerHTML="Crea tu post";const n=this.ownerDocument.createElement("input");n.placeholder="imagen",n.setAttribute("id","imagenpost"),e.appendChild(n);const r=this.ownerDocument.createElement("button");r.setAttribute("id","cancelar"),e.appendChild(r),r.innerHTML="cancelar";const i=this.ownerDocument.createElement("button");i.setAttribute("id","guardar"),e.appendChild(i),i.innerHTML="guardar",this.modal.appendChild(e),this.shadowRoot.appendChild(this.modal)}const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}window.customElements.define("crear-opinion",h),t.default=h},2591:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.databarra=void 0;const i=n(2482),s=n(594),o=n(155),a=r(n(826));var c;!function(e){e.coquette="coquette",e.inicio="inicio",e.busqueda="busqueda",e.mensajes="mensajes",e.inotificaciones="notificaciones",e.crear="crear",e.perfil="perfil"}(c||(t.databarra=c={}));class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({coquette:null,inicio:null,busqueda:null,mensajes:null,notificaciones:null,crear:null,perfil:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){var e;this.render();const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#aperfil");null==t||t.addEventListener("click",(()=>{(0,i.dispatch)((0,o.navigate)(s.PANTALLAS.PERFIL))}))}render(){var e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<style>\n\t\t\t${a.default}\n\t\t\t</style>\n\t\t\t<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>\n\t\t\t<div class="sidebar">\n\t\t\t\t<h2 class="etiqueta">Coquette</h2>\n\t\t\t\t<ul class="menuiconos">\n\t\t\t\t\t<li><i class="bx bx-home-alt"></i><a class="texto" href="index.html">Inicio</a></li>\n\t\t\t\t\t<li><i class="bx bx-search-alt-2"></i> <a class="texto" href="#">Bsqueda</a></li>\n\t\t\t\t\t<li><i class="bx bx-message-square-detail"></i> <a class="texto" href="#">Mensajes</a></li>\n\t\t\t\t\t<li><i class="bx bx-bell"></i> <a class="texto" href="#">Notificaciones</a></li>\n\t\t\t\t\t<li id='aperfil'><i class="bx bxs-user"></i> <a class="texto" href="#">Perfil</a></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n          `);const t=this.ownerDocument.createElement("style");t.innerHTML=a.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}customElements.define("card-inicio",u),t.default=u},8059:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.storyType=void 0;const i=r(n(9918));var s;!function(e){e.image="image",e.name="name"}(s||(t.storyType=s={}));class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({image:null,name:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){this.render()}render(){var e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\n    <div class="stories">\n\n\t<img class="pfp" src="${this.image}">\n\n\t  <p>${this.name}</p>\n\n\n\t</div>\n\n\n    </div>\n          `);const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}customElements.define("story-card",o),t.default=o},5357:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.datacosas=void 0;const i=r(n(824));var s;!function(e){e.image="image",e.name="name",e.arroba="arroba"}(s||(t.datacosas=s={}));class o extends HTMLElement{user(e,t){throw new Error("Method not implemented.")}constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({image:null,name:null,arroba:null})}followprofile(){console.log("123",this),"UNFOLLOW"==this.innerHTML?(this.innerHTML="FOLLOW",this.className="habilitar"):(this.innerHTML="UNFOLLOW",this.className="deshabilitar")}connectedCallback(){var e,t;this.render(),null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#seguir"))||void 0===t||t.addEventListener("click",this.followprofile)}attributeChangedCallback(e,t,n){this[e]=n,this.render()}render(){var e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n      <div id="whoto-container">\n      <img class="foto" src="${this.image}">\n      <div id="names">\n      <p>${this.name}</p>\n      <p>${this.arroba}</p>\n      </div>\n\t\t\t<button id="seguir">FOLLOW</button>\n      </div>\n      `);const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}window.customElements.define("crear-whotofollow",o),t.default=o},6557:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.datacosasfotos=void 0;const i=r(n(9178));var s;n(4568),function(e){e.image="image"}(s||(t.datacosasfotos=s={}));class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({image:null})}connectedCallback(){this.render()}attributeChangedCallback(e,t,n){this[e]=n,this.render()}render(){var e,t;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("div");t.setAttribute("id","cuadradofoto");const n=this.ownerDocument.createElement("img");n.className="fotocuadrado",n.setAttribute("src",this.image),t.appendChild(n),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}const n=this.ownerDocument.createElement("style");n.innerHTML=i.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}}window.customElements.define("crear-foto",o),t.default=o},4588:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(6164),o=n(6557),a=i(n(6903));class c extends HTMLElement{constructor(){super(),this.profiles=[],this.attachShadow({mode:"open"})}connectedCallback(){return r(this,void 0,void 0,(function*(){(yield(0,s.getpublicacionByUser)("pepito1")).forEach((e=>{var t;const n=this.ownerDocument.createElement("crear-foto");n.setAttribute(o.datacosasfotos.image,e.image),null===(t=this.shadowRoot)||void 0===t||t.appendChild(n),this.profiles.push(n)})),this.render()}))}attributeChangedCallback(e,t,n){this.render()}render(){var e,t;if(this.shadowRoot){this.shadowRoot.innerHTML="";const n=this.ownerDocument.createElement("div");n.className="foto-contenedor",this.profiles.forEach((e=>{n.appendChild(e)})),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("style");r.innerHTML=a.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}}window.customElements.define("foto-wrapper",c),t.default=c},8577:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fotowrapper=t.Crearfoto=void 0;var i=n(6557);Object.defineProperty(t,"Crearfoto",{enumerable:!0,get:function(){return r(i).default}});var s=n(4588);Object.defineProperty(t,"fotowrapper",{enumerable:!0,get:function(){return r(s).default}})},7153:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stories=t.fotosperfil=t.useropinion=t.publics=t.whotofollow=void 0,t.whotofollow=[{image:"https://e00-telva.uecdn.es/assets/multimedia/imagenes/2024/02/18/17082291054247.jpg",name:"Iam The Real Coquette",arroba:"@IAmTheRealCoquette"},{image:"https://eldiario.com/wp-content/uploads/2024/01/Coquette-1-.jpg",name:"Charlie morningstar",arroba:"@charliemorningstar"},{image:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg",name:"How To bows",arroba:"@howtobows"},{image:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg",name:"How To bows",arroba:"@howtobows"},{image:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg",name:"How To bows",arroba:"@howtobows"},{image:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg",name:"How To bows",arroba:"@howtobows"}],t.publics=[{user:"LadyNoir",userpfp:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg",image:"https://i.pinimg.com/564x/2a/b9/2d/2ab92d8d2861b73ce4af0f7f9c341ada.jpg",likes:"2040"},{user:"AventurineSimp",userpfp:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg",image:"https://i.pinimg.com/736x/88/69/e1/8869e10a10e7e658f082d4f1a49aa2c5.jpg",likes:"488"}],t.useropinion=[{userpfp:"https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg"}],t.fotosperfil=[{image:"https://www.shutterstock.com/image-vector/draw-seamless-pattern-red-cherry-600nw-2412112351.jpg"},{image:"https://i.ytimg.com/vi/BpL_Xf7Q5Ug/maxresdefault.jpg"},{image:"https://garden.spoonflower.com/c/16489465/p/f/m/uzyRE3hAb8N_lzKKI7PnneYTTtozInVWrjmRYKkXb0WcRHIrUXDW/12%22%20%20Pink%20Bow%20Print%20-%20Coquette%20Aesthetic%20Ribbon%20Bow%20-%20Girls%20Room%20Decor.jpg"},{image:"https://garden.spoonflower.com/c/15318157/p/f/m/1LnuXKYBlwmrakVRjfShkqpcy2ZdhvzxzzQYBEZT9-Ekfrw3Pc4H1d8/Brown%20vintage%20ribbon%20bows%20on%20soft%20blush%20pink%2FMEDIUM.jpg"},{image:"https://t4.ftcdn.net/jpg/06/81/50/51/360_F_681505176_MjOXAmjMqHtphlRmbwc6HFdSdY9YKpzX.jpg"},{image:"https://www.elsoldehermosillo.com.mx/doble-via/xekztl-moda-coquette-lolita/ALTERNATES/LANDSCAPE_1140/Moda%20Coquette%20Lolita"}],t.stories=[{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.5.1/CHAMPION_SKIN/51039/ICON",name:"Caitlyn"},{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.6.1/CHAMPION_SKIN/235046/ICON",name:"Senna"},{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.6.1/CHAMPION_SKIN/145040/ICON",name:"Kaisa"},{image:"https://preview.redd.it/lovestruck-lux-port-mission-v0-2vwnvbfsnfac1.jpeg?auto=webp&s=161092691f8478293c7b88da9f08ac2848f167e6",name:"Lux"},{image:"https://i1.sndcdn.com/artworks-DzKaeKvz64CglhKq-O7Jy1w-t500x500.jpg",name:"Seraphine"},{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.5.1/CHAMPION_SKIN/134044/ICON",name:"Syndra"},{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.5.1/CHAMPION_SKIN/134044/ICON",name:"Syndra"},{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.5.1/CHAMPION_SKIN/134044/ICON",name:"Syndra"},{image:"https://prod.api.assets.riotgames.com/public/v1/asset/lol/14.5.1/CHAMPION_SKIN/134044/ICON",name:"Syndra"}]},8752:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(7502),n(8577),n(29);const i=r(n(1195)),s=n(2482);n(8213);const o=n(594);class a extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),(0,s.addObserver)(this)}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("style");switch(t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t),s.appState.screen){case o.PANTALLAS.DASHBOARD:const e=this.ownerDocument.createElement("create-dashbard");this.shadowRoot.appendChild(e);break;case o.PANTALLAS.PERFIL:const t=this.ownerDocument.createElement("create-perfil");this.shadowRoot.appendChild(t);break;case o.PANTALLAS.LOGIN:const n=this.ownerDocument.createElement("login-container");this.shadowRoot.appendChild(n);break;case o.PANTALLAS.SIGNUP:const r=this.ownerDocument.createElement("signup-screen");this.shadowRoot.appendChild(r)}}}}window.customElements.define("app-container",a)},9418:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(7502);const i=r(n(3603)),s=n(2482),o=n(155),a=n(594);class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){var e,t;this.render();const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#alogin");null==n||n.addEventListener("click",(()=>{(0,s.dispatch)((0,o.navigate)(a.PANTALLAS.LOGIN))}));const r=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#asingup");null==r||r.addEventListener("click",(()=>{(0,s.dispatch)((0,o.navigate)(a.PANTALLAS.SIGNUP))}))}attributeChangedCallback(e,t,n){this.render()}render(){var e;if(this.shadowRoot){const t=this.ownerDocument.createElement("div");t.className="div-botones";const n=this.ownerDocument.createElement("div");n.className="div-todo";const r=this.ownerDocument.createElement("div");r.className="div-primero";const s=this.ownerDocument.createElement("button");s.setAttribute("id","alogin"),s.innerHTML="Log in";const o=this.ownerDocument.createElement("button");o.setAttribute("id","asingup"),o.innerHTML="Sign up";const a=this.ownerDocument.createElement("div");a.className="div-centro",this.tarjeta=this.ownerDocument.createElement("tarjeta-whotofollow"),this.tarjeta2=this.ownerDocument.createElement("public-wrapper"),this.tarjeta2.className="contenedorpub",this.tarjeta3=this.ownerDocument.createElement("wrapper-opinion"),this.tarjeta3.className="contenedoropinion",this.tarjeta4=this.ownerDocument.createElement("card-inicio"),this.tarjeta5=this.ownerDocument.createElement("card-stories"),a.appendChild(this.tarjeta5),a.appendChild(this.tarjeta3),a.appendChild(this.tarjeta2);const c=this.ownerDocument.createElement("div");c.className="div-izquierda",c.appendChild(this.tarjeta4);const u=this.ownerDocument.createElement("div");u.className="div-derecha",u.appendChild(this.tarjeta);const l=this.ownerDocument.createElement("style");l.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(l),r.appendChild(s),r.appendChild(o),t.appendChild(r),n.appendChild(a),n.appendChild(c),n.appendChild(a),n.appendChild(u),t.appendChild(n),this.shadowRoot.appendChild(t)}}}window.customElements.define("create-dashbard",c),t.default=c},29:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SIGNUP=t.LOGIN=t.Perfil=t.dashboard=void 0;var i=n(9418);Object.defineProperty(t,"dashboard",{enumerable:!0,get:function(){return r(i).default}});var s=n(5170);Object.defineProperty(t,"Perfil",{enumerable:!0,get:function(){return r(s).default}});var o=n(7955);Object.defineProperty(t,"LOGIN",{enumerable:!0,get:function(){return r(o).default}});var a=n(584);Object.defineProperty(t,"SIGNUP",{enumerable:!0,get:function(){return r(a).default}})},7955:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2858));class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=document.createElement("div");t.className="div-fondo",console.log("hola");const n=document.createElement("login-component");t.appendChild(n);const r=this.ownerDocument.createElement("style");r.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(r),this.shadowRoot.appendChild(t)}}}window.customElements.define("login-container",s),t.default=s},5170:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(7502);const s=i(n(6082)),o=n(2482),a=n(155),c=n(594),u=n(6164);class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){var e,t;this.render();const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#cerrarperfil");null==n||n.addEventListener("click",(()=>{(0,o.dispatch)((0,a.navigate)(c.PANTALLAS.DASHBOARD))}));const r=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#cerrarsesion");null==r||r.addEventListener("click",(()=>{var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("form"))||void 0===t||t.addEventListener("submit",this.submitLogout.bind(this))}))}disconnectedCallback(){var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("form"))||void 0===t||t.removeEventListener("submit",this.submitLogout.bind(this))}attributeChangedCallback(e,t,n){this.render()}submitLogout(e){return r(this,void 0,void 0,(function*(){e.preventDefault();try{(yield(0,u.logOut)())?(0,o.dispatch)((0,a.navigate)(c.PANTALLAS.LOGIN)):alert("Error al cerrar sesin")}catch(e){console.log(e),alert(e)}}))}render(){var e;if(this.shadowRoot){const t=document.createElement("form");t.onsubmit=this.submitLogout.bind(this);const n=this.ownerDocument.createElement("div");n.className="div-fondo";const r=this.ownerDocument.createElement("div");r.className="div-arriba";const i=this.ownerDocument.createElement("div");i.className="div-arribafoto";const o=this.ownerDocument.createElement("img");o.className="fotopfp",o.setAttribute("src","https://www.semana.com/resizer/r0OI-UL1npAMnFaFqySPh7RqzLU=/arc-anglerfish-arc2-prod-semana/public/MDNDZ5QVPFDUFMXQFO54CL7PVA.jpg"),i.appendChild(o);const a=this.ownerDocument.createElement("div");a.className="div-arribatexto";const c=this.ownerDocument.createElement("div");c.className="div-arribatextoboton";const u=this.ownerDocument.createElement("input"),l=this.ownerDocument.createElement("button");l.setAttribute("id","cerrarperfil"),l.innerHTML="regresar",c.appendChild(u),c.appendChild(l);const h=this.ownerDocument.createElement("button");h.setAttribute("id","editarperfil"),h.innerHTML="Editar Perfil";const d=this.ownerDocument.createElement("button");d.setAttribute("id","cerrarsesion"),d.textContent="Salir",d.type="submit",d.onclick=this.submitLogout.bind(this),d.innerHTML="Salir",t.appendChild(d);const f=this.ownerDocument.createElement("h3");f.innerHTML="300 seguidores",a.appendChild(c),a.appendChild(t),a.appendChild(h),a.appendChild(f);const p=this.ownerDocument.createElement("div");p.className="div-linea",a.appendChild(p),r.appendChild(i),r.appendChild(a),n.appendChild(r);const m=this.ownerDocument.createElement("div");m.className="div-fotos";const g=this.ownerDocument.createElement("foto-wrapper");m.appendChild(g),n.appendChild(m);const y=this.ownerDocument.createElement("style");y.innerHTML=s.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(y),this.shadowRoot.appendChild(n)}}}window.customElements.define("create-perfil",l),t.default=l},584:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(2249);const i=r(n(6441));class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){const t=document.createElement("div");t.className="div-fondo";const n=document.createElement("sign-up-component");t.appendChild(n),this.shadowRoot.appendChild(t);const r=this.ownerDocument.createElement("style");r.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(r)}}}window.customElements.define("signup-screen",s),t.default=s},6164:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updatevinilo=t.sumarMegusta=t.getpublicacionByUser=t.getpublicaciones=t.addpublicacion=t.login=t.registrarUsuario=t.logOut=t.getUsers=t.addUser=t.auth=t.db=void 0,n(5577),n(9815);const{initializeApp:i}=n(5577),{getFirestore:s}=n(9815),{collection:o,addDoc:a,getDocs:c,updateDoc:u}=n(9815),l=n(5052),h=n(843),d=n(9815),f=i({apiKey:"AIzaSyANsoNo49zqX0WQ9mlb3yOFNAc31Lt-dKU",authDomain:"coquette-dcc06.firebaseapp.com",projectId:"coquette-dcc06",storageBucket:"coquette-dcc06.appspot.com",messagingSenderId:"656773814236",appId:"1:656773814236:web:29067ac07200e3368d6119",measurementId:"G-LZBKJP8VGN"});t.db=s(f),t.auth=(0,l.getAuth)(f),t.addUser=e=>r(void 0,void 0,void 0,(function*(){console.log("form",e);try{const n=yield a(o(t.db,"usuarios"),e);return console.log("Document written with ID: ",n.id),n.id}catch(e){console.error("Error adding document: ",e)}})),t.getUsers=()=>r(void 0,void 0,void 0,(function*(){const e=yield c(o(t.db,"usuarios")),n=[];return e.forEach((e=>{const t=e.data();n.push(Object.assign(Object.assign({},t),{uid:e.id}))})),console.log("get",n),n})),t.logOut=()=>r(void 0,void 0,void 0,(function*(){try{return console.log("logOut"),yield(0,l.signOut)(t.auth),!0}catch(e){return console.log("Error logOut",e),alert(e),""}})),t.registrarUsuario=(e,n,i,s,c)=>r(void 0,void 0,void 0,(function*(){const r=yield(0,t.getUsers)();for(let e=0;e<r.length;e++)if(n==r[e].emailaddress)return void alert("El email ya esta registrado");const s=(yield(0,l.createUserWithEmailAndPassword)(t.auth,n,i)).user.uid;try{const r=yield a(o(t.db,"usuarios"),{user:e,emailaddress:n,authCredentials:s,profile:"https://static.vecteezy.com/system/resources/previews/005/544/718/original/profile-icon-design-free-vector.jpg"});return yield u(r,{firebaseID:r.id}),r.id}catch(e){return alert(e),""}})),t.login=(e,n)=>r(void 0,void 0,void 0,(function*(){yield(0,t.getUsers)();try{const r=(yield(0,l.signInWithEmailAndPassword)(t.auth,e,n)).user.uid;return console.log("userCredentials",r),r}catch(e){const t=e;return console.log("Error",t),""}})),t.addpublicacion=e=>r(void 0,void 0,void 0,(function*(){try{const n=o(t.db,h.Coleccion.publicaciones);yield a(n,e),console.log("se aadi con xito",e)}catch(e){console.error(e)}})),t.getpublicaciones=()=>r(void 0,void 0,void 0,(function*(){const e=o(t.db,h.Coleccion.publicaciones),n=yield c(e),r=[];return n.forEach((e=>{const t=e.data();r.push(Object.assign({id:e.id},t))})),r})),t.getpublicacionByUser=e=>r(void 0,void 0,void 0,(function*(){let n;try{n=o(t.db,h.Coleccion.publicaciones)}catch(e){console.log("Datos error",e)}const r=(0,d.query)(n,(0,d.where)("user","==",e)),i=yield c(r);if(i.empty)return console.log("No existe ninguna publicacin para este usuario"),[];const s=[];return i.forEach((e=>{const t=e.data();s.push(Object.assign({id:e.id},t))})),s})),t.sumarMegusta=e=>r(void 0,void 0,void 0,(function*(){try{const n=o(t.db,h.Coleccion.publicaciones),r=(0,d.doc)(n,e.id);yield u(r,e),console.log("se actualiz con xito",e)}catch(e){console.error(e)}})),t.updatevinilo=e=>r(void 0,void 0,void 0,(function*(){try{const n=o(t.db,h.Coleccion.publicaciones),r=(0,d.doc)(n,e.id);yield u(r,e),console.log("se actualiz con xito",e)}catch(e){console.error(e)}}))},2482:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.addObserver=t.dispatch=t.appState=void 0;const o=s(n(1167)),a=n(6950),c={screen:n(594).PANTALLAS.DASHBOARD,user:""};t.appState=o.default.get({key:o.PersistanceKeys.STORE,defaultValue:c});let u=[];t.dispatch=e=>{const n=JSON.parse(JSON.stringify(t.appState)),r=(0,a.reducer)(e,n);var i;t.appState=r,i=r,o.default.set({key:o.PersistanceKeys.STORE,value:i}),u.forEach((e=>e.render()))},t.addObserver=e=>{u=[...u,e]}},6950:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0;const r=n(155);t.reducer=(e,t)=>{const{action:n,payload:i}=e;return n===r.SomeActions.changescreen&&(t.screen=i),t}},594:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PANTALLAS=void 0,function(e){e.DASHBOARD="DASHBOARD",e.LOGIN="LOGIN",e.SIGNUP="SIGNUP",e.PERFIL="PERFIL"}(n||(t.PANTALLAS=n={}))},843:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Coleccion=void 0,function(e){e.publicaciones="publicaciones"}(n||(t.Coleccion=n={}))},155:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.connecteduser=t.setUserCredentials=t.navigate=t.SomeActions=void 0,function(e){e.X="X",e.changescreen="changescreen"}(n||(t.SomeActions=n={})),t.navigate=e=>({action:n.changescreen,payload:e}),t.setUserCredentials=e=>({action:"SETUSER",payload:e}),t.connecteduser=e=>({action:"CONNECTUSER",payload:e})},1167:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PersistanceKeys=void 0,function(e){e.STORE="STORE"}(n||(t.PersistanceKeys=n={})),t.default={get:({key:e,defaultValue:t})=>{const n=localStorage.getItem(e)||sessionStorage.getItem(e);return n?JSON.parse(n):t},set:({key:e,value:t,session:n=!1})=>{const r=n?sessionStorage:localStorage,i=JSON.stringify(t);r.setItem(e,i)}}},6148:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteDB:()=>g,openDB:()=>m,unwrap:()=>p,wrap:()=>f});const r=(e,t)=>t.some((t=>e instanceof t));let i,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),f(o.get(this))}:function(...e){return f(t.apply(p(this),e))}:function(e,...n){const r=t.call(p(this),e,...n);return c.set(r,e.sort?e.sort():[e]),f(r)}:(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e);var t}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(f(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=d(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const p=e=>l.get(e);function m(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=f(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(f(o.result),e.oldVersion,e.newVersion,f(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function g(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),f(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],w=new Map;function b(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=v.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return w.set(t,s),s}var _;_=h,h={..._,get:(e,t,n)=>b(e,t)||_.get(e,t,n),has:(e,t)=>!!b(e,t)||_.has(e,t)}},1635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>R,__assign:()=>s,__asyncDelegator:()=>S,__asyncGenerator:()=>T,__asyncValues:()=>C,__await:()=>E,__awaiter:()=>p,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>P,__classPrivateFieldSet:()=>O,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>M,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>i,__generator:()=>m,__importDefault:()=>D,__importStar:()=>k,__makeTemplateObject:()=>A,__metadata:()=>f,__param:()=>c,__propKey:()=>h,__read:()=>w,__rest:()=>o,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>b,__spreadArray:()=>I,__spreadArrays:()=>_,__values:()=>v,default:()=>F});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,i,s){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?r.static?e:e.prototype:null,h=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var m in r)p[m]="access"===m?{}:r[m];for(var m in r.access)p.access[m]=r.access[m];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(e||null))};var g=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[u],p);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(h.get=a),(a=o(g.set))&&(h.set=a),(a=o(g.init))&&i.unshift(a)}else(a=o(g))&&("field"===c?i.unshift(a):h[u]=a)}l&&Object.defineProperty(l,r.name,h),d=!0}function l(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function m(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function I(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function T(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof E?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function S(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:E(e[r](t)),done:!1}:i?i(t):t}:i}}function C(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return x(t,e),t}function D(e){return e&&e.__esModule?e:{default:e}}function N(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function O(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function P(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function R(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if("function"!=typeof r)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function M(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:i,__assign:s,__rest:o,__decorate:a,__param:c,__metadata:f,__awaiter:p,__generator:m,__createBinding:g,__exportStar:y,__values:v,__read:w,__spread:b,__spreadArrays:_,__spreadArray:I,__await:E,__asyncGenerator:T,__asyncDelegator:S,__asyncValues:C,__makeTemplateObject:A,__importStar:k,__importDefault:D,__classPrivateFieldGet:N,__classPrivateFieldSet:O,__classPrivateFieldIn:P,__addDisposableResource:R,__disposeResources:M}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8752)})();